<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>SUBROTIN</TITLE>
<META NAME="Template" CONTENT="J:\MSOFFICE\OFFICE\html.dot">
</HEAD>
<BODY LINK="#0000ff" VLINK="#800080" BACKGROUND="doc_b.gif">

<P><basefont size=2></P>
<B><FONT SIZE=6><P><A NAME="Subro">Sub-rotina</A></B></FONT> </P>
<P><HR></P>
<B><FONT SIZE=5><P><A NAME="Conce">Conceitua&ccedil;&atilde;o</A></B></FONT> </P>
<P><HR></P>
<FONT SIZE=2><P>Sub-rotinas s&atilde;o programas que executam fun&ccedil;&otilde;es espec&iacute;ficas que, apesar de serem constru&iacute;das de forma independente, dependem de comandos de outros programas para serem executadas.</FONT> </P>
<FONT SIZE=2><P>Para cada sub-rotina cadastrada para um sistema, &eacute; necess&aacute;rio reservar uma &aacute;rea para comunica&ccedil;&atilde;o com os programas que far&atilde;o chamada &agrave; mesma. Esta &aacute;rea ir&aacute; armazenar os par&acirc;metros de entrada, fornecidos pelo programa, e os de sa&iacute;da, fornecidos pela sub-rotina.</FONT> </P>
<FONT SIZE=2><P>As sub-rotinas podem ser disparadas atrav&eacute;s de programas on-line, batch ou mesmo de outras sub-rotinas. O disparo &eacute; feito atrav&eacute;s do comando "CALL" do Cobol. </P>
</FONT><B><FONT SIZE=5><P><A NAME="Padro">Padroniza&ccedil;&atilde;o</A></B></FONT> </P>
<P><HR></P>
<FONT SIZE=2><P>Para identificar uma sub-rotina s&atilde;o necess&aacute;rios: o c&oacute;digo do sistema + a constante de sub-rotina "S" + indicador de 2(dois) caracteres<I> </I>alfanum&eacute;ricos.</FONT> </P><DIR>

<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>"sssSxx"</B> onde:</FONT> </P><DIR>

<P><IMG SRC="Bullet7.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>"sss"</B> &eacute; o c&oacute;digo alfab&eacute;tico que identifica o sistema;</FONT> </P>
<P><IMG SRC="Bullet7.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>"S"</B> &eacute; a constante de sub-rotina e</FONT> </P>
<P><IMG SRC="Bullet7.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>"xx"</B> &eacute; o indicador alfanum&eacute;rico da sub-rotina.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="utili">Utiliza&ccedil;&atilde;o</A></B></FONT> </P>
<P><HR></P>
<FONT SIZE=2><P>As sub-rotinas podem ser entendidas como uma fatora&ccedil;&atilde;o de c&oacute;digo objeto e, geralmente, s&atilde;o criadas com o objetivo de executar uma fun&ccedil;&atilde;o comum a v&aacute;rios programas. Deste modo, qualquer programa que porventura necessite executar tal fun&ccedil;&atilde;o poder&aacute; dispar&aacute;-la.</FONT> </P>
<FONT SIZE=2><P>Para uma instala&ccedil;&atilde;o que utilize o SADS, uma sub-rotina &eacute; sempre &uacute;til no momento de se consultar bancos que n&atilde;o estejam definidos na base de dados do sistema.</FONT> </P>
<FONT SIZE=2><P>Para um programa utilizar uma sub-rotina, basta que ela esteja cadastrada como recurso a ser utilizado.</FONT> </P>
<B><FONT SIZE=5><P><A NAME="Fatsu">Fatores a serem observados na utiliza&ccedil;&atilde;o de sub-rotinas</A></B></FONT> </P>
<FONT SIZE=2><P>A utiliza&ccedil;&atilde;o de sub-rotinas de forma adequada pode trazer enormes vantagens, como, por exemplo, facilidade de manuten&ccedil;&atilde;o, minimiza&ccedil;&atilde;o de redund&acirc;ncia de c&oacute;digos objetos, acesso a arquivos e estruturas DMSII que n&atilde;o est&atilde;o declarados para o sistema, etc. Por&eacute;m, alguns detalhes relevantes devem ser observados para uma boa utiliza&ccedil;&atilde;o, quais sejam:</FONT> </P><DIR>

<B><FONT SIZE=4><P><A NAME="Enfil">Enfileiramento e ocupa&ccedil;&atilde;o de mem&oacute;ria</A></B></FONT> </P>
<FONT SIZE=2><P>Existem duas possibilidades de defini&ccedil;&atilde;o de sub-rotinas, considerando o n&uacute;mero de c&oacute;pias no ar:</FONT> </P></DIR>

<OL>
<OL>

<LI>Sub-rotinas "SHAREDBYALL": Neste caso, apenas uma c&oacute;pia da sub-rotina estar&aacute; dispon&iacute;vel para acesso por todos os programas que a utilizarem; </LI>
<LI>Sub-rotinas "PRIVATE: Neste caso, cada programa ter&aacute; acesso a uma c&oacute;pia privada da sub-rotina.</LI></OL>
</OL>
<DIR>

<FONT SIZE=2><P>Considerando estas duas possibilidades de defini&ccedil;&atilde;o para a sub-rotina, tem-se os seguintes problemas a elas relacionados:</FONT> </P></DIR>


<UL TYPE="SQUARE">

<UL TYPE="SQUARE">
<LI>Para a sub-rotina "SHAREDBYALL", definida com ampla utiliza&ccedil;&atilde;o e com concorr&ecirc;ncia entre programas "r&aacute;pidos" e "lentos", corre-se o risco de criar um "gargalo" no processamento das informa&ccedil;&otilde;es e, por consequ&ecirc;ncia, prejudicar, de um modo geral, o tempo de resposta dos mesmos; </LI>
<LI>Para a sub-rotina "PRIVATE", definida para utiliza&ccedil;&atilde;o por muitos programas diferentes, as v&aacute;rias c&oacute;pias criadas podem ocupar um espa&ccedil;o muito grande em mem&oacute;ria.</LI></UL>
</UL>
<DIR>

<FONT SIZE=2><P>Uma sub-rotina pode ainda ser definida como "Permanente" ou "Tempor&aacute;ria", par&acirc;metros estes que devem ser escolhidos com cuidado:</FONT> </P></DIR>

<OL>
<OL>

<LI>Sub-rotina "PERMANENTE": Neste caso, a sub-rotina permanecer&aacute; no ar mesmo ap&oacute;s o programa que a chamou terminar o seu processamento, e mesmo se n&atilde;o houver outras chamadas por outros programas; </LI>
<LI>Sub-rotina definida como "TEMPOR&Aacute;RIA": Neste caso, a sub-rotina sair&aacute; do ar imediatamente ap&oacute;s o programa que a chamou terminar o seu processamento.</LI></OL>
</OL>
<DIR>

<FONT SIZE=2><P>Considerando estas duas possibilidades, tem-se os seguintes problemas a elas relacionados:</FONT> </P></DIR>


<UL TYPE="SQUARE">

<UL TYPE="SQUARE">
<LI>Se a sub-rotina for permanente, a c&oacute;pia permanentemente no ar pode ocupar espa&ccedil;o desnecess&aacute;rio em mem&oacute;ria, caso n&atilde;o esteja sendo acessada por nenhum programa; </LI>
<LI>Se a sub-rotina for tempor&aacute;ria e amplamente utilizada, ela tamb&eacute;m correr&aacute; o risco de se tornar um "gargalo" no processamento das informa&ccedil;&otilde;es, pois, a cada chamada efetuar&aacute; uma s&eacute;rie de procedimentos para sua inicializa&ccedil;&atilde;o, tais como: abrir banco, inicializar as vari&aacute;veis de controle, etc.</LI></UL>
</UL>
<DIR>

<B><FONT SIZE=4><P><A NAME="Difmon">Dificuldade de monitoramento</A></B></FONT> </P>
<FONT SIZE=2><P>Quando existem casos de programas que acessam sub-rotinas, que, por sua vez, acessam outras sub-rotinas, e assim sucessivamente, a depura&ccedil;&atilde;o de erros e cancelamentos pode ser enormemente dificultada.</FONT> </P>
<B><FONT SIZE=4><P><A NAME="Impsub">Impactos na altera&ccedil;&atilde;o da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina</A></B></FONT> </P>
<FONT SIZE=2><P>Existem casos em que, devido a uma altera&ccedil;&atilde;o ocorrida no c&oacute;digo fonte de uma sub-rotina, pode ser necess&aacute;rio alterar tamb&eacute;m a sua &aacute;rea de comunica&ccedil;&atilde;o.</FONT> </P>
<FONT SIZE=2><P>Algumas altera&ccedil;&otilde;es podem provocar a necessidade de recompila&ccedil;&atilde;o de todos os programas e sub-rotinas que fazem acesso &agrave; mesma.</P></DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Globa">Sub-rotinas Globais</A></B></FONT> </P>
<B><FONT SIZE=4><P><A NAME="Esqfu">Esquema de funcionamento</A></B></FONT> </P>
<FONT SIZE=2><P>O mecanismo de utiliza&ccedil;&atilde;o global das sub-rotinas dos aplicativos foi implementado com o objetivo de melhorar a <I>performance</I> dos programas <I>on-line </I>gerados pelo SADS.</FONT> </P>
<FONT SIZE=2><P>Quando um programa aplicativo fosse disparado, era efetuado um <I>link</I> na primeira chamada de cada sub-rotina por ele utilizada e, ao t&eacute;rmino daquele, era liberado este <I>link</I>.</FONT> </P>
<FONT SIZE=2><P>O <I>link</I> corresponde a um conjunto de procedimentos, executados pelo sistema operacional (MCP), com o objetivo de permitir que um programa aplicativo e as sub-rotinas por ele chamadas, compartilhem fisicamente a &aacute;rea definida como de comunica&ccedil;&atilde;o.</FONT> </P>
<FONT SIZE=2><P>O tempo total que um sistema gasta com os procedimentos de <I>links</I> &eacute; consider&aacute;vel, pois, a cada execu&ccedil;&atilde;o de um programa aplicativo, os mesmos <I>links</I> devem ser novamente efetuados.</FONT> </P>
<FONT SIZE=2><P>Na vers&atilde;o 3.2, foi criado, ent&atilde;o, o conceito de sub-rotinas globais, com o intuito de disponibilizar uma nova forma de acesso &agrave;s sub-rotinas dos aplicativos, de modo a eliminar a necessidade de se fazer o <I>link</I> entre o programa aplicativo e suas sub-rotinas todas as vezes que este fosse executado .</FONT> </P>
<FONT SIZE=2><P>Na vers&atilde;o 3.2, todas as sub-rotinas utilizadas pelos programas aplicativos poder&atilde;o ser declaradas no <I>host</I> como globais. </P>
<P>Um programa, denominado na figura de Programa Chamador de sub-rotinas, &eacute; gerado no momento da convers&atilde;o de um sistema para utiliza&ccedil;&atilde;o de sub-rotinas globais ou no momento da gera&ccedil;&atilde;o da <I>library </I>de sub-rotinas globais. Este programa &eacute; compilado e "bindado" automaticamente ao <I>host</I> quando a compila&ccedil;&atilde;o e <I>&nbsp;binder</I> do mesmo forem solicitados.</FONT> </P>
<FONT SIZE=2><P>O Programa Chamador, pelo que a pr&oacute;pria denomina&ccedil;&atilde;o indica, &eacute; o respons&aacute;vel pela chamada efetiva das sub-rotinas dos aplicativos. O seu processo de funcionamento &eacute; o seguinte: toda vez que um programa aplicativo desejar fazer acesso &agrave; uma sub-rotina, este dever&aacute; fazer uma chamada ao Programa Chamador informando ao mesmo os c&oacute;digos da sub-rotina e da &aacute;rea de comunica&ccedil;&atilde;o com as quais ele deseja trabalhar. O Programa Chamador possui todas as sub-rotinas dos programas aplicativos declaradas como globais, ou seja, utiliza aquelas mesmas declara&ccedil;&otilde;es efetuadas no <I>&nbsp;host</I>. Caso a sub-rotina esteja sendo chamada pela primeira vez pelos aplicativos, o Programa Chamador necessita efetuar o <I>link</I> com a mesma. Caso contr&aacute;rio, este <I>&nbsp;link</I> j&aacute; foi anteriormente executado e n&atilde;o precisa ser refeito, pois a sub-rotina continua "linkada".</FONT> </P>
<FONT SIZE=2><P>Ao finalizar o processamento da sub-rotina, o Programa Chamador retorna o controle ao programa aplicativo, j&aacute; com a &aacute;rea de comunica&ccedil;&atilde;o devidamente atualizada, como se o pr&oacute;prio programa tivesse executado efetivamente a chamada &agrave; sub-rotina. Por&eacute;m, neste processo, cujo Programa Chamador serviu apenas de intermedi&aacute;rio, foi economizado um <I>&nbsp;link</I>.</FONT> </P>
<FONT SIZE=2><P>Generalizando, na execu&ccedil;&atilde;o de um <I>&nbsp;host</I>, todas as sub-rotinas por ele utilizadas ser&atilde;o "linkadas" apenas uma vez, somente na primeira vez em que s&atilde;o chamadas, e, da&iacute; por diante, permanecer&atilde;o "linkadas", economizando, assim, o tempo gasto com novos<I> links</I>. </P>
<P>Cumpre ressaltar que, quando utilizado o mecanismo de sub-rotinas globais, estas permanecer&atilde;o "no ar" enquanto os <I>hosts</I> que as utilizam assim permanecerem.</FONT> </P>
<B><FONT SIZE=4><P><A NAME="Imple">Adapta&ccedil;&otilde;es e implementa&ccedil;&otilde;es</A></B></FONT> </P>
<FONT SIZE=2><P>Algumas adapta&ccedil;&otilde;es foram efetuadas em fun&ccedil;&otilde;es j&aacute; existentes do SADS a fim de que fosse poss&iacute;vel implementar este mecanismo de sub-rotinas globais, quais sejam:</FONT> </P><DIR>

<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Parametriza&ccedil;&atilde;o na tabela SBPM5000;</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Cadastramento de sistema;</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Gerador de <I>host</I>;</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Gerador de programas;</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Disparo de compila&ccedil;&atilde;o;</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Disparo de <I>binder</I>;</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Cadastramento de m&oacute;dulo.</FONT> </P>
<FONT SIZE=2><P>Al&eacute;m das altera&ccedil;&otilde;es, duas novas fun&ccedil;&otilde;es foram criadas, quais sejam:</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Gera&ccedil;&atilde;o de <I>library</I> de sub-rotinas globais;</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Libera&ccedil;&atilde;o de <I>library</I> de sub-rotina para produ&ccedil;&atilde;o.</FONT> </P>
<FONT SIZE=2><P>As seguintes implementa&ccedil;&otilde;es estar&atilde;o detalhadamente explicadas neste manual, nas seguintes se&ccedil;&otilde;es:</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Parametriza&ccedil;&atilde;o na tabela SBPM5000: Se&ccedil;&atilde;o V - Item "Sub-rotinas globais";</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Cadastramento de sistema: Se&ccedil;&atilde;o II - Item "Sistema";</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Gera&ccedil;&atilde;o de <I>library</I> de sub-rotinas globais: Se&ccedil;&atilde;o II - Item "Host";</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Libera&ccedil;&atilde;o de <I>library</I> de sub-rotinas globais para produ&ccedil;&atilde;o: Se&ccedil;&atilde;o II - Item "Host".</FONT> </P>
<FONT SIZE=2><P>O gerador de programas, conforme citado anteriormente, foi alterado de modo a criar os programas com as altera&ccedil;&otilde;es adequadas ao esquema de funcionamento das sub-rotinas globais.</FONT> </P>
<FONT SIZE=2><P>Para melhor visualiza&ccedil;&atilde;o das altera&ccedil;&otilde;es efetuadas nos fontes dos programas gerados, ser&atilde;o exibidas a seguir parte dos seguintes fontes:</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Fonte gerado com chamada convencional de sub-rotinas (campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais igual a "N");</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Fonte gerado com utiliza&ccedil;&atilde;o de sub-rotinas globais em teste e produ&ccedil;&atilde;o (campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais igual a "S");</FONT> </P>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Fonte gerado com utiliza&ccedil;&atilde;o de sub-rotinas globais apenas em teste (campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais igual a "T");</P></DIR>

</FONT><B><P>Fonte com chamada convencional de sub-rotinas:</B> </P>
<pre><font size=3><font size=3>
 112311
 112411  PROCEDURE DIVISION.
 112511
 112611  01011-00-INICIO.
 112711
 112811      PERFORM 10011-00-PRINCIPAL THRU 10011-99-EXIT.
 112911
 113011      GO TO 99000-99-EXIT-PROGRAM.
 113111
 113211  01011-99-EXIT.
 113311      EXIT.
 113411$  PAGE
 113511  10011-00-PRINCIPAL.
 113611
 113711      MOVE GBL-DATA                        TO WSS-DATAINV.
 113811      MOVE CORR WSS-DATAINV-RED            TO WSS-DATACAB-RED.
 113911      MOVE CORR WSS-DATAINV-RED            TO WSS-DATA-RED.
 114011
 114111      MOVE "SS/R/SC/02"                    TO GBL-NOMEXT.
 114311      CHANGE ATTRIBUTE TITLE OF "SSRS02"   TO GBL-CHANGE.
 114411
 114511      MOVE "TS/G/SC/03"                    TO GBL-NOMEXT.
 114711      CHANGE ATTRIBUTE TITLE OF "TSGS03"   TO GBL-CHANGE.
 114811
 116111      MOVE GT00I-TLATRS TO WSS-TRANSACAO.
 116211
 116311      IF WSS-NUMTRANS NOT EQUAL 11
 116411         PERFORM 11011-00-PREPARAR THRU 11011-99-EXIT
 116511      ELSE
 116611         PERFORM 30011-00-PROCESSAR THRU 30011-99-EXIT.
 116711
 116811  10011-99-EXIT.
 116911      EXIT.
           ...
 131011
 131111      MOVE GT11I-FUNCEP-RED                TO GS0301-FUNCEP.
 131211
 131311      CALL "TSGS03 OF TSGS03" USING GS0301-TSGS03.
 131411
 131511*     TESTAR A CONDICAO DE ERRO DE ACESSO A SUBROTINA
 131611
 131711     IF GS0301-FUNCODSTA NOT EQUAL ZEROS
 131811        MOVE 1                             TO GBL-ERRO
 131911        MOVE "CEP INVALIDO     
 132011-             "            "               TO GBL-MENSAGEM
 132111        GO TO 99000-99-EXIT-PROGRAM.
 132211
 132311     MOVE "2"                              TO R02-OPCAO.
 132411     MOVE GT11I-FUNADM-RED                 TO R02-DATAMAIOR.
 132511
 132611     CALL "SSRS02 OF SSRS02" USING SSR02-DATAPARM.
 132711
 132811*    TESTAR A CONDICAO DE ERRO DE ACESSO A SUBROTINA
 132911
 133011     IF R02-MENSERRO NOT EQUAL SPACES
 133111        MOVE 1                             TO GBL-ERRO
 133211        MOVE "ERRO NA INVERSAO DA DATA
 133311-            "              "              TO GBL-MENSAGEM
 133411        GO TO 99000-99-EXIT-PROGRAM.
 133511
 133611        MOVE R02-DATARESP TO GT11I-FUNADM.
 133711</pre></font>
<B><FONT SIZE=2><P>Fonte com utiliza&ccedil;&atilde;o de sub-rotinas globais em produ&ccedil;&atilde;o</B> </P>
</FONT><pre><font size=3> 
 112011
 112111  LOCAL-STORAGE SECTION.
 112211  LD  SADS-LD.
 112311  01  SADS-LS                              PIC X(01).
 112411
           ...
 112511$  PAGE
 112611  PROCEDURE DIVISION.
 112711  DECLARATIVES.
 112811  SADSSUBS SECTION.
 112911       USE AS GLOBAL PROCEDURE WITH SADS-LD USING SADS-LS.
 113011
 113111  SISTSUBS SECTION.
 113211       USE AS GLOBAL PROCEDURE WITH SADS-LD USING SADS-LS.
 113311
 113411  END DECLARATIVES.
 113511
 113611  00011-00-INICIO-SECTION.
 113711
 113811  01011-00-INICIO.
 113911
 114011      PERFORM 10011-00-PRINCIPAL THRU 10011-99-EXIT.
 114111
 114211      GO TO 99000-99-EXIT-PROGRAM.
 114311
 114411  01011-99-EXIT.
 114511      EXIT.
 114611$  PAGE
 114711  10011-00-PRINCIPAL.
 114811
 114911      MOVE GBL-DATA                        TO WSS-DATAINV.
 115011      MOVE CORR WSS-DATAINV-RED            TO WSS-DATACAB-RED.
 115111      MOVE CORR WSS-DATAINV-RED            TO WSS-DATA-RED.
 115211
 115311      MOVE GT00I-TLATRS                    TO WSS-TRANSACAO.
 115411  
 115511      IF WSS-NUMTRANS NOT EQUAL 11
 115611         PERFORM 11011-00-PREPARAR THRU 11011-99-EXIT
 115711      ELSE
 115811         PERFORM 30011-00-PROCESSAR THRU 30011-99-EXIT.
 115911
 116011  10011-99-EXIT.
 116111      EXIT.
           ...
 130011
 130111
 130211      MOVE GT11I-FUNCEP-RED                TO GS0301-FUNCEP.
 130311
 130411      MOVE "TSGS03"                        TO GBL-SUB
 130511      CALL SISTSUBS USING GS0301-TSGS03.
 130611
 130711*     TESTAR A CONDICAO DE ERRO DE ACESSO A SUBROTINA
 130811
 130911      IF GS0301-FUNCODSTA NOT EQUAL ZEROS
 131011          MOVE 1                           TO GBL-ERRO
 131111          MOVE "CEP INVALIDO
 131211-               " "                        TO GBL-MENSAGEM
 131311          GO TO 99000-99-EXIT-PROGRAM.
 131411
 131511      MOVE "2"                             TO R02-OPCAO.
 131611      MOVE GT11I-FUNADM-RED                TO R02-DATAMAIOR.
 131711
 131811      MOVE "SSRS02"                        TO GBL-SUB
 131911      CALL SADSSUBS USING SSR02-DATAPARM.
 132011 
 132111*     TESTAR A CONDICAO DE ERRO DE ACESSO A SUBROTINA
 132211
 132311      IF R02-MENSERRO NOT EQUAL SPACES
 132411         MOVE 1                            TO GBL-ERRO
 132511         MOVE "ERRO NA INVERSAO DA DATA
 132611-        " "                               TO GBL-MENSAGEM
 132711         GO TO 99000-99-EXIT-PROGRAM.
 132811
 132911      MOVE R02-DATARESP                    TO GT11I-FUNADM.
 133011</pre></font>
<B><FONT SIZE=2><P>Fonte com utiliza&ccedil;&atilde;o de sub-rotinas globais apenas em teste </P>
</B></FONT><pre><font size=3>
 012511$SET OMIT = NOT SADSSUBGBL
 012611 LOCAL-STORAGE SECTION.
 012711 LD SADS-LD.
 012811 01 SADS-LS PIC X.
 012911$POP OMIT
          ...
 013011 PROCEDURE DIVISION.
 013111$SET OMIT = NOT SADSSUBGBL
 013211 DECLARATIVES.
 013311 SADSSUBS SECTION.
 013411     USE AS GLOBAL PROCEDURE WITH SADS-LD USING SADS-LS.
 013511 SISTSUBS SECTION.
 013611     USE AS GLOBAL PROCEDURE WITH SADS-LD USING SADS-LS.
 013711 END DECLARATIVES.
 013811 00001-00-INICIO-S SECTION.
 013911$POP OMIT
 014011
 014111 01011-00-INICIO.
 014211
 014311     PERFORM 10011-00-PRINCIPAL THRU 10011-99-EXIT.
 014411
 014511     GO TO 99000-99-EXIT-PROGRAM.
 014611
 014711 01011-99-EXIT.
 014811     EXIT.
 014911$ PAGE
 015011 10011-00-PRINCIPAL.
 015111
 015211     MOVE GBL-DATA                         TO WSS-DATAINV.
 015311     MOVE CORR WSS-DATAINV-RED             TO WSS-DATACAB-RED.
 015411     MOVE CORR WSS-DATAINV-RED             TO WSS-DATA-RED.
 015511
 015611$SET OMIT = SADSSUBGBL
 015711     MOVE "SS/R/SC/02"                     TO GBL-NOMEXT.
 015811$POP OMIT
 015911
 016011$SET OMIT = SADSSUBGBL
 016111     CHANGE ATTRIBUTE TITLE OF "SSRS02"    TO GBL-CHANGE.
 016211$POP OMIT
 018711
 018811$SET OMIT = SADSSUBGBL
 018911     MOVE "TS/G/SC/03"                     TO GBL-NOMEXT.
 019011$POP OMIT
 019111
 019211$SET OMIT = SADSSUBGBL
 019311     CHANGE ATTRIBUTE TITLE OF "TSGS03"    TO GBL-CHANGE.
 019411$POP OMIT
 019511
 019611     MOVE GT00I-TLATRS                     TO WSS-TRANSACAO.
 019711
 019811     IF WSS-NUMTRANS NOT EQUAL 11
 019911        PERFORM 11011-00-PREPARAR THRU 1011-99-EXIT
 020011     ELSE
 020111        PERFORM 30011-00-PROCESSAR THRU 30011-99-EXIT.
 020211
 020311 10011-99-EXIT.
 020411     EXIT.
 034311
           ...

 034511     MOVE GT11I-FUNCEP-RED                 TO GS0301-FUNCEP.
 034611
 034711$SET OMIT = SADSSUBGBL
 034811     CALL "TSGS03 OF TSGS03" USING GS0301-TSGS03.
 034911$POP OMIT
 035011$SET OMIT = NOT SADSSUBGBL
 035111     MOVE "TSGS03"                         TO GBL-SUB
 035211     CALL SISTSUBS USING GS0301-TSGS03.
 035311$POP OMIT
 035411
 035511*    TESTAR A CONDICAO DE ERRO DE ACESSO A SUBROTINA
 035611
 035711     IF GS0301-FUNCODSTA NOT EQUAL ZEROS
 035911        MOVE 1                             TO GBL-ERRO
 036011     MOVE "CEP INVALIDO
 036111-         "        "                       TO GBL-MENSAGEM
 036211        GO TO 99000-99-EXIT-PROGRAM.
 036311
 036411     MOVE "2"                              TO R02-OPCAO.
 036511     MOVE GT11I-FUNADM-RED                 TO R02-DATAMAIOR.
 036611
 036711$SET OMIT = SADSSUBGBL
 036811     CALL "SSRS02 OF SSRS02" USING SSR02-DATAPARM.
 036911$POP OMIT
 037011$SET OMIT = NOT SADSSUBGBL
 037111     MOVE "SSRS02"                         TO GBL-SUB
 037211     CALL SADSSUBS USING SSR02-DATAPARM.
 037311$POP OMIT
 037411
 037511*    TESTAR A CONDICAO DE ERRO DE ACESSO A SUBROTINA
 037611
 037711     IF R02-MENSERRO NOT EQUAL SPACES
 037911        MOVE 1                             TO GBL-ERRO
 038011        MOVE "ERRO NA INVERSAO DA DATA
 038111-            "           "                 TO GBL-MENSAGEM
 038211        GO TO 99000-99-EXIT-PROGRAM.
 038311
 038411      MOVE R02-DATARESP                    TO GT11I-FUNADM.
 038511</pre></font>
<B><FONT SIZE=4><P><A NAME="Conver">Convers&atilde;o de sistemas antigos para utiliza&ccedil;&atilde;o de sub-rotinas globais</A></B></FONT><FONT SIZE=2> </P>
<P>A fim de possibilitar e automatizar os procedimentos relativos &agrave; utiliza&ccedil;&atilde;o de sub-rotinas globais pelos sistemas j&aacute; existentes, que utilizam chamadas de sub-rotinas de forma convencional, foram implementados os seguintes processos: </P><DIR>

</FONT><P><IMG SRC="Seta.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Convers&atilde;o para utiliza&ccedil;&atilde;o de sub-rotinas globais: Processo atrav&eacute;s do qual os fontes dos programas de um sistema s&atilde;o alterados atrav&eacute;s de um Programa Conversor a fim de adapt&aacute;-los &agrave; utiliza&ccedil;&atilde;o do mecanismo de sub-rotinas globais; </P>
</FONT><P><IMG SRC="Seta.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Exclus&atilde;o de chamadas convencionais de sub-rotinas: Processo atrav&eacute;s do qual possam ser exclu&iacute;das todas as chamadas convencionais de sub-rotinas contidas nos fontes dos programas de um sistema convertido, que j&aacute; esteja utilizando sub-rotinas globais no ambiente de teste e produ&ccedil;&atilde;o; e </P>
</FONT><P><IMG SRC="Seta.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Revers&atilde;o do processo da convers&atilde;o: Processo atrav&eacute;s do qual um sistema que tenha sido convertido para utilizar sub-rotinas globais apenas no ambiente de teste possa retornar &agrave; sua condi&ccedil;&atilde;o anterior, utilizando apenas chamadas de sub-rotinas da forma convencional.</P></DIR>

<P>A seguir, cada um destes processos ser&aacute; explicado detalhadamente. </P>
<B><P><A NAME="Subglo">Convers&atilde;o para utiliza&ccedil;&atilde;o de sub-rotinas globais</A></B> </P>
<P>A convers&atilde;o de sistemas antigos para utiliza&ccedil;&atilde;o de sub-rotinas globais somente ser&aacute; poss&iacute;vel caso esteja parametrizado que a instala&ccedil;&atilde;o pode fazer uso desta implementa&ccedil;&atilde;o. Esta parametriza&ccedil;&atilde;o &eacute; feita na tabela SBPM5000, CODIGO = "SUBGBL", PAR-3 = "L" (livre) ou "O" (obrigat&oacute;rio). </P>
<P>A convers&atilde;o destes sistemas pode ser feita de duas formas distintas, a saber: </P><DIR>

</FONT><P><IMG SRC="Seta.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Caso os programas sejam gerados completamente pelo SADS, pode-se alterar o campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais para "S" (menu "DEFSIS") e gerar novamente todos os programas do sistema, incluindo os<I> hosts</I>. </P>
<P>Neste caso, as atividades a serem efetuadas s&atilde;o as mesmas processadas para um sistema novo. Estas atividades est&atilde;o descritas a seguir, no t&oacute;pico "Cria&ccedil;&atilde;o de novos sistemas utilizando sub-rotinas globais". </P>
<P>Por&eacute;m, esta forma de convers&atilde;o possui o seguinte inconveniente: dado que o sistema &eacute; antigo, ele j&aacute; deve estar em produ&ccedil;&atilde;o, efetuando, neste ambiente, as chamadas de sub-rotinas na forma convencional. Caso seja necess&aacute;ria uma manuten&ccedil;&atilde;o no programa em ambiente de produ&ccedil;&atilde;o, o fonte rec&eacute;m-gerado n&atilde;o pode ser compilado para produ&ccedil;&atilde;o sem antes sofrer altera&ccedil;&otilde;es, pois ele j&aacute; possui as chamadas de sub-rotinas como globais, que &eacute; incompat&iacute;vel com o tratamento de sub-rotinas pelo sistema naquele ambiente. </P>
<P>Portanto, esta forma de convers&atilde;o do sistema para utiliza&ccedil;&atilde;o de sub-rotinas globais gera problemas de incompatibilidade de programas nos dois ambientes. </P>
</FONT><P><IMG SRC="Seta.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>A outra forma de convers&atilde;o &eacute; atrav&eacute;s da execu&ccedil;&atilde;o de um Programa Conversor, que propicia a migra&ccedil;&atilde;o gradativa do sistema, sem o inconveniente da incompatibilidade de programas nos dois ambientes - teste e produ&ccedil;&atilde;o.<I> </I>Por este m&eacute;todo de convers&atilde;o, as duas possibilidades de utiliza&ccedil;&atilde;o de sub-rotinas s&atilde;o inclu&iacute;das nos fontes dos programas, atrav&eacute;s de diretivas de compila&ccedil;&atilde;o, propiciando as seguintes situa&ccedil;&otilde;es: caso os programas sejam compilados para teste, as chamadas das sub-rotinas ser&atilde;o feitas pelo mecanismo de sub-rotinas globais; caso um mesmo programa seja compilado para produ&ccedil;&atilde;o, sem nenhuma altera&ccedil;&atilde;o em seu fonte, as chamadas das sub-rotinas ser&atilde;o feitas de forma convencional. </P>
<P>O programa respons&aacute;vel pela convers&atilde;o, baseia-se nos fontes dos <I>hosts</I> e programas aplicativos do sistema para criar os fontes dos <I>hosts</I> e programas aplicativos convertidos para utiliza&ccedil;&atilde;o global de sub-rotinas. Al&eacute;m disso, o Programa Conversor, tamb&eacute;m denominado filtro, gera os Programas Chamadores de sub-rotinas e as <I>libraries </I>de chamada das sub-rotinas da aplica&ccedil;&atilde;o a serem incorporados aos <I>hosts</I> do sistema no momento da compila&ccedil;&atilde;o. Cada <I>&nbsp;host</I> possui seu respectivo Programa Chamador de sub-rotinas e sua respectiva <I>library</I> de sub-rotinas.</P></DIR>

<P>O programa de convers&atilde;o pode ser disparado atrav&eacute;s do comando RUN SDR07 em qualquer<I> usercode</I>, desde que o mesmo esteja devidamente cadastrado na tabela SBPM5002. O <I>usercode</I> de objetos em teste relativo ao <I>usercode</I> onde a convers&atilde;o foi disparada, que se encontra cadastrado nesta tabela, ser&aacute; utilizado para: </P><DIR>

</FONT><P><IMG SRC="Seta.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Localizar as <I>libraries</I> de <I>procedure </I>utilizadas pelos programas que opcionalmente poder&atilde;o ser convertidas; </P>
</FONT><P><IMG SRC="Seta.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Gerar a <I>library</I> de sub-rotinas globais e o Programa Chamador de sub-rotinas para cada <I>&nbsp;host</I> do sistema.</P></DIR>

<P>A seguir, &eacute; apresentado os campos da tela utilizada pelo programa SDR07, para o disparo da convers&atilde;o de sistemas antigos para utiliza&ccedil;&atilde;o de sub-rotinas globais: </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SISTEMA/HOST</B> - C&oacute;digo do sistema a ser convertido, no padr&atilde;o SADS (sss), ou c&oacute;digo do<I> host</I> cujo programa ser&aacute; convertido, no padr&atilde;o SADS (sssNxx). </P>
<P>Deste modo, pode-se converter todo o sistema (todos os <I>hosts</I> e programas <I>on-line </I>do sistema) ou apenas um programa chamado espec&iacute;fico. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PROGRAMA</B> - Identificador num&eacute;rico do programa a ser convertido, caso se queira converter apenas um programa espec&iacute;fico do sistema informado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>CONVERTER LIBRARIES DE PROCEDURE (S/N)</B> - Indicador de convers&atilde;o das <I>libraries</I> de <I>procedure</I> que s&atilde;o utilizadas pelo(s) programa(s) a ser(em) convertido(s).</P></DIR>

<P>Em rela&ccedil;&atilde;o &agrave; convers&atilde;o das<I> libraries</I> de <I>procedure</I> utilizadas pelos programas, tem-se as seguintes considera&ccedil;&otilde;es: </P>

<UL TYPE="SQUARE">
<LI>&Eacute; opcional; </LI>
<LI>Ser&atilde;o convertidas aquelas que se encontrarem no<I> usercode</I> de objetos em teste relativo ao <I>usercode</I> de disparo da convers&atilde;o; </LI>
<LI>Somente ser&atilde;o convertidas aquelas que forem copiadas inteiramente, sem especifica&ccedil;&atilde;o de sequ&ecirc;ncia de linhas (FROM nnnnnn THRU nnnnnn); </LI>
<LI>Elas ser&atilde;o ressequenciadas no momento da convers&atilde;o, de 100 em 100, a partir da linha 100; </LI>
<LI>Ap&oacute;s a convers&atilde;o, elas devem ser liberadas para a produ&ccedil;&atilde;o, atrav&eacute;s do menu "LIBLIBPRO".</LI></UL>

<P>O Programa Conversor atualiza o campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais - UTILIZACAO SUB-ROTINAS GLOBAIS (S/N) - para "T", indicando que o sistema ir&aacute; primeiramente utilizar as sub-rotinas globais no ambiente de teste e continuar&aacute; utilizando as sub-rotinas de forma convencional no ambiente de produ&ccedil;&atilde;o. Ap&oacute;s o sistema ter sido compilado e testado, deve-se alterar este campo para "S", para indicar que as sub-rotinas tamb&eacute;m ser&atilde;o utilizadas como globais no ambiente de produ&ccedil;&atilde;o. </P>
<P>O Programa Conversor emite um relat&oacute;rio - SDRR01 - com informa&ccedil;&otilde;es referentes ao processo de convers&atilde;o disparado, quais sejam: </P>

<UL TYPE="CIRCLE">
<LI>Identifica&ccedil;&atilde;o de in&iacute;cio e t&eacute;rmino da convers&atilde;o de cada um dos programas do sistema; </LI>
<LI>Sub-rotinas utilizadas pelos programas que n&atilde;o est&atilde;o cadastradas como recursos dos mesmos; </LI>
<I><LI>Libraries</I> de<I> procedure</I> que n&atilde;o foram convertidas e causa, e </LI>
<LI>Qualquer outra irregularidade detectada no momento da convers&atilde;o.</LI></UL>

<P>Resumindo, para a convers&atilde;o de sistemas antigos utilizando o Programa Conversor, os seguintes procedimentos devem ser efetuados, na mesma ordem em que s&atilde;o apresentados: </P>

<UL TYPE="CIRCLE">
<LI>Certificar se o campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais - UTILIZACAO SUB-ROTINAS GLOBAIS (S/N) - &eacute; igual a "N" ou " " - menu "DEFSIS"; </LI>
<LI>Gerar novamente (ou descompactar) todos os fontes a serem convertidos - menu "GERPRO" (ou "COPFONMAN"). &Eacute; aconselh&aacute;vel obter uma salva de todos os fontes antes de iniciar o processo de convers&atilde;o; </LI>
<LI>Executar o programa de convers&atilde;o - RUN SDR07, informando o c&oacute;digo do sistema (ou do programa) a ser convertido. Informando o c&oacute;digo do sistema, todos os <I>&nbsp;hosts</I> e programas chamados tamb&eacute;m ser&atilde;o convertidos e o campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais pelo sistema - UTILIZACAO SUB-ROTINAS GLOBAIS (S/N) - ser&aacute; alterado para "T"; </LI>
<LI>Compilar e efetuar o <I>&nbsp;binder </I>do sistema para o ambiente de teste - menus "COMPRO" e "BINPRO"; </LI>
<LI>Testar o sistema; </LI>
<LI>Alterar o campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais pelo sistema - UTILIZACAO SUB-ROTINAS GLOBAIS (S/N) - para "S" - menu "DEFSIS; </LI>
<LI>Liberar cada uma das <I>&nbsp;libraries </I>de declara&ccedil;&atilde;o de sub-rotinas do aplicativo para o ambiente de produ&ccedil;&atilde;o"- menu "LIBLIBGBL"; </LI>
<LI>Liberar para a produ&ccedil;&atilde;o todas as <I>&nbsp;libraries</I> de<I> procedure</I> alteradas pelo filtro - menu "LIBLIBPRO"; </LI>
<LI>Compilar e efetuar o <I>&nbsp;binder</I> do sistema para o ambiente de produ&ccedil;&atilde;o - menus "COMPRO" e "BINPRO".</LI></UL>

<B><P><A NAME="Exclu">Exclus&atilde;o de chamadas convencionais de sub-rotinas</A></B> </P>
<P>Ap&oacute;s o sistema ter sido convertido para utiliza&ccedil;&atilde;o de sub-rotinas globais nos ambientes de teste e produ&ccedil;&atilde;o, poder&aacute; ser feita, caso desej&aacute;vel, a exclus&atilde;o das linhas de chamadas convencionais de sub-rotinas nos fontes de seus programas convertidos. Este processo tem o objetivo de "limpar" os fontes dos programas, visto que, se o sistema j&aacute; est&aacute; utilizando sub-rotinas globais em ambos os ambientes, n&atilde;o existe mais necessidade das linhas de comando de chamadas convencionais de sub-rotinas internamente aos seus programas fontes. Portanto, este processo n&atilde;o ser&aacute; aceito quando o sistema estiver utilizando sub-rotinas globais apenas no ambiente de teste. </P>
<P>A exclus&atilde;o de chamadas convencionais de sub-rotinas pode ser feita automaticamente atrav&eacute;s da execu&ccedil;&atilde;o do programa SDR08 - RUN SDR08 - no<I> Cande</I>.<I> </I>Este programa ir&aacute; apresentar a tela SDR08.00, onde dever&aacute; ser informado o seguinte campo: </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SISTEMA/PROGRAMA</B> - Argumento para a exclus&atilde;o de chamadas convencionais de sub-rotinas, que pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>C&oacute;digo do sistema em cujos fontes de programas ser&atilde;o efetuadas as exclus&otilde;es ou </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>C&oacute;digo do programa em cujo fonte ser&atilde;o efetuadas as exclus&otilde;es de chamadas convencionais de sub-rotinas.</P></DIR>

<P>O programa SDR08 gera, para cada programa aplicativo processado, um arquivo contendo os desenhos de todas suas linhas que foram exclu&iacute;das. O c&oacute;digo deste arquivo gerado &eacute; "LIMP/ss/s/NF/nn", onde "ss/s/NF/nn" &eacute; o c&oacute;digo do fonte do programa. </P>
<B><P><A NAME="Rever">Revers&atilde;o do processo de convers&atilde;o</A></B> </P>
<P>Ap&oacute;s o sistema ter sido convertido para utiliza&ccedil;&atilde;o de sub-rotinas globais apenas no ambiente de teste e ainda n&atilde;o ter sido convertido no ambiente de produ&ccedil;&atilde;o, pode-se, caso necess&aacute;rio, reverter o processo de convers&atilde;o. Desta forma, pode-se retorn&aacute;-lo &agrave; condi&ccedil;&atilde;o anterior, contendo apenas chamadas de sub-rotinas da forma convencional. Neste processo, as linhas de comando que possibilitavam a utiliza&ccedil;&atilde;o de sub-rotinas globais, que foram inclu&iacute;das no processo de convers&atilde;o, ser&atilde;o, ent&atilde;o, exclu&iacute;das dos fontes de seus programas. </P>
<P>A revers&atilde;o do processo de convers&atilde;o poder&aacute; ser efetuada atrav&eacute;s da execu&ccedil;&atilde;o do <I>&nbsp;job</I> SD/R/JB/10, no<I> Cande</I>. Antes de disparar o <I>job</I>, deve-se prepar&aacute;-lo efetuando as seguintes substitui&ccedil;&otilde;es: </P><DIR>

<P>"PKSADS" pelo disco do <I>&nbsp;Control File </I>do banco do SADS e </P>
<P>"XXX" do arquivo par&acirc;metro SDDA90 pelo sistema para o qual o processo de convers&atilde;o inversa ser&aacute; efetuado.</P></DIR>

<P>A &uacute;nica forma de retornar um sistema para utiliza&ccedil;&atilde;o convencional de sub-rotinas &eacute; atrav&eacute;s da execu&ccedil;&atilde;o deste <I>&nbsp;job</I>, pois, na defini&ccedil;&atilde;o do sistema, n&atilde;o &eacute; permitido alterar manualmente o campo UTILIZACAO SUB-ROTINAS GLOBAIS (S/N) de "T" ou "S" para "N". </P>
<P>Cumpre ressaltar que, o processo de revers&atilde;o da convers&atilde;o s&oacute; &eacute; poss&iacute;vel enquanto o sistema utilizar sub-rotinas globais apenas no ambiente de teste - campo UTILIZACAO SUB-ROTINAS GLOBAIS (S/N) igual a "T". Ap&oacute;s o sistema ser liberado para utiliza&ccedil;&atilde;o de sub-rotinas globais no ambiente de produ&ccedil;&atilde;o - campo UTILIZACAO SUB-ROTINAS GLOBAIS (S/N) igual a "S" - nem mesmo com a execu&ccedil;&atilde;o de<I> jobs</I> o processo ser&aacute; revertido. </P></DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Criac">Cria&ccedil;&atilde;o de novos sistemas utilizando sub-rotinas globais</A></B></FONT><FONT SIZE=2> </P>
<P>Para a cria&ccedil;&atilde;o de novos sistemas utilizando sub-rotinas globais, os seguintes procedimentos devem ser efetuados, na mesma ordem em que s&atilde;o apresentados: </P>

<UL TYPE="CIRCLE">
<LI>Informar "S" no campo indicador de utiliza&ccedil;&atilde;o de sub-rotinas globais pelo sistema - UTILIZACAO SUB-ROTINAS GLOBAIS (S/N) - menu "DEFSIS"; </LI>
<LI>Definir e gerar todos os programas chamados e<I> hosts</I> do sistema - menus "DEFPRO"(e demais encadeados) e "GERPRO"; <BR>
Deve-se certificar que os comandos CALL codificados em EDITs - COB, EXCEC, EDIT - foram definidos com chamada &agrave;s sub-rotinas de acordo com o mecanismo de utiliza&ccedil;&atilde;o global de sub-rotinas. </LI>
<LI>Gerar as <I>&nbsp;libraries</I> de declara&ccedil;&atilde;o de sub-rotinas dos <I>&nbsp;hosts </I>do sistema para o ambiente de teste - menu "LIBSUBGBL"; </LI>
<LI>Compilar e testar o sistema no ambiente de teste - menu "COMPRO"; </LI>
<LI>Liberar as <I>&nbsp;libraries </I>de declara&ccedil;&atilde;o de sub-rotinas dos<I> hosts</I> do sistema para o ambiente de produ&ccedil;&atilde;o - menu "LIBLIBGBL"; </LI>
<LI>Compilar o sistema para o ambiente de produ&ccedil;&atilde;o - menu "COMPRO". <BR>
Sempre que uma nova sub-rotina for utilizada por um programa do sistema e esta seja diferente daquelas j&aacute; utilizadas pelos demais programas do mesmo <I>&nbsp;host</I>, os seguintes procedimentos devem ser novamente efetuados: </LI>
<LI>Definir a nova sub-rotina como recurso do programa - menu "RECPRO"; </LI>
<LI>Gerar a <I>library</I> de declara&ccedil;&atilde;o de sub-rotinas do <I>&nbsp;host </I>relativo ao programa alterado para o ambiente de teste -menu "LIBSUBGBL"; </LI>
<LI>Compilar e efetuar o<I> binder</I> do<I> host</I> do programa para o ambiente de teste - menus "COMPRO"e "BINPRO"; </LI>
<LI>Liberar a <I>library </I>de declara&ccedil;&atilde;o de sub-rotinas do<I> host</I> do programa para o ambiente de produ&ccedil;&atilde;o - menu "LIBLIBGBL"; </LI>
<LI>Compilar e efetuar o<I> binder</I> do <I>host</I> do programa para o ambiente de produ&ccedil;&atilde;o - menus "COMPRO"e "BINPRO". </LI></UL>

</FONT><B><FONT SIZE=5><P><A NAME="Subsad">Sub-rotinas do SADS para utiliza&ccedil;&atilde;o pelos aplicativos</A></B></FONT><FONT SIZE=2> </P>
<P>Um sistema desenvolvido atrav&eacute;s do SADS utiliza sub-rotinas para as mais variadas fun&ccedil;&otilde;es, em geral, de forma transparente. Algumas, por&eacute;m, t&ecirc;m utiliza&ccedil;&atilde;o gen&eacute;rica e devem ter seu acesso codificado nos programas, s&atilde;o elas: </P>

<UL TYPE="CIRCLE">
<LI>Sub-rotina para acesso aos itens de tabela; </LI>
<LI>Sub-rotina para c&aacute;lculo e valida&ccedil;&atilde;o de d&iacute;gito verificador; </LI>
<LI>Sub-rotina para manipula&ccedil;&atilde;o de datas: valida&ccedil;&atilde;o, invers&atilde;o, diferen&ccedil;a entre datas, dentre outras fun&ccedil;&otilde;es; </LI>
<LI>Subrotina para consulta a elementos do reposit&oacute;rio de dados do SADS: consulta nome e c&oacute;digo externo de elementos do reposit&oacute;rio de dados do SADS, e para consulta a nome, descri&ccedil;&atilde;o e validade de atributos e campos. </LI>
<LI>Sub-rotina para testes e fun&ccedil;&otilde;es de controle do Sistema de Seguran&ccedil;a; </LI>
<LI>Sub-rotina para consulta a dados do Sistema de Seguran&ccedil;a; </LI>
<LI>Sub-rotina para bloqueio de usu&aacute;rio do Sistema de Seguran&ccedil;a.</LI></UL>

<P>Existem certos tipos de sub-rotinas que s&atilde;o disparadas pelo SADS, e n&atilde;o pelos aplicativos, mas que t&ecirc;m de ser constru&iacute;das dentro dos sistemas, quando necess&aacute;rias. S&atilde;o elas: </P>

<UL TYPE="CIRCLE">
<LI>Sub-rotina para tratamento de exclus&atilde;o de itens de tabela; </LI>
<LI>Sub-rotina espec&iacute;fica para Consist&ecirc;ncia Geral: para consist&ecirc;ncia espec&iacute;fica de atributos e campos em telas de entrada de dados e tabelas; </LI>
<LI>Sub-rotina para consist&ecirc;ncias espec&iacute;ficas de usu&aacute;rios do Sistema de Seguran&ccedil;a.</LI></UL>

<P>Cada uma dessas sub-rotinas e os procedimentos necess&aacute;rios para efetivar suas utiliza&ccedil;&otilde;es encontram-se explicadas a seguir. </P>
</FONT><B><FONT SIZE=4><P><A NAME="Subtab">Sub-rotina para acesso aos itens de tabela - SSTS01</A></B></FONT><FONT SIZE=2> </P>
<P>O Sistema de Tabelas permite aos programas aplicativos consultar os itens das tabelas cadastradas no SADS. Esta consulta &eacute; possibilitada pela sub-rotina SSTS01, que busca os itens desejados na base de dados do SADS e os devolve para o programa aplicativo. </P>
<P><A NAME="SSTS01">&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina SSTS01 (Library SS/T/SL/01)</A> </P>
<P>Para executar o acesso aos itens via sub-rotina SSTS01, os programas aplicativos devem utilizar os atributos contidos na <I>library</I> de &aacute;rea de comunica&ccedil;&atilde;o descrita a seguir: </P>
</FONT><pre><font size=3>
   01    TS0101-SSTS01.
         10  TS0101-OPCAO                  PIC 9(002).
         10  TS0101-RESULT                 PIC 9(002).
         10  TS0101-VERSAO                 PIC 9(004).
         10  TS0101-UNDUSUSADS             PIC 9(002).
         10  TS0101-EMPCOD                 PIC 9(003).
         10  TS0101-ETBCOD                 PIC 9(004).
         10  TS0101-UNDCOD                 PIC 9(003).
         10  TS0101-TBLCOD                 PIC X(008).
         10  TS0101-TBLARG                 PIC X(030).
         10  TS0101-TBLPESQ                PIC X(001).
         10  TS0101-TBLSTA                 PIC 9(001).
         10  TS0101-TBLDATATU              PIC 9(006).
         10  TS0101-TBLHORATU              PIC 9(006).
         10  TS0101-TBLITEM                PIC X(300).
         10  TS0101-TABTIPDAT              PIC 9(001).
         10  TS0101-TABAMBI                PIC X(001).
         10  TS0101-CSTIDT                 PIC X(001).
         10  TS0101-CCSARGUM               PIC X(050).
         10  TS0101-MENSCOD                PIC X(005).</pre></font>
<FONT SIZE=2><P>O acesso aos itens das tabelas somente ser&aacute; poss&iacute;vel se cada um destes campos for devidamente preenchido nos programas aplicativos, conforme a seguir: </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-UNDUSUSADS</B> - Unidade de usu&aacute;rio SADS. </P>
<P>Este campo n&atilde;o precisa ser composto, pois sua utiliza&ccedil;&atilde;o n&atilde;o se encontra implementada na vers&atilde;o corrente do SADS. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-EMPCOD</B> - C&oacute;digo da empresa. </P>
<P>Em programas <I>on-line</I> que utilizam o Sistema de Seguran&ccedil;a do SADS e conforme o crit&eacute;rio de unidade de armazenamento especificado para a tabela, este campo deve ser sempre composto com GBL-EMPCOD. Em programas <I>batch</I> e sub-rotinas, deve-se compor este campo de acordo com a necessidade espec&iacute;fica de cada um. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-ETBCOD</B> - C&oacute;digo do estabelecimento. </P>
<P>Em programas <I>on-line</I> que utilizam o Sistema de Seguran&ccedil;a do SADS e conforme o crit&eacute;rio de unidade de armazenamento especificado para a tabela, este campo deve ser sempre composto com GBL-ETBCOD. Em programas <I>batch</I> e sub-rotinas, deve-se compor este campo de acordo com a necessidade espec&iacute;fica de cada um. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-UNDCOD </B>- C&oacute;digo da unidade. </P>
<P>Em programas <I>on-line</I> que utilizam o Sistema de Seguran&ccedil;a do SADS e conforme o crit&eacute;rio de unidade de armazenamento especificado para a tabela, este campo deve ser sempre composto com GBL-UNDCOD. Em programas <I>batch</I> e sub-rotinas, deve-se compor este campo de acordo com a necessidade espec&iacute;fica de cada um. </P>
<P>A tabela a seguirexemplifica como compor os campos TS0101-EMPCOD, TS0101-ETBCOD e TS0101-UNDCOD da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina, conforme o crit&eacute;rio de unidade de armazenamento especificado para a tabela: </P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=604>
<TR><TD VALIGN="MIDDLE" COLSPAN=5>
<P ALIGN="CENTER"><FONT SIZE=2>CRIT&Eacute;RIO DE ARMAZENAMENTO</FONT></TD>
</TR>
<TR><TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">NENHUM</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">EMPRESA</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">ESTABELEC.</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">UNIDADE</FONT></TD>
</TR>
<TR><TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0101-EMPCOD</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>ZERO</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>GBL-EMPCOD </FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>GBL-EMPCOD</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>GBL-EMPCOD</FONT></TD>
</TR>
<TR><TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0101-ETBCOD</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>ZERO</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>ZERO </FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>GBL-ETBCOD</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>GBL-ETBCOD</FONT></TD>
</TR>
<TR><TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0101-UNDCOD</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>ZERO</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>ZERO </FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>ZERO</FONT></TD>
<TD WIDTH="20%" VALIGN="MIDDLE">
<FONT SIZE=2><P>GBL-UNDCOD</FONT></TD>
</TR>
</TABLE>
<DIR>

<FONT SIZE=2><P>Os campos GBL-EMPCOD, GBL-ETBCOD e GBL-UNDCOD somente podem ser utilizados por programas <I>&nbsp;on-line</I> que utilizem o Sistema de Seguran&ccedil;a do SADS. Caso contr&aacute;rio, eles devem ser compostos de acordo com a necessidade espec&iacute;fica. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-TBLCOD</B> - C&oacute;digo da tabela, no padr&atilde;o SADS (sssMnnnn), cujos itens ser&atilde;o acessados . </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-TABAMBI</B> - Ambiente da tabela ("T" ou "P"). </P>
<P>Em programas <I>&nbsp;on-line</I> que utilizam o Sistema de Seguran&ccedil;a do SADS, este campo deve ser composto com GBL-USUAMBI, que &eacute; o ambiente onde o usu&aacute;rio efetuou o <I>&nbsp;logon</I>. Em programas <I>&nbsp;batch</I> e sub-rotinas, deve-se compor este campo de acordo com a necessidade espec&iacute;fica. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-TBLPESQ</B> - Tipo de pesquisa. </P>
<P>Os valores poss&iacute;veis s&atilde;o os seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" (Sequencial); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"R" (Rand&ocirc;mico); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"C" (Teste de exist&ecirc;ncia do item); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"E" (Teste de exist&ecirc;ncia da tabela); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"L" (Acesso sequencial invertido); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"U" (Acesso ao &uacute;ltimo item da tabela); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" (Acesso rand&ocirc;mico ao pr&oacute;ximo item). Caso o item<I> </I>especificado n&atilde;o exista, o acesso ser&aacute; ao pr&oacute;ximo item; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"A" (Acesso rand&ocirc;mico ao item anterior). Caso o item especificado n&atilde;o exista, acessa o item anterior; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"D" (Pesquisa rand&ocirc;mica por validade de data).</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-TBLARG</B> - Argumento de pesquisa da tabela via chave convencional. </P>
<P>Para iniciar uma pesquisa sequencial, informe brancos ou a chave anterior ao primeiro item a ser lido. </P>
<P>Caso a tabela tenha especifica&ccedil;&atilde;o de crit&eacute;rio de valida&ccedil;&atilde;o por data, ela deve ser informada no formato AAMMDD (ano, m&ecirc;s, dia) no argumento de pesquisa. </P>
<P>Este campo pode ser opcional ou obrigat&oacute;rio, dependendo do tipo de pesquisa, conforme &eacute; mostrado no quadro a seguir: </P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=544>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<P><FONT SIZE=2>TBLPESQ</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TBLARG</FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"S"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Opcional. A partir da segunda leitura por acesso sequencial, n&atilde;o &eacute; necess&aacute;rio compor novamente os campos da &aacute;rea de comunica&ccedil;&atilde;o. </FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"R"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. </FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"C"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. </FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"E"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>N&atilde;o precisa ser informado. </FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"L"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Opcional. A partir da segunda leitura desta forma de acesso, n&atilde;o &eacute; necess&aacute;rio compor novamente os campos da &aacute;rea de comunica&ccedil;&atilde;o. </FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"U"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>N&atilde;o precisa ser informado. O sistema busca o &uacute;ltimo item da tabela. </FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"P"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. O sistema busca o item especificado. Caso n&atilde;o o encontre, o acesso ser&aacute; feito ao item imediatamente posterior ao informado. </FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"A"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. O sistema busca o item especificado. Caso n&atilde;o o encontre, o acesso ser&aacute; feito ao item imediatamente anterior ao informado. </FONT></TD>
</TR>
<TR><TD WIDTH="16%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"D"</FONT></TD>
<TD WIDTH="84%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. O sistema busca o item especificado considerando tamb&eacute;m o crit&eacute;rio de valida&ccedil;&atilde;o por data (1, 2 ou 3). </FONT></TD>
</TR>
</TABLE>
<DIR>

<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-TBLSTA</B> - Indica o resultado da pesquisa processada. </P>
<P>Os valores informados s&atilde;o os seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"0" - Opera&ccedil;&atilde;o efetuada com sucesso; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"1" - Tabela ou item n&atilde;o encontrado, tipo de pesquisa inv&aacute;lido ou fim de pesquisa.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-TBLITEM</B> - Retorna os dados contidos no item pesquisado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-CSTIDT</B> - Indicador da chave secund&aacute;ria que ser&aacute; utilizada no acesso, podendo assumir os valores "B, "C" ou "D". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-CCSARGUM</B> - Argumento para pesquisa via chave secund&aacute;ria. </P>
<P>Para iniciar uma pesquisa sequencial, informe brancos ou a chave anterior ao primeiro item a ser lido, na chave secund&aacute;ria. </P>
<P>Este campo pode ser opcional ou obrigat&oacute;rio, conforme o tipo de pesquisa - TS0101-TBLPESQ. Ver quadro a seguir: </P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=558>
<TR><TD WIDTH="12%" VALIGN="MIDDLE">
<P><FONT SIZE=2>TBLPESQ</FONT></TD>
<TD WIDTH="88%" VALIGN="MIDDLE">
<FONT SIZE=2><P>CCSARGUM</FONT></TD>
</TR>
<TR><TD WIDTH="12%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"S"</FONT></TD>
<TD WIDTH="88%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Opcional. A partir da segunda leitura por acesso sequencial, n&atilde;o &eacute; necess&aacute;rio compor os campos da &aacute;rea de comunica&ccedil;&atilde;o. </FONT></TD>
</TR>
<TR><TD WIDTH="12%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"R"</FONT></TD>
<TD WIDTH="88%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. Se houver v&aacute;rios itens com a chave especifcada, o acesso ser&aacute; executado para o primeiro item. </FONT></TD>
</TR>
<TR><TD WIDTH="12%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"C"</FONT></TD>
<TD WIDTH="88%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. Se o retorno do TS0101-TBLSTA for diferente de zero, significa que nehum item foi encontrado com o valor da chave secund&aacute;ria especificado. </FONT></TD>
</TR>
<TR><TD WIDTH="12%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"U"</FONT></TD>
<TD WIDTH="88%" VALIGN="MIDDLE">
<FONT SIZE=2><P>N&atilde;o informar. O sistema busca o item de maior valor na chave secund&aacute;ria. </FONT></TD>
</TR>
<TR><TD WIDTH="12%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"L"</FONT></TD>
<TD WIDTH="88%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Opcional. A partir da segunda leitura, n&atilde;o &eacute; necess&aacute;ria a composi&ccedil;&atilde;o dos campos da &aacute;rea de comunica&ccedil;&atilde;o. </FONT></TD>
</TR>
<TR><TD WIDTH="12%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"A"</FONT></TD>
<TD WIDTH="88%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. O sistema busca o item especificado. Caso n&atilde;o o encontre, procurar&aacute; ter acesso ao item de chave secund&aacute;ria cujo valor &eacute; imediatamente inferior ao informado. </FONT></TD>
</TR>
<TR><TD WIDTH="12%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&nbsp;&nbsp;&nbsp;&nbsp;"P"</FONT></TD>
<TD WIDTH="88%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Obrigat&oacute;rio. O sistema busca o item com a chave secund&aacute;ria especificada. Caso n&atilde;o o encontre, procurar&aacute; o item cujo valor da chave secund&aacute;ria &eacute; imediatamente superior ao informado. </FONT></TD>
</TR>
</TABLE>
<DIR>

<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-TABTIPDAT</B> - Crit&eacute;rio de valida&ccedil;&atilde;o por data (1, 2 ou 3) especificado nos par&acirc;metros da tabela (opcional). </P>
<P>&Eacute; obrigat&oacute;rio informar somente quando o tipo de pesquisa for por valida&ccedil;&atilde;o de&nbsp;data (TS0101-TBLPESQ = "D"). </P>
<P>Detalhes a este respeito est&atilde;o descritos no item "Tabela", desta se&ccedil;&atilde;o. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0101-MENSCOD</B> - C&oacute;digo da mensagem de erro. </P>
<P>Toda vez que o acesso n&atilde;o for efetivado, a sub-rotina preenche este campo com o c&oacute;digo relativo ao erro ocorrido, que, por sua vez, tem sua descri&ccedil;&atilde;o na tabela "SSTM5099". </P>
<P>Este c&oacute;digo de erro deve ser utilizado quando o valor retornado em TS0101-TBLSTA for diferente de zero, caso em que o acesso n&atilde;o foi completado com &ecirc;xito. </P>
<P>A seguir, &eacute; apresentado um exemplo de tratamento de erro da sub-rotina efetuado por um programa aplicativo: </P>
</FONT><pre><font size=3>
   IF   TS0101-TBLSTA NOT EQUAL 0 
        MOVE TS0101-MENSCOD TO GBL-MENSCOD 
        MOVE 5              TO GBL-ERRO
        MOVE "SSTM5099"     TO GBL-TBLCOD 
        GO TO 99000-99-EXIT-PROGRAM.</pre></font><DIR>

<B><FONT SIZE=2><P><A NAME="Acesta">Formas de acesso aos itens de uma tabela</A></B> </P>
<P>O acesso aos itens da tabela pode ser feito de tr&ecirc;s diferentes formas: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Via chave prim&aacute;ria; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Via chave secund&aacute;ria; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Por validade de data.</P></DIR>

<P>Se uma tabela for definida no reposit&oacute;rio de dados como recurso de um programa e na l&oacute;gica deste estiver previsto consulta aos itens desta tabela, todas as declara&ccedil;&otilde;es e comandos de prepara&ccedil;&atilde;o para acesso aos itens da mesma ser&atilde;o gerados automaticamente, quais sejam: </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Na WORKING-STORAGE SECTION: </P><DIR>

<P>COPY "ss/s/ML/nn/mm" - <I>Library</I> da tabela. </P>
<P>COPY "SS/T/SL/01"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - &Aacute;rea de Comunica&ccedil;&atilde;o c/ a sub-rotina.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Na PROCEDURE DIVISION: </P><DIR>

<P>MOVE "SS/T/SC/01" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO GBL-NOMEXT. </P>
<P>CHANGE ATTRIBUTE TITLE OF "SSTS01" TO GBL-CHANGE. </P></DIR>

<P>Existem campos da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina que, independentemente da forma de acesso aos seus itens, t&ecirc;m obrigatoriedade de informa&ccedil;&atilde;o, s&atilde;o eles: </P>
</FONT><pre><font size=3>
  TS0101 - TBLCOD;
  TS0101 - TABAMBI;
  TS0101 - TBLPESQ;
  TS0101 - EMPCOD;
  TS0101 - ETBCOD;
  TS0101 - UNDCOD.</pre></font>
<FONT SIZE=2><P>Estes campos devem ser preenchidos conforme descrito anteriormente no t&oacute;pico "&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina SSTS01 <I>(library</I> SS/T/SL/01), nesta se&ccedil;&atilde;o. </P>
<P>Os demais campos da &aacute;rea de comunica&ccedil;&atilde;o dever&atilde;o ser preenchidos de acordo com o tipo de acesso que ser&aacute; feito aos itens da tabela. Para isso, segue uma explica&ccedil;&atilde;o detalhada dos diversos tipos de acesso: </P>
<P>Todos os comandos de movimenta&ccedil;&atilde;o de valores para os campos da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina devem ser definidos antes de executar acesso aos seus itens, via SSTS01, que &eacute; gerado pelo SADS atrav&eacute;s do seguinte comando: </P><DIR>

<P>CALL "SSTS01 OF SSTS01" USING SST01-LINKAREA. </P></DIR>

<P>O tratamento <I>default</I> do gerador de programas do SADS que testa o retorno do acesso aos itens de tabela &eacute; o seguinte: </P><DIR>

<P>IF &nbsp;&nbsp;TS0101-TBLSTA NOT EQUAL 0 </P><DIR>

<P>MOVE SPACES TO TS0101-TBLITEM.</P></DIR>
</DIR>

<P>Caso seja necess&aacute;rio enviar uma mensagem de erro, deve-se proceder conforme exemplifica&ccedil;&atilde;o a seguir: </P><DIR>

<P>IF TS0101-TBLSTA NOT EQUAL 0 </P><DIR>

<P>MOVE TS0101-MENSCOD&nbsp;&nbsp;&nbsp; TO GBL-MENSCOD </P>
<P>MOVE 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TO GBL-ERRO </P>
<P>MOVE "SSTM5099"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; TO GBL-TBLCOD </P>
<P>GO TO 99000-99-EXIT-PROGRAM.</P></DIR>
</DIR>
</DIR>

<B><P><A NAME="Chapri">Acesso via chave prim&aacute;ria</A></B> </P>
<P>O acesso aos itens de uma tabela via chave prim&aacute;ria &eacute; executado atrav&eacute;s dos seguintes comandos de composi&ccedil;&atilde;o dos campos da &aacute;rea de comunica&ccedil;&atilde;o: </P>
</FONT><pre><font size=3>
  MOVE   &lt;tabela no padr&atilde;o sssMnnnn&gt;     TO TS0101-TBLCOD.
  MOVE   &lt;ambiente ou GBL-USUAMBI&gt;       TO TS0101-TABAMBI.
  MOVE   &lt;tipo de pesquisa&gt;              TO TS0101-TBLPESQ.
  MOVE   &lt;empresa ou GBL-EMPCOD&gt;         TO TS0101-EMPCOD.
  MOVE   &lt;estabelecimento ou GBL-ETBCOD&gt; TO TS0101-ETBCOD.
  MOVE   &lt;unidade ou GBL-UNDCOD&gt;         TO TS0101-UNDCOD.
  MOVE   &lt;argumento de pesquisa&gt;         TO TS0101-TBLARG.</pre></font>
<FONT SIZE=2><P>Todos os tipos de pesquisa s&atilde;o v&aacute;lidos, exceto o tipo "D" que &eacute; reservado para o acesso por validade de data. </P>
<P>Os campos TS0101-EMPCOD, TS0101-ETBCOD e TS0101-UNDCOD que n&atilde;o se enquadrarem no crit&eacute;rio da tabela que estiver sendo acessada devem ser preenchidos com zeros. </P>
<B><P><A NAME="Chesec">Acesso via chave secund&aacute;ria</A></B> </P>
<P>O acesso aos itens de uma tabela via chave secund&aacute;ria &eacute; executado atrav&eacute;s dos seguintes comandos de composi&ccedil;&atilde;o dos campos da &aacute;rea de comunica&ccedil;&atilde;o: </P>
</FONT><pre><font size=3>
  MOVE   &lt;tabela no padr&atilde;o sssMnnnn&gt;     TO TS0101-TBLCOD.
  MOVE   &lt;ambiente ou GBL-USUAMBI&gt;       TO TS0101-TABAMBI.
  MOVE   &lt;tipo de pesquisa&gt;              TO TS0101-TBLPESQ.
  MOVE   &lt;empresa ou GBL-EMPCOD&gt;         TO TS0101-EMPCOD.
  MOVE   &lt;estabelecimento ou GBL-ETBCOD&gt; TO TS0101-ETBCOD.
  MOVE   &lt;unidade ou GBL-UNDCOD&gt;         TO TS0101-UNDCOD.
  MOVE   &lt;ident. chave secund&aacute;ria (B, C ou D)&gt;
                                         TO TS0101-CSTIDT
  MOVE   &lt;argumento de pesquisa&gt;         TO TS0101-CCSARGUM.</pre></font>
<FONT SIZE=2><P>Todos os tipos de pesquisa s&atilde;o v&aacute;lidos, exceto o tipo "D" que &eacute; reservado para o acesso por validade de data. </P>
<P>Os campos TS0101-EMPCOD, TS0101-ETBCOD e TS0101-UNDCOD que n&atilde;o se enquadrarem no crit&eacute;rio da tabela que estiver sendo acessada devem ser preenchidos com zeros. </P>
<P>O campo TS0101-CCSARGUM deve ser preenchido de acordo com o tipo de acesso e conforme orienta&ccedil;&atilde;o descrita anteriormente, neste mesmo t&oacute;pico. </P>
<B><P><A NAME="Valdat">Acesso por validade de data</A></B> </P>
<P>O cadastramento de validade de itens por data para tabelas encontra-se descrito no item "Tabelas", no t&oacute;pico "Par&acirc;metros", nesta mesma se&ccedil;&atilde;o. </P>
<P>O acesso aos itens de uma tabela por validade de data &eacute; executado atrav&eacute;s dos seguintes comandos de composi&ccedil;&atilde;o dos campos da &aacute;rea de comunica&ccedil;&atilde;o: </P>
</FONT><pre><font size=3>
  MOVE   &lt;tabela no padr&atilde;o sssMnnnn&gt;     TO TS0101-TBLCOD.
  MOVE   &lt;ambiente ou GBL-USUAMBI&gt;       TO TS0101-TABAMBI. 
  MOVE   "D"                             TO TS0101-TBLPESQ.
  MOVE   &lt;empresa ou GBL-EMPCOD&gt;         TO TS0101-EMPCOD.
  MOVE   &lt;estabelecimento ou GBL-ETBCOD&gt; TO TS0101-ETBCOD.
  MOVE   &lt;unidade ou GBL-UNDCOD&gt;         TO TS0101-UNDCO
  MOVE   &lt;argumento de pesquisa&gt;         TO TS0101-TBLARG.</pre></font>
<FONT SIZE=2><P>O &uacute;nico tipo de pesquisa v&aacute;lido &eacute; o tipo "D", acesso rand&ocirc;mico por validade de data. </P>
<P>Os campos TS0101-EMPCOD, TS0101-ETBCOD e TS0101-UNDCOD que n&atilde;o se enquadrarem no crit&eacute;rio da tabela que estiver sendo acessada devem ser preenchidos com zeros. </P>
<P>Nos acessos por valida&ccedil;&atilde;o de data, a data utilizada como argumento de pesquisa da sub-rotina SSTS01 tem de ser informada no formato AAMMDD (ano, m&ecirc;s, dia) e na posi&ccedil;&atilde;o correta, caso a chave seja composta de outros campos al&eacute;m daquele destinado &agrave; data.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Digiv">Sub-rotina para c&aacute;lculo e valida&ccedil;&atilde;o de d&iacute;gito verificador - SSRS01</A></B></FONT><FONT SIZE=2> </P>
<P>Esta sub-rotina &eacute; oferecida pelo SADS com o objetivo de calcular e validar d&iacute;gitos verificadores para CGC, CPF e m&oacute;dulos 10 e 11. </P>
<P><A NAME="SSRS01">&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina SSRS01 (Library SS/R/SL/01)</A> </P>
<P>Os campos que comp&otilde;em a <I>&nbsp;library</I> SS/R/SL/01, que cont&eacute;m a estrutura da &aacute;rea de comunica&ccedil;&atilde;o desta sub-rotina, s&atilde;o os seguintes : </P>
</FONT><pre><font size=3>
  01  SSR01-AREACOM.
      05  R01-OPCAO        PIC 9(01).
      05  R01-CODIGO       PIC X(23).
      05  R01-TAMANHO      PIC 9(02).
      05  R01-ERRO         PIC 9(01).
      05  R01-DVCALC       PIC 9(01).</pre></font>
<FONT SIZE=2><P>A seguir, &eacute; apresentada uma explica&ccedil;&atilde;o resumida de cada um dos campos da &aacute;rea de comunica&ccedil;&atilde;o: </P><DIR>

</FONT><P><IMG SRC="bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R01-OPCAO </B>- Op&ccedil;&atilde;o de processamento da sub-rotina. </P>
<P>Cada uma das op&ccedil;&otilde;es determina um tipo do processamento a ser efetuado pela sub-rotina, a saber: </P><DIR>

<P>"1" - Validar d&iacute;gito de CPF; </P>
<P>"2" - Validar d&iacute;gito de CGC; </P>
<P>"3" - Calcular ou validar d&iacute;gito m&oacute;dulo 10; </P>
<P>"4" - Calcular ou validar d&iacute;gito m&oacute;dulo 11.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R01-CODIGO</B> - C&oacute;digo para c&aacute;lculo ou valida&ccedil;&atilde;o de d&iacute;gito. </P>
<P>Neste campo deve-se informar o n&uacute;mero para o qual o d&iacute;gito dever&aacute; ser validado ou calculado. Para teste de CPF ou CGC, o c&oacute;digo informado deve ser diferente de zeros e para CGC as quatro primeiras posi&ccedil;&otilde;es relativas &agrave; filial tamb&eacute;m devem ser diferente de zeros. </P>
<P>Quando houver necessidade de se calcular o d&iacute;gito m&oacute;dulo 10 ou 11, o c&oacute;digo informado dever&aacute; conter 0(zero) no <I>byte</I> referente ao d&iacute;gito verificador do mesmo. </P>
<P>Para o teste de CGC e CPF o c&oacute;digo deve ser informado alinhado &agrave; esquerda. </P>
</FONT><P><IMG SRC="bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R01-TAMANHO</B> - Tamanho, em <I>bytes</I>, do c&oacute;digo informado. </P>
<P>O tamanho do c&oacute;digo a ser informado deve incluir o d&iacute;gito verificador da seguinte forma: </P><DIR>

<B><P>Op&ccedil;&atilde;o 1 -</B> valida CPF: tamanho 11; </P>
<B><P>Op&ccedil;&atilde;o 2 -</B> valida CGC: tamanho 14 ou 15; </P>
<B><P>Op&ccedil;&atilde;o 3 -</B> valida m&oacute;dulo 10: tamanho de 2 a 23; </P>
<B><P>Op&ccedil;&atilde;o 4 -</B> valida m&oacute;dulo 11: tamanho de 2 a 23.</P></DIR>

</FONT><P><IMG SRC="bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R01-ERRO</B> - C&oacute;digo de erro. </P>
<P>Os c&oacute;digos de erros s&atilde;o os seguintes: </P><DIR>

<P>0 - D&iacute;gito OK; </P>
<P>1 - D&iacute;gito n&atilde;o confere; </P>
<P>2 - Op&ccedil;&atilde;o inv&aacute;lida. </P></DIR>

</FONT><P><IMG SRC="bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R01-DVCALC</B> - D&iacute;gito verificador calculado. </P>
<P>Para as op&ccedil;&otilde;es 3 e 4, c&aacute;lculo de d&iacute;gito m&oacute;dulo 10 e 11, respectivamente, este campo ir&aacute; conter o d&iacute;gito calculado. </P>
<P>A seguir, s&atilde;o apresentados os algoritmos utilizados pela sub-rotina SSRS01 para c&aacute;lculo de d&iacute;gito verificador m&oacute;dulo 10 e 11. </P>
<B><P>Algoritmos para c&aacute;lculo de d&iacute;gito verificador m&oacute;dulo 10 e m&oacute;dulo 11</B> </P>
<P>Os algoritmos utilizados pelo SADS para c&aacute;lculo do d&iacute;gito verificador m&oacute;dulo 10 e 11 est&atilde;o descritos nos t&oacute;picos a seguir. </P>
<P>N&atilde;o existe uma padroniza&ccedil;&atilde;o geral para estes algoritmos que seja adotada igualmente por todas as instala&ccedil;&otilde;es e formas de utiliza&ccedil;&atilde;o. </P>
<B><P><A NAME="Calcd0">C&aacute;lculo do d&iacute;gito m&oacute;dulo 10</A></B> </P>
<P>O SADS calcula o d&iacute;gito verificador m&oacute;dulo 10, segundo as seguintes considera&ccedil;&otilde;es: </P></DIR>


<UL TYPE="CIRCLE">

<UL TYPE="CIRCLE">
<LI>O n&uacute;mero que ter&aacute; o d&iacute;gito verificador calculado deve ter o tamanho m&aacute;ximo de 23 caracteres, sendo o &uacute;ltimo caractere o d&iacute;gito verificador; </LI>
<LI>O vetor utilizado pelo SADS para o c&aacute;lculo tem o tamanho de 22 caracteres e o seguinte valor:</LI></UL>
</UL>
<DIR>

<BLOCKQUOTE>"1212121212121212121212".</BLOCKQUOTE>
<P>O algoritmo utilizado pelo SADS para o c&aacute;lculo do d&iacute;gito verificador m&oacute;dulo 10 &eacute;: </P>
</FONT><pre><font size=3>
  In&iacute;cio
    Iniciar SOMA-TOTAL com 0;
    Alinhar o n&uacute;mero que ter&aacute; seu d&iacute;gito testado &agrave; direita;
    Fa&ccedil;a, para todo d&iacute;gito do n&uacute;mero,partindo do pen&uacute;ltimo d&iacute;gito
    da <I>string</I> at&eacute; o primeiro:
       Multiplique o d&iacute;gito do n&uacute;mero pelo d&iacute;gito correspondente
       do vetor "1212121212121212121212";
       Some os dois d&iacute;gitos do resultado da multiplica&ccedil;&atilde;o;
       Acumule o resultado da soma em SOMA-TOTAL;
    Fim-Fa&ccedil;a;
    Se o &uacute;ltimo d&iacute;gito de SOMA-TOTAL for diferente de 0
       Ent&atilde;o
         Subtrai o &uacute;ltimo d&iacute;gito de SOMA-TOTAL de 10
         DIGITO-CALCULADO &eacute; o resultado da subtra&ccedil;&atilde;o
       Sen&atilde;o
         DIGITO-CALCULADO &eacute; o &uacute;ltimo d&iacute;gito de SOMA-TOTAL;
    Fim-se;
  Fim.</pre></font>
<B><FONT SIZE=2><P><A NAME="Calcd1">C&aacute;lculo do d&iacute;gito m&oacute;dulo 11</A></B> </P>
<P>O SADS calcula o d&iacute;gito verificador m&oacute;dulo 11, segundo o seguintes considera&ccedil;&otilde;es: </P></DIR>


<UL TYPE="CIRCLE">

<UL TYPE="CIRCLE">
<LI>O n&uacute;mero que ter&aacute; o d&iacute;gito verificador calculado deve ter o tamanho m&aacute;ximo de 23 caracteres, sendo o &uacute;ltimo caractere o d&iacute;gito verificador; </LI>
<LI>O vetor utilizado pelo SADS para o c&aacute;lculo tem o tamanho de 22 caracteres e o seguinte valor:</LI></UL>
</UL>
<DIR>

<BLOCKQUOTE>"7654329876543298765432".</BLOCKQUOTE>
<P>O algoritmo utilizado pelo SADS para o c&aacute;lculo de d&iacute;gito verificador m&oacute;dulo 11 &eacute;: </P>
</FONT><pre><font size=3>
  In&iacute;cio
    Iniciar SOMA-TOTAL com 0;
    Alinhar o n&uacute;mero que ter&aacute; seu d&iacute;gito testado &agrave; direita;
    Fa&ccedil;a, para todo d&iacute;gito do n&uacute;mero, partindo do pen&uacute;ltimo 
    d&iacute;gito da <I>string</I> at&eacute; o primeiro:
       Multiplique o d&iacute;gito do n&uacute;mero pelo d&iacute;gito correspondente do
       vetor "7654329876543298765432" e acumule o resultado da multiplica&ccedil;&atilde;o em SOMA-TOTAL;
    Fim-Fa&ccedil;a;
    Divida SOMA-TOTAL por 11, guarde o resto da divis&atilde;o em RESTO;
    Se RESTO for diferente de 0 
       Ent&atilde;o
         Subtrai o RESTO de 11;
         DIGITO-CALCULADO &eacute; o resultado da subtra&ccedil;&atilde;o;
       Sen&atilde;o
         DIGITO-CALCULADO &eacute; o RESTO (0);
    Fim-se;
  Fim.</pre></font></DIR>

<B><FONT SIZE=4><P><A NAME="Mandat">Sub-rotina para manipula&ccedil;&atilde;o de datas - SSRS02</A></B></FONT><FONT SIZE=2> </P>
<P>Esta sub-rotina &eacute; oferecida pelo SADS com o objetivo de facilitar o tratamento de datas, dispon&iacute;bilizando as seguintes fun&ccedil;&otilde;es: </P>

<UL TYPE="CIRCLE">
<LI>Validar data; </LI>
<LI>Inverter data do formato dia, m&ecirc;s e ano para ano, m&ecirc;s e dia; </LI>
<LI>Calcular a diferen&ccedil;a entre datas, </LI>
<LI>Calcular data anterior; </LI>
<LI>Calcular data posterior; </LI>
<LI>Calcular o dia da semana; </LI>
<LI>Calcular data juliana; </LI>
<LI>Verificar se a data &eacute; feriado; </LI>
<LI>Calcular primeiro dia &uacute;til do m&ecirc;s; </LI>
<LI>Calcular &uacute;ltimo dia &uacute;til do m&ecirc;s; </LI>
<LI>Calcular data gregoriana; </LI>
<LI>Calcular o n&uacute;mero de dias &uacute;teis entre datas; </LI>
<LI>Calcular o n&uacute;mero de dias &uacute;teis no m&ecirc;s; </LI>
<LI>Calcular o n&uacute;mero de dias &uacute;teis antes de uma determinada data; </LI>
<LI>Calcular o n&uacute;mero de dias &uacute;teis ap&oacute;s uma determinada data.</LI></UL>

<P>Anteriormente &agrave; chamada da sub-rotina SSRS02 para efetuar qualquer uma destas fun&ccedil;&otilde;es, todos os argumentos necess&aacute;rios &agrave; sua execu&ccedil;&atilde;o devem ser informados, para evitar que valores impr&oacute;prios sejam assumidos. </P>
<P><A NAME="SSRS02">&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina SSRS02 </A><I>(</I>Library SS/R/SL/02) </P>
<P>Os campos que comp&otilde;em a <I>library</I> SS/R/SL/02, que cont&eacute;m a estrutura da &aacute;rea de comunica&ccedil;&atilde;o desta sub-rotina, s&atilde;o os seguintes : </P>
</FONT><pre><font size=3>
 01  SSR02-DATAPARM.
     05  R02-DATAMAIOR.
         10 R02-DIAMOR           PIC 9(02).
         10 R02-DIAMOR-RED       REDEFINES R02-DIAMOR
                                       PIC X(02).
         10 R02-MESMOR           PIC 9(02).
         10 R02-MESMOR-RED       REDEFINES R02-MESMOR
                                 PIC X(02).
         10 R02-ANOMOR           PIC 9(02).
         10 R02-ANOMOR-RED       REDEFINES R02-ANOMOR
                                 PIC X(02).
     05  R02-DATAMAIOR-RED       REDEFINES R02-DATAMAIOR
                                 PIC 9(06).
     05  R02-DATAMAIORINV-RED    REDEFINES R02-DATAMAIOR.
         10 R02-ANOMORINV        PIC 9(02).
         10 R02-ANOMORINV-RED    REDEFINES R02-ANOMORINV
                                 PIC X(02).
         10 R02-MESMORINV        PIC 9(02).
         10 R02-MESMORINV-RED    REDEFINES R02-MESMORINV
                                 PIC X(02).
         10 R02-DIAMORINV        PIC 9(02).
         10 R02-DIAMORINV-RED    REDEFINES R02-DIAMORINV
                                 PIC X(02).
     05  R02-DATAMENOR.
         10 R02-DIAMEN           PIC 9(02).
         10 R02-DIAMEN-RED       REDEFINES R02-DIAMEN
                                 PIC X(02).
         10 R02-MESMEN           PIC 9(02).
         10 R02-MESMEN-RED       REDEFINES R02-MESMEN
                                 PIC X(02).
         10 R02-ANOMEN           PIC 9(02).
         10 R02-ANOMEN-RED       REDEFINES R02-ANOMEN
                                 PIC X(02).
     05  R02-DATAMENOR-RED       REDEFINES R02-DATAMENOR
                                 PIC 9(06).
     05  R02-DATAMENORINV-RED    REDEFINES R02-DATAMENOR.
         10 R02-ANOMENINV        PIC 9(02).
         10 R02-ANOMENINV-RED    REDEFINES R02-ANOMENINV
                                 PIC X(02).
         10 R02-MESMENINV        PIC 9(02).
         10 R02-MESMENINV-RED    REDEFINES R02-MESMENINV
                                 PIC X(02).
         10 R02-DIAMENINV        PIC 9(02).
         10 R02-DIAMENINV-RED    REDEFINES R02-DIAMENINV
                                 PIC X(02).
     05  R02-DATARESP.
         10 R02-DIARESP          PIC 9(02).
         10 R02-MESRESP          PIC 9(02).
         10 R02-ANORESP          PIC 9(02).
     05  R02-DATARESP-RED        REDEFINES R02-DATARESP
                                 PIC 9(06).
     05  R02-DATARESP-INV        REDEFINES R02-DATARESP.
         10 R02-ANORESP-I        PIC 9(02).
         10 R02-MESRESP-I        PIC 9(02).
         10 R02-DIARESP-I        PIC 9(02).
     05  R02-MENSERRRO           PIC X(20).
     05  R02-OPCAO               PIC X(01).
     05  R02-PRAZO               PIC X(05).
     05  R02-PRAZO-RED           REDEFINES R02-PRAZO
                                 PIC 9(05).
     05  R02-RESPOSTA            PIC S9(05).
     05  R02-DIA-SEMANA          PIC X(13).
     05  R02-FERIADO             PIC X(01).
     05  R02-IDCDATINV           PIC X(01).
     05  R02-IDCANOREF&#9;&#9; PIC X(01).

 01  SSR02-DATAPARAM-RED         REDEFINES SSR02-DATAPARM.
     05  R0202-DATAMAIOR.
         10 R0202-DIAMOR         PIC 9(02).
         10 R0202-DIAMOR-RED     REDEFINES R0202-DIAMOR
                                 PIC X(02).
         10 R0202-MESMOR         PIC 9(02).
         10 R0202-MESMOR-RED     REDEFINES R0202-MESMOR
                                 PIC X(02).
         10 R0202-ANOMOR         PIC 9(04).
         10 R0202-ANOMOR-RED     REDEFINES R0202-ANOMOR
                                 PIC X(04).
     05  R0202-DATAMAIOR-RED     REDEFINES    R0202-DATAMAIOR 
                      &#9;         PIC 9(08).        

     05  R0202-DATAMAIORINV      REDEFINES R0202-DATAMAIOR.
         10 R0202-ANOMORINV      PIC 9(04).
         10 R0202-ANOMORINV-RED  REDEFINES R0202-ANOMORINV
                                 PIC X(04).
         10 R0202-MESMORINV      PIC 9(02).
         10 R0202-MESMORINV-RED  REDEFINES R0202-MESMORINV
                                 PIC X(02).
         10 R0202-DIAMORINV      PIC 9(02).
         10 R0202-DIAMORINV-RED  REDEFINES R0202-DIAMORINV
                                 PIC X(02).
     05  R0202-DATAMENOR.
         10 R0202-DIAMEN         PIC 9(02).
         10 R0202-DIAMEN-RED     REDEFINES R0202-DIAMEN
                                 PIC X(02).
         10 R0202-MESMEN         PIC 9(02).
         10 R0202-MESMEN-RED     REDEFINES R0202-MESMEN
                                 PIC X(02).
         10 R0202-ANOMEN         PIC 9(04).
         10 R0202-ANOMEN-RED     REDEFINES R0202-ANOMEN
                                 PIC X(04).
     05  R0202-DATAMENOR-RED     REDEFINES R0202-DATAMENOR  
                                 PIC 9(08).                    
     05  R0202-DATAMENORINV      REDEFINES R0202-DATAMENOR.
         10 R0202-ANOMENINV      PIC 9(04).
         10 R0202-ANOMENINV-RED  REDEFINES R0202-ANOMENINV
                                 PIC X(04).
         10 R0202-MESMENINV      PIC 9(02).
         10 R0202-MESMENINV-RED  REDEFINES R0202-MESMENINV
                                 PIC X(02).
         10 R0202-DIAMENINV      PIC 9(02).
         10 R0202-DIAMENINV-RED  REDEFINES R0202-DIAMENINV
                                 PIC X(02).
     05  R0202-TIPREG            PIC X(02).
     05  R0202-MENSERRRO         PIC X(20).
     05  R0202-OPCAO             PIC X(01).
     05  R0202-PRAZO             PIC X(05).
     05  R0202-PRAZO-RED         REDEFINES R02-PRAZO
                                 PIC 9(05).
     05  R0202-RESPOSTA          PIC S9(05).
     05  R0202-DIA-SEMANA        PIC X(13).
     05  R0202-FERIADO           PIC X(01).
     05  R0202-IDCDATINV         PIC X(01). 
     05  R0202-IDCANOREF&#9; PIC X(01).

 01  SSR02-DATAPARM-2-RED        REDEFINES SSR02-DATAPARM.
     05  R0203-DATAMAIOR.
         10 R0203-DIAMOR         PIC 9(02).
         10 R0203-DIAMOR-RED     REDEFINES R0203-DIAMOR
                                 PIC X(02).
         10 R0203-MESMOR         PIC 9(02).
         10 R0203-MESMOR-RED     REDEFINES R0203-MESMOR
                                 PIC X(02).
         10 R0203-ANOMOR         PIC 9(04).
         10 R0203-ANOMOR-RED     REDEFINES R0203-ANOMOR
                                 PIC X(04)
     05  R0203-DATAMAIOR-RED     REDEFINES R0202-DATAMAIOR 
                                 PIC 9(08).
     05  R0203-DATAMAIORINV      REDEFINES R0203-DATAMAIOR.
         10 R0203-ANOMORINV      PIC 9(04).
         10 R0203-ANOMORINV-RED  REDEFINES R0202-ANOMORINV
                                 PIC X(04).
         10 R0203-MESMORINV      PIC 9(02).
         10 R0203-MESMORINV-RED  REDEFINES R0202-MESMORINV
                                 PIC X(02).
         10 R0203-DIAMORINV      PIC 9(02).
         10 R0203-DIAMORINV-RED  REDEFINES R0202-DIAMORINV
                                 PIC X(02).
     05  R0203-DATARESP.
         10 R0203-DIARESP        PIC 9(02).
         10 R0203-MESRESP        PIC 9(02).
         10 R0203-ANORESP        PIC 9(04).
     05  R0203-DATARESP-RED &#9; REDEFINES R0203-DATARESP

     05  R0203-DATARESP-INV      REDEFINES R0203-DATARESP
         10 R0203-ANORESP-I      PIC 9(04).
         10 R0203-MESRESP-I      PIC 9(02).
         10 R0203-DIARESP-I      PIC 9(02).
     05  R0203-TIPREG            PIC X(02).
     05  R0203-MENSERRRO         PIC X(20).
     05  R0203-OPCAO             PIC X(01).
     05  R0203-PRAZO             PIC X(05).
     05  R0203-PRAZO-RED         REDEFINES R02-PRAZO
                                 PIC 9(05).
     05  R0203-RESPOSTA          PIC S9(05).
     05  R0203-DIA-SEMANA        PIC X(13).
     05  R0203-FERIADO           PIC X(01).
     05  R0203-IDCDATINV         PIC X(01).
     05  R0203-IDCANOREF         PIC X(01).

01 SSR02-DATAPARM-3-RED          REDEFINES SSR02-DATAPARM.
     05  R0204-TIPREG            PIC X(02).
     05  R0204-IDCINV-DATAMAIOR  PIC X(01).
     05  R0204-DATAMAIOR.
         10 R0204-ANOMOR-PR      PIC 9(02).
         10 R0204-ANOMOR-PR-RED  REDEFINES R0204-ANOMOR-PR
                                 PIC X(02).
         10 R0204-DATAMAIOR6-VAL.
            15 R0204-DIAMOR6     PIC 9(02).
            15 R0204-DIAMOR6-RED REDEFINES R0204-DIAMOR6
                                 PIC X(02).
            15 R0204-MESMOR6     PIC 9(02).
            15 R0204-MESMOR6-RED REDEFINES R0204-MESMOR6
                                 PIC X(02).
            15 R0204-ANOMOR6     PIC 9(02).
            15 R0204-ANOMOR6-RED REDEFINES R0204-ANOMOR6
                                 PIC X(02).
     05  R0204-DATAMAIOR-RED     REDEFINES R0204-DATAMAIOR
                                 PIC 9(08).
     05  R0204-DATAMAIOR-INV     REDEFINES R0204-DATAMAIOR.
       10 R0204-ANOMORINV-PR     PIC 9(02).
       10 R0204-ANOMORINV-PR-RED REDEFINES R0204-ANOMORINV-PR
                                 PIC X(02).
       10 R0204-DATAMAIOR6-VAL-INV.
         15 R0204-ANOMORINV6     PIC 9(02).
         15 R0204-ANOMORINV6-RED REDEFINES R0204-ANOMORINV6
                                 PIC X(02).
         15 R0204-MESMORINV6     PIC 9(02).
         15 R0204-MESMORINV6-RED REDEFINES R0204-MESMORINV6
                                 PIC X(02).
         15 R0204-DIAMORINV6     PIC 9(02).
         15 R0204-DIAMORINV6-RED REDEFINES R0204-DIAMORINV6
                                 PIC X(02).
     05  R0204-DATAMAIOR8        REDEFINES R0204-DATAMAIOR.
       10 R0204-DIAMOR8          PIC 9(02).
       10 R0204-DIAMOR8-RED      REDEFINES R0204-DIAMOR8 PIC X(02).
       10 R0204-MESMOR8          PIC 9(02).
       10 R0204-MESMOR8-RED      REDEFINES R0204-MESMOR8 PIC X(02).
       10 R0204-ANOMOR8          PIC 9(04).
       10 R0204-ANOMOR8-RED      REDEFINES R0204-ANOMOR8 
                                 PIC X(04).
     05  R0204-DATAMAIOR8-INV    REDEFINES R0204-DATAMAIOR.
       10 R0204-ANOMORINV8       PIC 9(04).
       10 R0204-ANOMORINV8-RED   REDEFINES R0204-ANOMORINV8
                                 PIC X(04).
       10 R0204-MESMORINV8       PIC 9(02).
       10 R0204-MESMORINV8-RED   REDEFINES R0204-MESMORINV8
                                 PIC X(02).
       10 R0204-DIAMORINV8       PIC 9(02).
       10 R0204-DIAMORINV8-RED   REDEFINES R0204-DIAMORINV8
                                 PIC X(02).
     05  R0204-IDCINV-DATAMENOR  PIC X(01).
     05  R0204-DATAMENOR.
      10 R0204-ANOMEN-PR         PIC 9(02).
      10 R0204-ANOMEN-PR-RED     REDEFINES R0204-ANOMEN-PR
                                 PIC X(02).
      10 R0204-DATAMENOR6-VAL.
        15 R0204-DIAMEN6         PIC 9(02).
        15 R0204-DIAMEN6-RED     REDEFINES R0204-DIAMEN6
                                 PIC X(02).
        15 R0204-MESMEN6         PIC 9(02).
        15 R0204-MESMEN6-RED     REDEFINES R0204-MESMEN6
                                 PIC X(02).
        15 R0204-ANOMEN6         PIC 9(02).
        15 R0204-ANOMEN6-RED     REDEFINES R0204-ANOMEN6
                                 PIC X(02).
     05  R0204-DATAMENOR-RED     REDEFINES R0204-DATAMENOR
                                 PIC 9(08).
     05  R0204-DATAMENOR-INV     REDEFINES R0204-DATAMENOR.
      10 R0204-ANOMENINV-PR      PIC 9(02).
      10 R0204-ANOMENINV-PR-RED  REDEFINES R0204-ANOMENINV-PR
                                 PIC X(02).
      10 R0204-DATAMENOR6-VAL-INV.
        15 R0204-ANOMENINV6      PIC 9(02).
        15 R0204-ANOMENINV6-RED  REDEFINES R0204-ANOMENINV6
                                 PIC X(02).
        15 R0204-MESMENINV6      PIC 9(02).
        15 R0204-MESMENINV6-RED  REDEFINES R0204-MESMENINV6
                                 PIC X(02).
        15 R0204-DIAMENINV6      PIC 9(02).
        15 R0204-DIAMENINV6-RED  REDEFINES R0204-DIAMENINV6
                                 PIC X(02).
     05  R0204-DATAMENOR8        REDEFINES R0204-DATAMENOR.
       10 R0204-DIAMEN8          PIC 9(02).
       10 R0204-DIAMEN8-RED      REDEFINES R0204-DIAMEN8 
                                 PIC X(02).
       10 R0204-MESMEN8          PIC 9(02).
       10 R0204-MESMEN8-RED      REDEFINES R0204-MESMEN8 
                                 PIC X(02).
       10 R0204-ANOMEN8          PIC 9(04).
       10 R0204-ANOMEN8-RED      REDEFINES R0204-ANOMEN8 
                                 PIC X(04).
     05  R0204-DATAMENOR8-INV    REDEFINES R0204-DATAMENOR.
       10 R0204-ANOMENINV8       PIC 9(04).
       10 R0204-ANOMENINV8-RED   REDEFINES R0204-ANOMENINV8
                                 PIC X(04).
       10 R0204-MESMENINV8       PIC 9(02).
       10 R0204-MESMENINV8-RED   REDEFINES R0204-MESMENINV8
                                 PIC X(02).
       10 R0204-DIAMENINV8       PIC 9(02).
       10 R0204-DIAMENINV8-RED   REDEFINES R0204-DIAMENINV8
                                 PIC X(02).
     05  R0204-MENSERRO          PIC X(19).
     05  R0204-OPCAO             PIC X(01).
     05  R0204-PRAZO             PIC X(05).
     05  R0204-PRAZO-RED         REDEFINES R0204-PRAZO 
                                 PIC 9(05).
     05  R0204-RESPOSTA          PIC S9(05).
     05  R0204-DIA-SEMANA        PIC X(13).
     05  R0204-FERIADO           PIC X(01).
     05  R0204-IDCANOREF         PIC X(01).
   
   01  SSR02-DATAPARM-4-RED      REDEFINES SSR02-DATAPARM.
     05  R0205-TIPREG            PIC X(02).
     05  R0205-DATARESP6.
      10 R0205-DIARESP6          PIC 9(02) COMP.
      10 R0205-MESRESP6          PIC 9(02) COMP.
      10 R0205-ANORESP6          PIC 9(02) COMP.
     05  R0205-DATARESP6-RED1    REDEFINES R0205-DATARESP6
                                 PIC 9(06) COMP.
     05  R0205-DATARESP6-INV.
      10 R0205-ANORESPINV6       PIC 9(02) COMP.
      10 R0205-MESRESPINV6       PIC 9(02) COMP.
      10 R0205-DIARESPINV6       PIC 9(02) COMP.
    05  R0205-DATARESP6-INV-RED1 REDEFINES R0205-DATARESP6-INV
                                 PIC 9(06) COMP.
    05  R0205-DATARESP8.
      10 R0205-DIARESP8          PIC 9(02) COMP.
      10 R0205-MESRESP8          PIC 9(02) COMP.
      10 R0205-ANORESP8          PIC 9(04) COMP.
    05  R0205-DATARESP8-RED1     REDEFINES R0205-DATARESP8
                                 PIC 9(08) COMP.
    05  R0205-DATARESP8-INV.
      10 R0205-ANORESPINV8       PIC 9(04) COMP.
      10 R0205-MESRESPINV8       PIC 9(02) COMP.
      10 R0205-DIARESPINV8       PIC 9(02) COMP.
    05  R0205-DATARESP8-INV-RED1 REDEFINES R0205-DATARESP8-INV
                                 PIC 9(08) COMP.
    05  R0205-MENSERRO           PIC X(23).
    05  R0205-OPCAO              PIC X(01).
    05  R0205-PRAZO              PIC X(05).
    05  R0205-PRAZO-RED          REDEFINES R0205-PRAZO PIC 9(05).
    05  R0205-RESPOSTA           PIC S9(05).
    05  R0205-DIA-SEMANA         PIC X(13).
    05  R0205-FERIADO            PIC X(01).
    05  R0205-IDCANOREF          PIC X(01).</font></pre>
<B><P><A NAME="Anodua">Tratamento de ano com duas posi&ccedil;&otilde;es</A></B> </P>
<P>A seguir, &eacute; apresentada uma explica&ccedil;&atilde;o resumida de cada um destes campos para utiliza&ccedil;&atilde;o do ano com duas posi&ccedil;&otilde;es: </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-DATAMAIOR</B> - Data no formato DDMMAA (dia, m&ecirc;s e ano). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-DATAMAIORINV-RED</B> - Data no formato AAMMDD (ano, m&ecirc;s e dia). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-DATAMENOR</B> - Data no formato DDMMAA (dia, m&ecirc;s e ano). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-DATAMENORINV-RED</B> - Data no formato AAMMDD (ano, m&ecirc;s e dia). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-DATARESP</B> - Data resposta no formato DDMMAA (dia, m&ecirc;s e ano).. </P>
<P>A sub-rotina retorna a data no formato DDMMAA (dia, m&ecirc;s e ano). </P>
<P>As exce&ccedil;&otilde;es existentes s&atilde;o para as op&ccedil;&otilde;es "2" (invers&atilde;o de data), "8" (primeiro dia &uacute;til do m&ecirc;s) e "9" (ultimo dia &uacute;til do m&ecirc;s), onde a data de resposta &eacute; retornada no formato AAMMDD (ano, m&ecirc;s e dia). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-DATARESP-INV</B> - Data resposta no formato AAMMDD (ano, m&ecirc;s e dia). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-MENSERRO</B> - Mensagem de erro. </P>
<P>Este campo retorna a mensagem de erro da sub-rotina. Caso o processamento tenha sido executado com &ecirc;xito, este campo ser&aacute; retornado em branco. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-OPCAO</B> - Op&ccedil;&atilde;o de processamento da sub-rotina. </P>
<P>Cada uma das op&ccedil;&otilde;es determina um tipo de processamento a ser efetuado pela sub-rotina, a saber: </P><DIR>

<P>"1" - Validar data; </P>
<P>"2" - Inverter data; </P>
<P>"3" - Calcular data juliana; </P>
<P>"4" - Calcular diferen&ccedil;a entre datas (s&oacute; aceita diferen&ccedil;a positiva entre datas); </P>
<P>"5" - Calcular data anterior; </P>
<P>"6" - Calcular data posterior; </P>
<P>"7" - Calcular o dia da semana e verificar se a data corresponde a um feriado; </P>
<P>"8" - Calcular primeiro dia &uacute;til do m&ecirc;s; </P>
<P>"9" - Calcular &uacute;ltimo dia &uacute;til do m&ecirc;s </P>
<P>"P" - Calcular primeiro dia &uacute;til do m&ecirc;s; </P>
<P>"U" - Calcular &uacute;ltimo dia &uacute;til do m&ecirc;s; </P>
<P>"D"- Calcular diferen&ccedil;a entre as datas (aceita diferen&ccedil;a negativa entre datas); </P>
<P>"G"- Calcular data gregoriana; </P>
<P>"T"- Calcular o n&uacute;mero de dias &uacute;teis entre datas (Despreza o &uacute;ltimo dia e considera o primeiro); </P>
<P>"C"- Calcular o n&uacute;mero de dias &uacute;teis entre datas (Despreza o primeiro dia e considera o &uacute;ltimo);</P>
<P>"M"- Calcular o n&uacute;mero de dias &uacute;teis no m&ecirc;s; </P>
<P>"A"- Calcular o n&uacute;mero de dias &uacute;teis antes de uma determinada data; </P>
<P>"B"- Calcular o n&uacute;mero de dias &uacute;teis ap&oacute;s uma determinada data.</P></DIR>

<P>Para as op&ccedil;&otilde;es "4" e "D" - c&aacute;lculo de dias &uacute;teis entre datas - &eacute; considerado o per&iacute;odo de zero horas do dia inicial at&eacute; zero horas do dia final. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-PRAZO</B> - N&uacute;mero de dias para c&aacute;lculo da data solicitada nas op&ccedil;&otilde;es "5" (data anterior), "6" (data posterior), "A" (dias &uacute;teis anteriores) ou "B" (dias &uacute;teis posteriores). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-PRAZO-RED</B> - Data juliana para ser transformada em data gregoriana. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-RESPOSTA</B> - N&uacute;mero de dias entre duas datas. </P>
<P>Este campo retorna o n&uacute;mero de dias resultante da diferen&ccedil;a entre duas datas. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-DIA-SEMANA</B> - Dia da semana. </P>
<P>Este campo retorna o dia da semana correspondente &agrave; data informada. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-FERIADO</B> - Indica&ccedil;&atilde;o de feriado na data. </P>
<P>Este campo retorna "F" somente se a data informada em R02-DATAMAIOR for um feriado (op&ccedil;&atilde;o "7"). </P>
<P>Os feriados s&atilde;o verificados na tabela SBPM6002, no ambiente de produ&ccedil;&atilde;o, que devem ter sido cadastrados nesta tabela pelo respons&aacute;vel pelo SADS na instala&ccedil;&atilde;o. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R02-IDCDATINV</B> - Indica o formato da data informada como argumento. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - formato ano, m&ecirc;s e dia (AAMMDD); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>" " - formato dia, m&ecirc;s e ano (DDMMAA).</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>&nbsp;R02-IDCANOREF  </B>Indicador de utiliza&ccedil;&atilde;o do ano lim&iacute;trofe dos s&eacute;culos 20 e 21, conforme cadastrado na tabela SBPM5000.</P>
<P>Pode assumir o seguinte valor:</P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>&nbsp;"N"  </B>N&atilde;o ser&aacute; utilizado o ano lim&iacute;trofe de s&eacute;culos cadastrado na tabela SBPM5000. Desta forma, todos os anos ser&atilde;o considerados como pertencentes ao s&eacute;culo 20 e ser&aacute; acrescentado 1900 aos anos informados nos par&acirc;metros.</P></DIR>

<P>Caso este campo n&atilde;o seja informado, a tabela SBPM5000 ser&aacute; acessada, com CODIGO = "ANOREF", verificando, no campo PAR-1, qual o ano ser&aacute; considerado como lim&iacute;trofe dos s&eacute;culos. </P>
<P>O par&acirc;metro "ANOREF" deve estar cadastrado na tabela SBPM5000, a fim de que seja especificado o ano que ser&aacute; o delimitador entre os s&eacute;culos 20 e 21, para funcionamento da sub-rotina SSRS02. Do ano determinado at&eacute; o ano 99, as datas informadas para a SSRS02 ser&atilde;o consideradas como sendo do s&eacute;culo 20 e ser&aacute; somado 1900. Do ano 00 at&eacute; o ano especificado, as datas ser&atilde;o consideradas como sendo do s&eacute;culo 21 e ser&aacute; somado 2000 &agrave;s mesmas.</P>
<P>A tabela a seguir aponta os par&acirc;metros que dever&atilde;o ser informados para cada op&ccedil;&atilde;o e quais deles ser&atilde;o devolvidos na sa&iacute;da da sub-rotina SSRS02, quando se utilizar ano com duas posi&ccedil;&otilde;es: </P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=570>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<P><FONT SIZE=2>OP&Ccedil;&Atilde;O</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DESCRI&Ccedil;&Atilde;O </FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>PARAM. DE ENTRADA</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>PARAM. DE SAIDA </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">1</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Validar data</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR </FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">2</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Inverter data</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR </FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO </P>
<P>R02-DATARESP</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">3</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Data juliana</FONT></TD>
<TD WIDTH="35%" VALIGN="TOP">
<FONT SIZE=2><P>R02-DATAMAIOR </FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO</P>
<P>R02-RESPOSTA</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">4</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dif. entre datas</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR </P>
<P>R02-DATAMENOR </P>
<P>R02-IDCANOREF </FONT></TD>
<TD WIDTH="29%" VALIGN="TOP">
<FONT SIZE=2><P>R02-MENSERRO</P>
<P>R02-RESPOSTA</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">5</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Data anterior</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR R02-PRAZO </FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO R02-DATARESP</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">6</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Data posterior</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR R02-PRAZO </FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO R02-DATARESP</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">7</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dia da semana e feriado</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR</P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO </P>
<P>R02-DIA-SEMANA </P>
<P>R02-FERIADO </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">8</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>1<I><U>o</I></U> dia &uacute;til (inv.) </FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR</P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO </P>
<P>R02-DATARESP </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">9</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&Uacute;lt. dia &uacute;til (inv.) </FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR </P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO </P>
<P>R02-DATARESP </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">P</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>1<I><U>o</I></U> dia &uacute;til </FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR</P>
<P>R02-IDCANOREF </FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO</P>
<P>R02-DATARESP </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">U</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&Uacute;lt. dia &uacute;til </FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR</P>
<P>R02-IDCANOREF </FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO </P>
<P>R02-DATARESP </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">D</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dif. entre datas (negativas)</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR</P>
<P>R02-DATAMENOR</P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO</P>
<P>R02-RESPOSTA </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">G</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Data gregoriana</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-PRAZO-RED </FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO R02-DATARESP</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">T</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dif. dias &uacute;teis</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR</P>
<P>R02-DATAMENOR </P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO </P>
<P>R02-RESPOSTA </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P>C</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dif. dias &uacute;teis</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR </P>
<P>R02-DATAMENOR</P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO </P>
<P>R02-RESPOSTA</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">M</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dias &uacute;teis no m&ecirc;s </FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR </P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO</P>
<P>R02-RESPOSTA </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">A</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dias &uacute;teis antes</FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR </P>
<P>R02-PRAZO </P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO</P>
<P>R02- RESPOSTA </P>
<P>R02-DIA-SEMANA</P>
<P>R02-FERIADO</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">B</FONT></TD>
<TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dias &uacute;teis ap&oacute;s </FONT></TD>
<TD WIDTH="35%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-DATAMAIOR </P>
<P>R02-PRAZO </P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="29%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R02-MENSERRO</P>
<P>R02- RESPOSTA </P>
<P>R02-DIA-SEMANA</P>
<P>R02-FERIADO </FONT></TD>
</TR>
</TABLE>

<B><FONT SIZE=2><P><A NAME="Anoqua">Tratamento de ano com quatro posi&ccedil;&otilde;es</A></B> </P><DIR>

<P>A seguir, &eacute; apresentada uma explica&ccedil;&atilde;o resumida de cada um dos campos dessa tabela para utiliza&ccedil;&atilde;o do ano com quatro posi&ccedil;&otilde;es: </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-DATAMAIOR/R0203-DATAMAIOR</B> - Data no formato DDMMAAAA (dia, m&ecirc;s e ano). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-DATAMAIORINV /R0203-DATAMAIORINV</B> - Data no formato "AAAAMMDD" (ano, m&ecirc;s e dia). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-DATAMENOR</B> - Data no formato DDMMAAAA (dia, m&ecirc;s e ano). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-DATAMENORINV</B> - Data no formato "AAAAMMDD" (ano, m&ecirc;s e dia). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0203-DATARESP</B> - Data resposta no formato DDMMAAAA (dia, m&ecirc;s e ano). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0203-DATARESP-INV</B> - Data resposta no formato AAAAMMDD (ano, m&ecirc;s e dia). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-TIPREG/R0203-TIPREG</B>- Indicador de utiliza&ccedil;&atilde;o de ano com 4 posi&ccedil;&otilde;es. </P>
<P>O conte&uacute;do "S2" neste campo, indica o uso de ano com 4 posi&ccedil;&otilde;es.</P>
<P>Caso este campo n&atilde;o seja informado, ser&aacute; assumido que o ano possui 2 posi&ccedil;&otilde;es</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-MENSERRO/R0203-MENSERRO</B> - Mensagem de erro. </P>
<P>Este campo retorna a mensagem de erro da sub-rotina. Caso o processamento tenha sido executado com &ecirc;xito, este campo ser&aacute; retornado em branco. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-OPCAO/R0203-OPCAO</B> - Op&ccedil;&atilde;o de processamento da sub-rotina. </P>
<P>Cada uma das op&ccedil;&otilde;es determina um tipo de processamento a ser efetuado pela sub-rotina, a saber: </P><DIR>

<P>"1" - Validar data; </P>
<P>"2" - Inverter data; </P>
<P>"3" - Calcular data juliana; </P>
<P>"4" - Calcular diferen&ccedil;a entre datas (s&oacute; aceita diferen&ccedil;a positiva entre datas); </P>
<P>"5" - Calcular data anterior; </P>
<P>"6" - Calcular data posterior; </P>
<P>"7" - Calcular o dia da semana e verificar se a data corresponde a um feriado; </P>
<P>"8" - Calcular primeiro dia &uacute;til do m&ecirc;s, em data invertida; </P>
<P>"9" - Calcular &uacute;ltimo dia &uacute;til do m&ecirc;s, em data invertida; </P>
<P>"P" - Calcular primeiro dia &uacute;til do m&ecirc;s; </P>
<P>"U" - Calcular &uacute;ltimo dia &uacute;til do m&ecirc;s; </P>
<P>"D"- Calcular diferen&ccedil;a entre as datas (aceita diferen&ccedil;a negativa entre datas); </P>
<P>"G"- Calcular data gregoriana. </P>
<P>" T"- Calcular o n&uacute;mero de dias &uacute;teis entre datas (Despreza o &uacute;ltimo dia e considera o primeiro);</P>
<P>"C"- Calcular o n&uacute;mero de dias &uacute;teis entre datas (Despreza o primeiro dia e considera o &uacute;ltimo); </P>
<P>"T"- Calcular o n&uacute;mero de dias &uacute;teis entre datas; </P>
<P>"M"- Calcular o n&uacute;mero de dias &uacute;teis no m&ecirc;s; </P>
<P>"A"- Calcular o n&uacute;mero de dias &uacute;teis antes de uma determinada data; </P>
<P>"B"- Calcular o n&uacute;mero de dias &uacute;teis ap&oacute;s uma determinada data.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-PRAZO/R0203-PRAZO</B> - N&uacute;mero de dias para c&aacute;lculo da data solicitada nas op&ccedil;&otilde;es "5"(data anterior),"6" (data posterior),"A"(dias &uacute;teis anteriores) ou"B" (dias &uacute;teis posteriores). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-PRAZO-RED/R0203-PRAZO-RED</B> - Data juliana para ser transformada em data gregoriana. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-RESPOSTA/R0203-RESPOSTA</B> - N&uacute;mero de dias entre duas datas. </P>
<P>Este campo retorna o n&uacute;mero de dias resultante da diferen&ccedil;a entre duas datas. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-DIA-SEMANA/R0202-DIA-SEMANA</B> - Dia da semana. </P>
<P>Este campo retorna o dia da semana correspondente &agrave; data informada. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-FERIADO/R0202-FERIADO</B> - Indica&ccedil;&atilde;o de feriado na data. </P>
<P>Este campo retorna "F" somente se a data informada em R0202-DATAMAIOR for um feriado (op&ccedil;&atilde;o "7"). </P>
<P>Os feriados s&atilde;o verificados na tabela SBPM6002, no ambiente de produ&ccedil;&atilde;o, que devem ter sido cadastrados nesta tabela pelo respons&aacute;vel pelo SADS na instala&ccedil;&atilde;o. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R0202-IDCDATINV/R0203-IDCDATINV</B> - Indica formato da data informada como argumento. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - formato ano, m&ecirc;s e dia (AAMMDD); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>" " - formato dia, m&ecirc;s e ano (DDMMAA).</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>&nbsp;R0202-IDCANOREF </B> Indicador de utiliza&ccedil;&atilde;o do ano lim&iacute;trofe dos s&eacute;culos 20 e 21, conforme cadastrado na tabela SBPM5000<B>.</P>
</B><P>Pode assumir o seguinte valor:</P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>&nbsp;"N"  N&atilde;o ser&aacute; utilizado o ano lim&iacute;trofe de s&eacute;culos cadastrado na tabela SBPM5000. Desta forma, todos os anos ser&atilde;o considerados como pertencentes ao s&eacute;culo 20 e ser&aacute; acrescentado 1900 aos anos informados nos par&acirc;metros.</P></DIR>

<P>Caso este campo n&atilde;o seja informado, a tabela SBPM5000 ser&aacute; acessada, com CODIGO = "ANOREF", verificando, no campo PAR-1, qual o ano ser&aacute; considerado como lim&iacute;trofe dos s&eacute;culos. </P>
<P>O par&acirc;metro "ANOREF" deve estar cadastrado na tabela SBPM5000, a fim de que seja especificado o ano que ser&aacute; o delimitador entre os s&eacute;culos 20 e 21, para funcionamento da sub-rotina SSRS02. Do ano determinado at&eacute; o ano 99, as datas informadas para a SSRS02 ser&atilde;o consideradas como sendo do s&eacute;culo 20 e ser&aacute; somado 1900. Do ano 00 at&eacute; o ano especificado, as datas ser&atilde;o consideradas como sendo do s&eacute;culo 21 e ser&aacute; somado 2000 &agrave;s mesmas.</P>
<P>A tabela a seguir aponta os par&acirc;metros que dever&atilde;o ser informados para cada op&ccedil;&atilde;o e quais deles ser&atilde;o devolvidos na sa&iacute;da da sub-rotina SSRS02, quando se utilizar ano com quatro posi&ccedil;&otilde;es, ou seja, o conte&uacute;do "S2" no campo R0202-TIPREG ou em R0203-TIPREG: </P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=574>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<P ALIGN="CENTER"><FONT SIZE=2>OP&Ccedil;&Atilde;O</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DESCRI&Ccedil;&Atilde;O </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>PARAM. DE ENTRADA</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>PARAM. DE SAIDA </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">1</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Validar data </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR </P>
<P>R0202-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">2</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Inverter data </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-DATAMAIOR R0203-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-MENSERRO R0203-DATARESP-INV </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">3</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Data juliana </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR R0202-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO R0202-RESPOSTA </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">4</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dif. entre datas </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR R0202-DATAMENOR</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO R0202-RESPOSTA </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">5</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Data anterior </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-DATAMAIOR R0203-PRAZO R0203-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-MENSERRO R0203-DATARESP</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">6</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Data posterior </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-DATAMAIOR R0203-PRAZO R0203-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-MENSERRO R0203-DATARESP</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">7</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dia da semana </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR </P>
<P>R0202-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO </P>
<P>R0202-DIA-SEMANA </P>
<P>R0202-FERIADO </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">8</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>1<I><U>o</I></U> dia &uacute;til (inv.) </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-DATAMAIOR R0203-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-MENSERRO R0203-DATARESP-INV </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">9</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&Uacute;lt. dia &uacute;til (inv.) </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-DATAMAIOR R0203-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-MENSERRO R0203-DATARESP </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">P</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>1<I><U>o</I></U> dia &uacute;til </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-DATAMAIOR R0203-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-MENSERRO R0203-DATARESP </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">U</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>&Uacute;lt. dia &uacute;til </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-DATAMAIOR R0203-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-MENSERRO R0203-DATARESP </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">D</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dif. entre datas (negativas) </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR R0202-DATAMENOR R0202-TIPREG </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO R0202-RESPOSTA</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">G</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Data gregoriana </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-PRAZO-RED R0203-TIPREG R0203-IDCANOREF</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0203-MENSERRO R0203-DATARESP </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">T</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dif. dias &uacute;teis </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR R0202-DATAMENOR R0202-TIPREG </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO R0202-RESPOSTA</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">C</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dif. dias &uacute;teis</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR R0202-DATAMENOR R0202-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO R0202-RESPOSTA</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">M</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dias &uacute;teis no m&ecirc;s </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR R0202-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO R0202-RESPOSTA </FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">A</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dias &uacute;teis antes </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR R0202-PRAZO R0202-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO R0202-RESPOSTA R0202-DIA-SEMANA</P>
<P>R0202-FERIADO</FONT></TD>
</TR>
<TR><TD WIDTH="14%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">B</FONT></TD>
<TD WIDTH="21%" VALIGN="MIDDLE">
<FONT SIZE=2><P>Dias &uacute;teis ap&oacute;s </FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-DATAMAIOR R0202-PRAZO R0202-TIPREG</FONT></TD>
<TD WIDTH="33%" VALIGN="MIDDLE">
<FONT SIZE=2><P>R0202-MENSERRO R0202- RESPOSTA R0202-DIA-SEMANA</P>
<P>R0202-FERIADO</FONT></TD>
</TR>
</TABLE>

<B><FONT SIZE=2><P><A NAME="Duaqua">Tratamento de ano com duas ou quatro posi&ccedil;&otilde;es</P>
</B><P>A seguir, &eacute; apresentada uma explica&ccedil;&atilde;o resumida de cada um dos campos dessa tabela para utiliza&ccedil;&atilde;o do ano com duas ou quatro posi&ccedil;&otilde;es de forma gen&eacute;rica: </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-DATAMAIOR</B> - Data no formato dia, m&ecirc;s e ano.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-DATAMAIORINV </B>- Data no formato ano, m&ecirc;s e dia.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-DATAMENOR</B> - Data no formato dia, m&ecirc;s e ano.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-DATAMENORINV</B> - Data no formato ano, m&ecirc;s e dia.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0205-DATARESP</B> - Data resposta no formato dia, m&ecirc;s e ano.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0205-DATARESP6-INV</B> - Data resposta no formato ano, m&ecirc;s e dia.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0205-DATARESP8-INV</B> - Data resposta no formato ano, m&ecirc;s e dia.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-TIPREG</B> - Indicador a possibilidade de utiliza&ccedil;&atilde;o de ano com 2 ou 4 posi&ccedil;&otilde;es.</P>
<P>O conte&uacute;do "S4" neste campo, indica a possibilidade de utilizar ano com 2 ou 4 posi&ccedil;&otilde;es.</P>
<P>Caso este campo n&atilde;o seja informado, ser&aacute; assumido que o ano possui 2 posi&ccedil;&otilde;es.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0205-MENSERRO</B> - Mensagem de erro.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><FONT SIZE=2>&nbsp;Este campo retorna a mensagem de erro da sub-rotina. Caso o processamento tenha sido executado com &ecirc;xito, este campo ser&aacute; retornado em branco.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-OPCAO</B> - Op&ccedil;&atilde;o de processamento da sub-rotina.</P>
<P>Cada uma das op&ccedil;&otilde;es determina um tipo de processamento a ser efetuado pela sub-rotina, a saber:</P><DIR>

<P>"1" - Validar data;</P>
<P>"2" - Inverter data;</P>
<P>"3" - Calcular data juliana;</P>
<P>"4" - Calcular diferen&ccedil;a entre datas (s&oacute; aceita diferen&ccedil;a positiva entre datas);</P>
<P>"5" - Calcular data anterior;</P>
<P>"6" - Calcular data posterior;</P>
<P>"7" - Calcular o dia da semana e verificar se a data corresponde a um feriado;</P>
<P>"8" - Calcular primeiro dia &uacute;til do m&ecirc;s, em data invertida;</P>
<P>"9" - Calcular &uacute;ltimo dia &uacute;til do m&ecirc;s, em data invertida;</P>
<P>"P" - Calcular primeiro dia &uacute;til do m&ecirc;s;</P>
<P>"U" - Calcular &uacute;ltimo dia &uacute;til do m&ecirc;s;</P>
<P>"D"- Calcular diferen&ccedil;a entre as datas (aceita diferen&ccedil;a negativa entre datas);</P>
<P>"G"- Calcular data gregoriana.</P>
<P>"T"- Calcular o n&uacute;mero de dias &uacute;teis entre datas (Despreza o &uacute;ltimo dia e considera o primeiro);</P>
<P>"C"- Calcular o n&uacute;mero de dias &uacute;teis entre datas (Despreza o primeiro dia e considera o &uacute;ltimo); </P>
<P>"M"- Calcular o n&uacute;mero de dias &uacute;teis no m&ecirc;s;</P>
<P>"A"- Calcular o n&uacute;mero de dias &uacute;teis antes de uma determinada data;</P>
<P>"B"- Calcular o n&uacute;mero de dias &uacute;teis ap&oacute;s uma determinada data.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-PRAZO</B> - N&uacute;mero de dias para c&aacute;lculo da data solicitada nas op&ccedil;&otilde;es "5"(data anterior),"6" (data posterior),"A"(dias &uacute;teis anteriores) ou"B" (dias &uacute;teis posteriores).</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-PRAZO-RED</B> - Data juliana para ser transformada em data gregoriana.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0205-RESPOSTA</B> - N&uacute;mero de dias entre duas datas.</P>
<P>Este campo retorna o n&uacute;mero de dias resultante da diferen&ccedil;a entre duas datas.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0205-DIA-SEMANA</B> - Dia da semana.</P>
<P>Este campo retorna o dia da semana correspondente &agrave; data informada.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0205-FERIADO</B> - Indica&ccedil;&atilde;o de feriado na data.</P>
<P>Este campo retorna "F" somente se a data informada em R0204-DATAMAIOR for um feriado (op&ccedil;&atilde;o "7").</P>
<P>Os feriados s&atilde;o verificados na tabela SBPM6002, no ambiente de produ&ccedil;&atilde;o, que devem ter sido cadastrados nesta tabela pelo respons&aacute;vel pelo SADS na instala&ccedil;&atilde;o.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-IDCDATINV</B> - Indica formato da data informada como argumento.</P>
<P>Pode assumir os seguintes valores:</P><DIR>

<P>"S" - formato ano, m&ecirc;s e dia (AAMMDD);</P>
<P>" " - formato dia, m&ecirc;s e ano (DDMMAA).</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=13 HEIGHT=13><B><FONT SIZE=2>&nbsp;R0204-IDCANOREF</B>  Indicador de utiliza&ccedil;&atilde;o do ano lim&iacute;trofe dos s&eacute;culos 20 e 21, conforme cadastrado na tabela SBPM5000.</P>
<P>Pode assumir o seguinte valor:</P><DIR>

<P>"N"  N&atilde;o ser&aacute; utilizado o ano lim&iacute;trofe de s&eacute;culos cadastrado na tabela SBPM5000. Desta forma, todos os anos ser&atilde;o considerados como pertencentes ao s&eacute;culo 20 e ser&aacute; acrescentado 1900 aos anos informados nos par&acirc;metros.</P></DIR>

<P>Caso este campo n&atilde;o seja informado, a tabela SBPM5000 ser&aacute; acessada, com CODIGO = "ANOREF", verificando, no campo PAR-1, qual o ano ser&aacute; considerado como lim&iacute;trofe dos s&eacute;culos. </P>
<P>O par&acirc;metro "ANOREF" deve estar cadastrado na tabela SBPM5000, a fim de que seja especificado o ano que ser&aacute; o delimitador entre os s&eacute;culos 20 e 21, para funcionamento da sub-rotina SSRS02. Do ano determinado at&eacute; o ano 99, as datas informadas para a SSRS02 ser&atilde;o consideradas como sendo do s&eacute;culo 20 e ser&aacute; somado 1900. Do ano 00 at&eacute; o ano especificado, as datas ser&atilde;o consideradas como sendo do s&eacute;culo 21 e ser&aacute; somado 2000 &agrave;s mesmas.</P>
<P>A tabela a seguir aponta os par&acirc;metros que dever&atilde;o ser informados para cada op&ccedil;&atilde;o e quais deles ser&atilde;o devolvidos na sa&iacute;da da sub-rotina SSRS02, quando se utilizar ano com duas ou quatro posi&ccedil;&otilde;es, ou seja, com o conte&uacute;do "S4" no campo R0204-TIPREG:</P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=2 CELLPADDING=7 WIDTH=602>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">OP&Ccedil;&Atilde;O</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>DESCRI&Ccedil;&Atilde;O</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>PARAM. DE ENTRADA</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>PARAM. DE SAIDA</FONT></TD>
</TR>
<tr>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">1</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Validar data</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO</FONT></TD>
</TR>
<tr><TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">2</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Inverter data</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DATARESP6-INV</P>
<P>R0205-DATARESP8-INV</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">3</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Data juliana</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-RESPOSTA</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">4</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Dif. entre datas</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-DATAMENOR</P>
<P>R02-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-RESPOSTA</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">5</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Data anterior</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-PRAZO R0204-TIPREG</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DATARESP6-INV</P>
<P>R0205-DATARESP8-INV</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">6</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Data posterior</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-PRAZO R0204-TIPREG</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DATARESP6-INV</P>
<P>R0205-DATARESP8-INV</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">7</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Dia da semana</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DIA-SEMANA R0205-FERIADO</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">8</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>1<I><U>o</I></U> dia &uacute;til (inv.)</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DATARESP6-INV</P>
<P>R0205-DATARESP8-INV </FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">9</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>&Uacute;lt. dia &uacute;til (inv.)</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DATARESP6-INV</P>
<P>R0205-DATARESP8-INV</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">P</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>1<I><U>o</I></U> dia &uacute;til</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DATARESP6-INV</P>
<P>R0205-DATARESP8-INV</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">U</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>&Uacute;lt. dia &uacute;til</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DATARESP6-INV</P>
<P>R0205-DATARESP8-INV</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">D</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Dif. entre datas (negativas)</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-DATAMENOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-RESPOSTA</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">G</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Data gregoriana</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-PRAZO-RED R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-DATARESP6-INV</P>
<P>R0205-DATARESP8-INV</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">T</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Dif. dias &uacute;teis</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-DATAMENOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-RESPOSTA</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">C</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Dif. dias &uacute;teis</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-DATAMENOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-RESPOSTA</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">M</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Dias &uacute;teis no m&ecirc;s</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-RESPOSTA</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">A</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Dias &uacute;teis antes</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-PRAZO R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205-RESPOSTA</P>
<P>R0205-DIA-SEMANA</P>
<P>R0205-FERIADO</FONT></TD>
</TR>
<TR>
<TD WIDTH="11%" VALIGN="TOP">
<FONT SIZE=2><P ALIGN="CENTER">B</FONT></TD>
<TD WIDTH="17%" VALIGN="TOP">
<FONT SIZE=2><P>Dias &uacute;teis ap&oacute;s</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0204-DATAMAIOR R0204-PRAZO R0204-TIPREG</P>
<P>R0204-IDCANOREF</FONT></TD>
<TD WIDTH="27%" VALIGN="TOP">
<FONT SIZE=2><P>R0205-MENSERRO R0205- RESPOSTA</P>
<P>R0205-DIA-SEMANA</P>
<P>R0205-FERIADO</FONT></TD>
</TR>
</TABLE>

<B><FONT SIZE=4><P><A NAME="Conele">Sub-rotina para consulta a elementos do reposit&oacute;rio de dados do SADS - SDDS04</A></B></FONT><FONT SIZE=2> </P>
<P></A></P>
<P>Esta sub-rotina &eacute; oferecida pelo SADS com o objetivo de realizar as seguintes consultas no reposit&oacute;rio de dados do SADS: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Nomes e c&oacute;digos externos de outros elementos; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Nomes de atributos, campos e dom&iacute;nios; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>-Validades de atributos, campos e dom&iacute;nios; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>-Descri&ccedil;&otilde;es e operadores aritm&eacute;ticos de validades de atributos, campos e dom&iacute;nios.</P></DIR>

<P><A NAME="SDDS04">&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina SDDS04</A><B> </B>(Library SD/D/SL/04) </P>
<P>Os campos que comp&otilde;em a <I>library</I> SD/D/SL/04, que cont&eacute;m a estrutura da &aacute;rea de comunica&ccedil;&atilde;o desta sub-rotina, s&atilde;o os seguintes : </P>
</FONT><pre><font size=3>
 01  DS0401-SDDS04.
     10 DS0402-STATUS           PIC 9(001).
     10 DS0402-INPUT.
        15 DS0402-SUBOPCAO      PIC 9(002) COMP.
        15 DS0402-RESULT        PIC 9(002) COMP.
        15 DS0402-SADSVERSAO    PIC 9(004) COMP.
        15 DS0402-UNDUSUSADS    PIC 9(002) COMP.
        15 DS0402-SISCOD        PIC X(003).
        15 DS0402-ATRCODIDE     PIC X(011).
        15 DS0402-ELECOD-1-RED  REDEFINES DS0402-ATRCODIDE.
           20 DS0402-ELECOD     PIC X(010).
           20 FILLER            PIC X(001).
        15 DS0402-VLDOPAR       PIC X(002).
        15 DS0402-VLDOPDO       PIC X(011).
        15 DS0402-VLDOPDO-RED   REDEFINES DS0402-VLDOPDO.
           20 DS0402-VLDOPDO-1  PIC 9(011).
        15 DS0402-VLDDESOPDO    PIC X(040).
     10 DS0402-OUTPUT-RED       REDEFINES DS0402-INPUT.
        15 FILLER               PIC X(012).
        15 DS0402-ELECODEXT     PIC X(020).
        15 DS0402-ELENOM        PIC X(040).

 01  DS0403-SDDS04-RED          REDEFINES DS0401-SDDS04.
     10 DS0403-STATUS           PIC 9(001).
     10 DS0403-INPUT.
        15 DS0403-SUBOPCAO      PIC 9(002) COMP.
        15 DS0403-RESULT        PIC 9(002) COMP.
        15 DS0403-SADSVERSAO    PIC 9(004) COMP.
        15 DS0403-UNDUSUSADS    PIC 9(002) COMP.
        15 DS0403-SISCOD        PIC X(003).
        15 DS0403-ATRCODIDE     PIC X(011).
        15 DS0403-VLDSEQTEST    PIC 9(004).
        15 DS0403-VLDOPELO      PIC X(001).
        15 DS0403-VLDOPAR       PIC X(002).
        15 DS0403-VLDOPDO       PIC X(011).
        15 DS0402-VLDDESOPDO    PIC X(040).</pre></font>
<FONT SIZE=2><P>A seguir, &eacute; apresentada uma explica&ccedil;&atilde;o resumida de cada um destes campos:</P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-STATUS, </B>DS0403-STATUS - <I>Status</I> retornado pela sub-rotina. </P>
</FONT><P><FONT SIZE=2>Este campo ser&aacute; sempre retornado pela sub-rotina com um dos seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"9" - O elemento a ser consultado n&atilde;o foi encontrado; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"0" - A consulta ao elemento selecionado foi efetivada com &ecirc;xito.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-SUBOPCAO, DS0403-SUBOPCAO</B> - Identificador de processamento da sub-rotina. </P>
<P>Cada uma das subop&ccedil;&otilde;es determina um tipo do processamento a ser efetuado pela sub-rotina, a saber: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"1" - Consultar nome de atributos, campos ou dom&iacute;nios; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"2" - Consultar nome e c&oacute;digo externo de outros elementos; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"3" - Consultar validades de atributos, campos ou dom&iacute;nios; </P>
<P>Para pesquisar todas as validades de um atributo/campo/dom&iacute;nio, deve-se efetuar v&aacute;rias chamadas &agrave; sub-rotina SDDS04, at&eacute; que o campo DS0403-STATUS retorne com 9, indicando o t&eacute;rmino das validades. Ap&oacute;s cada uma das chamadas, a sub-rotina retornar&aacute; uma das validades cadastrada para o elemento. Antes da primeira chamada, deve-se inicializar o campo DS0403-VLDSEQTEST com zeros (DS0403-VLDSEQTEST = 0). Nas pr&oacute;ximas chamadas, o conte&uacute;do de tal campo n&atilde;o deve ser alterado. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"9" - Consultar descri&ccedil;&atilde;o e operador aritm&eacute;tico de validades de atributos, campos e dom&iacute;nios.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-RESULT, DS0403-RESULT</B> - Campo a ser utilizado em implementa&ccedil;&otilde;es futuras do SADS. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-SADSVERSAO, DS0403-SADSVERSAO</B> - C&oacute;digo num&eacute;rico referente &agrave; vers&atilde;o do SADS. </P>
<P>Deve-se informar 300 como vers&atilde;o do SADS, para qualquer das subop&ccedil;&otilde;es escolhidas. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-UNDUSUSADS, DS0403-UNDUSUSADS</B> - C&oacute;digo da unidade usu&aacute;ria SADS. </P>
<P>O c&oacute;digo da unidade usu&aacute;ria SADS ser&aacute; utilizado quando houver mais de uma parti&ccedil;&atilde;o do SADS em um mesmo reposit&oacute;rio de dados. </P>
<P>Na vers&atilde;o 3.3 do SADS, este campo n&atilde;o est&aacute; sendo utilizado. Deve-se, portanto, informar "01" (um) para qualquer subop&ccedil;&atilde;o escolhida. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-SISCOD, DS0403-SISCOD</B> - Sistema do atributo, campo ou dom&iacute;nio a ser consultado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-ATRCODIDE, DS0403-ATRCODIDE</B> - Mnem&ocirc;nico do atributo, campo ou dom&iacute;nio a ser consultado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0403-VLDSEQTEST</B> - Sequ&ecirc;ncia do cadastramento da validade do atributo, campo ou dom&iacute;nio. </P>
<P>Este campo deve ser informado quando se deseja pesquisar todas as validades de um atributo, campo ou dom&iacute;nio. Para pesquisar todas as validades de um atributo/campo/dom&iacute;nio, deve-se efetuar v&aacute;rias chamadas &agrave; sub-rotina SDDS04. Antes da primeira chamada, deve-se inicializar o campo DS0403-VLDSEQTEST com zeros (DS0403-VLDSEQTEST = 0). Nas pr&oacute;ximas chamadas, o conte&uacute;do de tal campo n&atilde;o deve ser alterado. </P>
<P>Este campo tamb&eacute;m &eacute; retornado quando a sub-rotina SDDS04 &eacute; chamada com DS0403-SUBOPCAO = 3 para consultar as validades de um atributo, campo ou dom&iacute;nio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-ELECOD-1-RED ou DS0402-ELECOD</B> - C&oacute;digo do elemento do SADS cujo nome e c&oacute;digo externo ser&atilde;o consultados. </P>
<P>Este campo deve ser informado quando a sub-rotina SDDS04 for chamada com DS0402-SUBOPCAO = 2 para consultar o nome e c&oacute;digo externo de um elemento do SADS. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-VLDOPAR, DS0403-VLDOPAR</B> - Operador aritm&eacute;tico da validade do atributo, campo ou dom&iacute;nio. </P>
<P>Este campo &eacute; retornado quando a sub-rotina SDDS04 for chamada com DS0402-SUBOPCAO = 9 ou com DS0403-SUBOPCAO = 3 para consultar a descri&ccedil;&atilde;o e o operador aritm&eacute;tico de alguma das validades de um atributo, campo ou dom&iacute;nio ou para consultar as validades de algum destes elementos, respectivamente. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-VLDOPDO, DS0402-VLDOPDO-RED, DS0402-VLDOPDO-1 ou DS0403-VLDOPDO</B> - Valor que pode ser assumido pelo atributo, campo ou dom&iacute;nio pesquisado. </P>
<P>Este campo deve ser informado quando a sub-rotina SDDS04 for chamada com DS0402-SUBOPCAO = 9 para consultar a descri&ccedil;&atilde;o e operador aritm&eacute;tico da validade de um atributo, campo ou dom&iacute;nio. </P>
<P>Este campo ser&aacute; retornado pela sub-rotina SDDS04 quando ela for chamada com DS0403-SUBOPCAO = 3, informando um dos valores poss&iacute;veis para o atributo, campo ou dom&iacute;nio pesquisado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-VLDDESOPDO, DS0403-VLDDESOPDO</B> - Descri&ccedil;&atilde;o do atributo, campo ou dom&iacute;nio, ou descri&ccedil;&atilde;o de validade de atributo, campo ou dom&iacute;nio. </P>
<P>Este campo &eacute; retornado quando a sub-rotina SDDS04 for chamada com DS0402-SUBOPCAO = 1, informando a descri&ccedil;&atilde;o de atributo, campo ou dom&iacute;nio, ou com DS0402-SUBOPCAO = 9 ou DS0403-SUBOPCAO = 3, informando a descri&ccedil;&atilde;o de uma validade de atributo, campo ou dom&iacute;nio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-ELECODEXT</B> - C&oacute;digo externo do elemento do SADS que foi consultado. </P>
<P>Este campo ser&aacute; retornado quando a sub-rotina SDDS04 for chamada com DS0402-SUBOPCAO = 2 para consultar o nome e c&oacute;digo externo de um elemento do SADS. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DS0402-ELENOM</B> - Nome do elemento do SADS que foi consultado. </P>
<P>Este campo ser&aacute; retornado quando a sub-rotina SDDS04 for chamada com DS0402-SUBOPCAO = 2 para consultar o nome e c&oacute;digo externo de um elemento do SADS. </P>
<P>A tabela a seguir apresenta explica&ccedil;&otilde;es dos par&acirc;metros de entrada e de sa&iacute;da da sub-rotina SDDS04 relacionados a cada uma das subop&ccedil;&otilde;es: </P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=574>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<P ALIGN="CENTER"><FONT SIZE=2>SUBOPCAO</FONT></TD>
<TD WIDTH="42%" VALIGN="MIDDLE">
<FONT SIZE=2><P>PARAMETROS DE ENTRADA </FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P>PARAMETROS DE SAIDA</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">1</FONT></TD>
<TD WIDTH="42%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DS0402-SADSVERSAO DS0402-UNDUSUSADS DS0402-ATRCODIDE DS0402-SISCOD </FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DS0402-STATUS DS0402-VLDDESOPDO</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">2</FONT></TD>
<TD WIDTH="42%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DS0402-SADSVERSAO DS0402-UNDUSUSADS DS0402-ELECOD </FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DS0402-STATUS DS0402-ELENOM DS0402-ELECODEXT </FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">3</FONT></TD>
<TD WIDTH="42%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DS0403-SADSVERSAO DS0403-UNDUSUSADS DS0403-ATRCODIDE DS0403-SISCOD DS0403-VLDSEQTEST DS0403-VLDSEQTEST </FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DS0403-STATUS DS0403-VLDSEQTEST DS0403-VLDOPELO DS0403-VLDOPAR DS0403-VLDOPDO DS0403-VLDESOPDO </FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">9</FONT></TD>
<TD WIDTH="42%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DS0402-SADSVERSAO DS0402-UNDUSUSADS DS0402-ATRCODIDE DS0402-SISCOD DS0402-VLDOPDO </FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P>DS0402-STATUS DS0402-VLDDESOPDO DS0402-VLDOPAR </FONT></TD>
</TR>
</TABLE>

<B><FONT SIZE=4><P><A NAME="Tesfun">Sub-rotina para testes e fun&ccedil;&otilde;es de controle do Sistema de Seguran&ccedil;a - SBTS03</A></B></FONT><FONT SIZE=2> </P>
<P>Esta sub-rotina &eacute; oferecida pelo SADS com o objetivo de realizar os seguintes testes e fun&ccedil;&otilde;es de controle do Sistema de Seguran&ccedil;a: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Teste de habilita&ccedil;&atilde;o de usu&aacute;rio para trabalhar com um elemento; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Teste de habilita&ccedil;&atilde;o de programa para acesso a uma sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Desabilita&ccedil;&atilde;o de transa&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Habilita&ccedil;&atilde;o de transa&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Pesquisa esta&ccedil;&atilde;o na qual o usu&aacute;rio efetuou <I>logon</I>; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Teste de habilita&ccedil;&atilde;o de usu&aacute;rio para trabalhar com um aplicativo. </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>&nbsp;Valida&ccedil;&atilde;o de senha de um usu&aacute;rio</P>
<B><P><A NAME="SBT03">&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina SBTS03<I>(Library SB/T/SL/03)</A></B></I> </P>
<P>A seguir ser&atilde;o apresentados alguns campos que comp&otilde;em a <I>library</I> SB/T/SL/03, que cont&eacute;m a estrutura da &aacute;rea de comunica&ccedil;&atilde;o desta sub-rotina. Os campos exibidos ser&atilde;o apenas aqueles pertencentes aos registros da &aacute;rea de comuminca&ccedil;&atilde;o que ser&atilde;o utilizados pelos programas aplicativos para testes e fun&ccedil;&otilde;es de controle: </P>
</FONT><pre><font size=3>
 01  TS0304-SBTS03-RED        REDEFINES TS0301-SBTS03.
     10  TS0304-ETCNUM        PIC 9(0004)        COMP.
     10  TS0304-ELMCOD        PIC X(0017).
     10  TS0304-SUBOPCAO      PIC 9(0002)        COMP.
     10  TS0304-TRACOD.
       15  TS0304-MENCOD      PIC X(0005). 
       15  TS0304-TRANUM      PIC 9(0002). 
     10  TS0304-SUBMENS. 
       15  TS0304-BLOMOT      PIC X(0060).
       15  FILLER             PIC X(0020).

 01  TS0306-SBTS03-RED        REDEFINES TS0301-SBTS03. 
     10  TS0306-ETCNUM        PIC 9(0004)        COMP.
     10  TS0306-TRACOD. 
       15  TS0306-MENCOD      PIC X(0005). 
       15  TS0306-TRANUM      PIC 9(0002). 
     10  TS0306-SUBCOD        PIC X(0006). 
     10  FILLER               PIC X(0004). 
     10  TS0306-SUBOPCAO      PIC 9(0002)        COMP. 
     10  TS0306-PROCOD        PIC X(0006). 
     10  TS0306-USUNUM        PIC 9(0006)        COMP.
     10  TS0306-EMPCOD        PIC 9(0003)        COMP. 
     10  TS0306-ETBCOD        PIC 9(0004)        COMP. 
     10  TS0305-SUBOPCAO      PIC 9(0002)        COMP. 
     10  TS0306-UNDCOD        PIC 9(0003)        COMP. 
     10  FILLER               PIC X(0018). 
     10  TS0306-TABTRANS.
       15  TS0306-XCTHABTRANS OCCURS 0100 TIMES 
                              PIC 9(0001)        COMP.

 01   TS0307-SBTS03-RED       REDEFINES TS0301-SBTS03.
      10  TS0307-ETCNUM       PIC 9(0004)        COMP.
      10  TS0307-USUNUM       PIC 9(0006)        COMP.
      10  FILLER              PIC X(0014)
      10  TS0307-SUBOPCAO     PIC 9(0002)        COMP.
      10  TS0307-ETCCOD       PIC X(0017).
      10  FILLER              PIC X(0070). 

01    TS0309-SBTS03-RED       REDEFINES TS0301-SBTS03. 
      10 TS0309-ETCNUM        PIC 9(0004) COMP. 
      10 TS0309-ETCCOD        PIC X(0017). 
      10 TS0309-OPCAO         PIC 9(0002) COMP. 
      10 TS0309-USUNUM        PIC 9(0006) COMP. 
      10 TS0309-USUSEN        PIC X(0006). 
      10 TS0309-USUAMBI       PIC X(0001). 
      10 TS0309-EMPCOD        PIC 9(0003) COMP. 
      10 TS0309-ETBCOD        PIC 9(0004) COMP. 
      10 TS0309-UNDCOD        PIC 9(0003) COMP. 
      10 TS0309-MENSAGEM. 
        15 TS0309-MENSCOD     PIC X(0005).
        15 FILLER             PIC X(0067).</pre></font>


<P>A seguir, &eacute; apresentada uma explica&ccedil;&atilde;o resumida de cada um destes campos: </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0304-ETCNUM, TS0306-ETCNUM, TS0307-ETCNUM, TS0309-ETCNUM</B> - N&uacute;mero da esta&ccedil;&atilde;o do usu&aacute;rio. </P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 10 ou com TS0309-OPCAO = 28 e ser&aacute; retornado quando a sub-rotina for chamada com TS0307-SUBOPCAO = 24. </P>
<P>O n&uacute;mero da esta&ccedil;&atilde;o na qual um usu&aacute;rio est&aacute; logado pode ser adquirido atrav&eacute;s do campo H-ESTACAO.. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0304-ELMCOD</B> - C&oacute;digo do elemento cuja habilita&ccedil;&atilde;o ao usu&aacute;rio ser&aacute; testada. </P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 10, para testar a habilita&ccedil;&atilde;o de um usu&aacute;rio a um elemento. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0304-SUBOPCAO, TS0306-SUBOPCAO, TS0307-SUBOPCAO,</B> <B>TS0309-OPCAO</B> - Identificador de processamento da sub-rotina e tipo de acesso permitido ao usu&aacute;rio. </P>
<P>Para disparar a execu&ccedil;&atilde;o da sub-rotina SBTS03, cada uma das subop&ccedil;&otilde;es (op&ccedil;&otilde;es) ir&aacute; determinar um tipo do processamento a ser efetuado, a saber: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>&nbsp;"10"- Para testar a habilita&ccedil;&atilde;o de um usu&aacute;rio a um elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>&nbsp;"18"- Para testar a habilita&ccedil;&atilde;o de um programa para acesso a uma sub-rotina; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>&nbsp;"22" - Para desabilitar uma transa&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>&nbsp;"23" - Para habilitar uma transa&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>&nbsp;"24" - Para pesquisar a esta&ccedil;&atilde;o na qual um usu&aacute;rio efetuou <I>logon</I>; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>&nbsp;"25" - Para testar a habilita&ccedil;&atilde;o de um usu&aacute;rio para trabalhar com um aplicativo; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"28"  Para validar a senha de um usu&aacute;rio.</P></DIR>

<P>Para retorno da sub-rotina, este campo ir&aacute; conter o tipo de acesso permitido para o usu&aacute;rio ou uma condi&ccedil;&atilde;o de erro, que pode ser:</P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"0" - Autorizado a consultar o elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"2" - Autorizado a atualizar o elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"3" - N&atilde;o autorizado a trabalhar com o elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"99" - Para indicar erro detectado na execu&ccedil;&atilde;o da sub-rotina SBTS03.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0304-TRACOD, TS0306-TRACOD</B> - C&oacute;digo do aplicativo ou lista de elementos para o qual o elemento ser&aacute; testado ou c&oacute;digo do aplicativo/transa&ccedil;&atilde;o a ser habilitado ou desabilitado. </P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 10, 22, 23 ou 25. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0304-SUBMENS, TS0309-MENSAGEM</B> - Mensagem de erro retornada pela sub-rotina, caso o campo TS0304-SUBOPCAO ou TS0309-OPCAO seja igual a 99. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0304-BLOMOT</B> - Motivo do bloqueio da transa&ccedil;&atilde;o que poder&aacute; ser utilizada na SUBOPCAO = 22. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0306- USUNUM, TS0307-USUNUM , TS0309-USUNUM</B> - N&uacute;mero do usu&aacute;rio a ser pesquisado. </P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 24 ou 25 ou TS0309-OPCAO = 28. </P>
<P>O n&uacute;mero do usu&aacute;rio logado pode ser adquirido atrav&eacute;s do campo GBL-USUNUM.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0306-SUBCOD</B> - C&oacute;digo da sub-rotina do aplicativo (sssSxx) cujo acesso pelo programa ser&aacute; validado. </P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 18. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0306-EMPCOD</B> - C&oacute;digo da empresa na qual ser&aacute; validado o acesso do usu&aacute;rio ao aplicativo. </P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 25. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0306-ETBCOD</B> - C&oacute;digo do estabelecimento no qual ser&aacute; validado o acesso do usu&aacute;rio ao aplicativo. </P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 25. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0306-UNDCOD</B> - C&oacute;digo da unidade na qual ser&aacute; validado o acesso do usu&aacute;rio ao aplicativo. </P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 25. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0307-ETCCOD</B> - C&oacute;digo da esta&ccedil;&atilde;o na qual o usu&aacute;rio est&aacute; logado. </P>
<P>Este campo &eacute; retornado quando a sub-rotina SBTS03 for chamada com TS0304-SUBOPCAO = 24.</P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>&nbsp;TS0309-USUSEN</B>  Senha do usu&aacute;rio a ser validada.</P>
<P>Este campo deve ser informado quando a sub-rotina SBTS03 for chamada com TS0309-OPCAO = 28.</P>
<P>A tabela a seguir apresenta explica&ccedil;&otilde;es dos par&acirc;metros de entrada e de sa&iacute;da da sub-rotina SBTS03 relacionados a cada uma das op&ccedil;&otilde;es: </P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=554>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<P ALIGN="CENTER"><FONT SIZE=2>SUBOPCAO</FONT></TD>
<TD WIDTH="44%" VALIGN="MIDDLE">
<FONT SIZE=2><P>PARAMETROS DE ENTRADA </FONT></TD>
<TD WIDTH="34%" VALIGN="MIDDLE">
<FONT SIZE=2><P>PARAMETROS DE SAIDA</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">10</FONT></TD>
<TD WIDTH="44%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0304-ETCNUM TS0304-ELMCOD TS0304-TRACOD TS0304-SUBOPCAO </FONT></TD>
<TD WIDTH="34%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0304-SUBOPCAO TS0304-SUBMENS</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">18</FONT></TD>
<TD WIDTH="44%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0306-SUBCOD TS0306-SUBOPCAO </FONT></TD>
<TD WIDTH="34%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0306-SUBOPCAO</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">22</FONT></TD>
<TD WIDTH="44%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0304-TRACOD TS0304-SUBOPCAO </FONT></TD>
<TD WIDTH="34%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0304-SUBOPCAO TS0304-BLOMOT TS0304-SUBMENS </FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">23</FONT></TD>
<TD WIDTH="44%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0304-TRACOD TS0304-SUBOPCAO </FONT></TD>
<TD WIDTH="34%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0304-SUBOPCAO TS0304-SUBMENS</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">24</FONT></TD>
<TD WIDTH="44%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0307-USUNUM TS0307-SUBOPCAO </FONT></TD>
<TD WIDTH="34%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0307-ETCCOD TS0307-ETCNUM TS0307-SUBOPCAO </FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">25</FONT></TD>
<TD WIDTH="44%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0306-TRACOD TS0306-USUNUM TS0306-EMPCOD TS0306-ETBCOD TS0306-UNDCOD TS0306-SUBOPCAO </FONT></TD>
<TD WIDTH="34%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0306-SUBOPCAO</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">28</FONT></TD>
<TD WIDTH="44%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0309-USUNUM </P>
<P>TS0309-ETCNUM </P>
<P>TS0309-USUSEN </P>
<P>TS0309-OPCAO</FONT></TD>
<TD WIDTH="34%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0309-OPCAO</P>
<P>TS0309-MENSAGEM</FONT></TD>
</TR>
</TABLE>

<B><FONT SIZE=4><P><A NAME="Sisseg">Sub-rotina para consulta a dados do Sistema de Seguran&ccedil;a - SBTS05</A></B></FONT><FONT SIZE=2> </P>
<P>Esta sub-rotina &eacute; oferecida pelo SADS com o objetivo de realizar as seguintes consultas &agrave;s bases de dados do Sistema de Seguran&ccedil;a: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Dados do usu&aacute;rio cadastrado no Sistema de Seguran&ccedil;a; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Dados do usu&aacute;rio logado em uma esta&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Aplicativos habilitados ao usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Elementos habilitados ao usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Esta&ccedil;&otilde;es habilitadas ao usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Limites de hor&aacute;rio de trabalho do usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Limites de hor&aacute;rio de utiliza&ccedil;&atilde;o do aplicativo/transa&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Limites de hor&aacute;rio do usu&aacute;rio trabalhar com o aplicativo/transa&ccedil;&atilde;o. </P>
<B><P><A NAME="SBT05">&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina SBTS05 (Library SB/T/SL/05)</A></B> </P>
</FONT><pre><font size=3>
 01  TS0501-SBTS05.
     10  TS0501-OPCAO         PIC 9(0002)        COMP.
     10  TS0501-STATUS        PIC 9(0002)        COMP.
     10  TS0501-MENSAGEM      PIC X(0040). 
     10  TS0501-REGISTRO1. 
       15  TS0501-USUNUM      PIC 9(0006)        COMP. 
       15  TS0501-ETCCOD      PIC X(0017).
       15  TS0501-USUCODEXT   PIC X(0017). 
       15  TS0501-USUNOM      PIC X(0040). 
       15  TS0501-USUNIVACES  PIC 9(0002)        COMP. 
       15  TS0501-USUEMP      PIC X(0003). 
       15  TS0501-USUAREA     PIC X(0020). 
       15  TS0501-USUDADFUNC  PIC X(0050). 
       15  TS0501-USUEMPHAB   PIC 9(0003)        COMP. 
       15  TS0501-USUETBHAB   PIC 9(0004)        COMP. 
       15  TS0501-USUUNDHAB   PIC 9(0003)        COMP. 
       15  TS0501-USUSTA      PIC 9(0001). 
     10  FILLER               PIC X(0116). 

 01  TS0503-SBTS05-RED        REDEFINES TS0501-SBTS05.
     10  TS0503-OPCAO         PIC 9(0002)        COMP. 
     10  TS0503-STATUS        PIC 9(0002)        COMP.
     10  TS0503-MENSAGEM      PIC X(0040). 
     10  TS0503-REGISTRO3.
       15  TS0503-USUNUM      PIC 9(0006)        COMP. 
       15  TS0503-TABMENS     OCCURS 0019 TIMES. 
         20  TS0503-APLCOD    PIC X(0007). 
         20  TS0503-HABTIP    PIC 9(0001). 
         20  TS0503-USUEMPHAB PIC 9(0003)        COMP. 
         20  TS0503-USUETBHAB PIC 9(0004)        COMP. 
         20  TS0503-USUUNDHAB PIC 9(0003)        COMP. 
         20  TS0503-USUNIVHAB PIC 9(0002)        COMP. 
     10  FILLER               PIC X(0004). 

 01  TS0504-SBTS05-RED        REDEFINES TS0501-SBTS05. 
     10  TS0504-OPCAO         PIC 9(0002)        COMP. 
     10  TS0504-STATUS        PIC 9(0002)        COMP. 
     10  TS0504-MENSAGEM      PIC X(0040). 
     10  TS0504-REGISTRO4. 
       15  TS0504-USUNUM      PIC 9(0006)        COMP. 
       15  TS0504-TABMENS     OCCURS 0008 TIMES. 
         20  TS0504-APLCOD    PIC X(0007).
         20  TS0504-USUEMPHAB PIC 9(0003)        COMP. 
         20  TS0504-USUETBHAB PIC 9(0004)        COMP. 
         20  TS0504-USUUNDHAB PIC 9(0003)        COMP. 
         20  TS0504-ELMCOD    PIC X(0017). 
         20 TS0504-USUTIPHAB  PIC 9(0001). 

 01  TS0505-SBTS05-RED        REDEFINES TS0501-SBTS05.
     10  TS0505-OPCAO         PIC 9(0002)        COMP. 
     10  TS0505-STATUS        PIC 9(0002)        COMP. 
     10  TS0505-MENSAGEM      PIC X(0040). 
     10  TS0505-REGISTRO5. 
       15  TS0505-USUNUM      PIC 9(0006)        COMP. 
       15  TS0505-TABMENS     OCCURS 0009 TIMES. 
         20  TS0505-ETCCOD    PIC X(0017).
     10  FILLER               PIC X(0117). 

 01  TS0506-SBTS05-RED        REDEFINES TS0501-SBTS05. 
     10  TS0506-OPCAO         PIC 9(0002)        COMP. 
     10  TS0506-STATUS        PIC 9(0002)        COMP.
     10  TS0506-MENSAGEM      PIC X(0040).
     10  TS0506-REGISTRO6.
       15  TS0506-USUNUM      PIC 9(0006)        COMP.
       15  TS0506-TABMENS     OCCURS 0004 TIMES.
         20  TS0506-USUHORINI PIC 9(0004)        COMP.
         20  TS0506-USUHORFIM PIC 9(0004)        COMP.
      10  FILLER              PIC X(0254).

 01  TS0507-SBTS05-RED        REDEFINES TS0501-SBTS05. 
     10  TS0507-OPCAO         PIC 9(0002)        COMP.
     10  TS0507-STATUS        PIC 9(0002)        COMP.
     10  TS0507-MENSAGEM      PIC X(0040).
     10  TS0507-REGISTRO7.
       15  TS0507-APLCOD      PIC X(0007).
       15  TS0507-TABMENS     OCCURS 0012 TIMES.
         20  TS0507-USUHORINI PIC 9(0004)        COMP.
         20  TS0507-USUHORFIM PIC 9(0004)        COMP.
     10  FILLER               PIC X(0218). 

 01  TS0508-SBTS05-RED        REDEFINES TS0501-SBTS05.
     10  TS0508-OPCAO         PIC 9(0002)       COMP. 
     10  TS0508-STATUS        PIC 9(0002)       COMP.
     10  TS0508-MENSAGEM      PIC X(0040).
     10  TS0508-REGISTRO8.
       15  TS0508-USUNUM      PIC 9(0006)       COMP.
       15  TS0508-APLCOD      PIC X(0007).
       15  TS0508-TABMENS     OCCURS 0004 TIMES.
         20  TS0508-USUHORINI PIC 9(0004)       COMP.
         20  TS0508-USUHORFIM PIC 9(0004)       COMP. </pre></font>
<FONT SIZE=2><P>A seguir, &eacute; apresentada uma explica&ccedil;&atilde;o resumida de cada um destes campos: </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-OPCAO, TS0503-OPCAO, TS0504-OPCAO, TS0505-OPCAO, TS0506-OPCAO, TS0507-OPCAO, TS0508-OPCAO</B> - Identificador de processamento a ser efetuado pela sub-rotina, que pode ser: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"01"- Para obter os dados cadastrais de um usu&aacute;rio informando seu n&uacute;mero; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"02"- Para obter os dados cadastrais de um usu&aacute;rio informando a esta&ccedil;&atilde;o onde ele efetuou o <I>logon</I>; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"03" - Para obter os aplicativos habilitados um usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"04" - Para obter os elementos habilitados um usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"05" - Para obter os esta&ccedil;&otilde;es habilitadas um usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"06" - Para obter os limites de hor&aacute;rio de trabalho do usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"07" - Para obter os limites de hor&aacute;rio de utiliza&ccedil;&atilde;o do aplicativo/transa&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"08" - Para obter os limites de hor&aacute;rio do usu&aacute;rio trabalhar com o aplicativo/transa&ccedil;&atilde;o.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-STATUS, TS0503-STATUS, TS0504-STATUS, TS0505-STATUS, TS0506-STATUS, TS0507-STATUS, TS0508-STATUS </B>- Indicador de continua&ccedil;&atilde;o de dados do usu&aacute;rio pesquisado. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"0" - Para indicar que n&atilde;o existem mais aplicativos (Op&ccedil;&atilde;o "03") ou elementos (Op&ccedil;&atilde;o "04") habilitados ao usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"99" - Para indicar que existem mais aplicativos (Op&ccedil;&atilde;o "03") ou elementos (Op&ccedil;&atilde;o "04") habilitados ao usu&aacute;rio.</P></DIR>

<P>Para as op&ccedil;&otilde;es "03" ou "04", caso o <I>status</I> retornado pela sub-rotina seja igual a "99", pode-se chamar consecutivamente a sub-rotina a fim de obter todos os aplicativos habilitados ao usu&aacute;rio ou todos os elementos habilitados ao usu&aacute;rio, respectivamente. </P>
<P>A partir da segunda chamada da sub-rotina, n&atilde;o &eacute; necess&aacute;rio compor os campos de sua &aacute;rea de comunica&ccedil;&atilde;o antes de efetuar a chamada. Tamb&eacute;m n&atilde;o devem ser limpos tais campos. &Agrave; cada chamada da sub-rotina, deve-se testar o <I>status</I>, para certificar se seu valor &eacute; igual a "99", a fim de continuar a pesquisa. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-MENSAGEM, TS0503-MENSAGEM, TS0504-MENSAGEM, TS0505-MENSAGEM, TS0506-MENSAGEM, TS0507-MENSAGEM, TS0508-MENSAGEM</B> - Mensagem de erro detectado no processamento da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUNUM, TS0503-USUNUM, TS0504-USUNUM, TS0505-USUNUM, TS0506-USUNUM, TS0508-USUNUM</B> - N&uacute;mero do usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-ETCCOD</B> - C&oacute;digo da esta&ccedil;&atilde;o onde o usu&aacute;rio efetuou o <I>logon</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUCODEXT</B> - C&oacute;digo externo do usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUNOM</B> - Nome do usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUNIVACES</B> - N&iacute;vel de acesso geral do usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUEMP</B> - Sigla da empresa autorizada ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUAREA</B> - C&oacute;digo da &aacute;rea do usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUDADFUNC</B> - Dados funcionais do usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUEMPHAB</B> - Empresa autorizada ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUETBHAB</B> - Estabelecimento autorizado ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUUNDHAB </B>- Unidade autorizada ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0501-USUSTA</B> - <I>Status</I> do cadastramento do usu&aacute;rio, que pode ser: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"00" - Normal; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"01" - Bloqueado; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"02" - Em cadastramento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"03" - Em cadastramento bloqueado; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"04" - Bloqueado - Erro de d&iacute;gito verificador.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0503-TABMENS</B> - Tabela com dezenove (19) aplicativos habilitados ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0503-APLCOD TS0504-APLCOD TS0507-APLCOD TS0508-APLCOD</B> - Aplicativo habilitado ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0503-HABTIP</B> - Tipo da habilita&ccedil;&atilde;o do usu&aacute;rio ao aplicativo, que pode ser:</P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"0" - &Eacute; permitido ao usu&aacute;rio apenas consultar o aplicativo especificado. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"2" - &Eacute; permitido ao usu&aacute;rio consultar e atualizar o aplicativo especificado. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"3" - N&atilde;o &eacute; permitido ao usu&aacute;rio trabalhar com o aplicativo.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0503-USUEMPHAB TS0504-USUEMPHAB</B> - Empresa na qual o usu&aacute;rio est&aacute; habilitado ao aplicativo ou elemento. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0503-USUETBHAB TS0504-USUETBHAB</B> - Estabelecimento no qual o usu&aacute;rio est&aacute; habilitado ao aplicativo ou elemento. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0503-USUUNDHAB TS0504-USUUNDHAB</B> - Unidade na qual o usu&aacute;rio est&aacute; habilitado ao aplicativo ou elemento. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0503-USUNIVHAB</B> - N&iacute;vel de acesso do usu&aacute;rio ao aplicativo. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0504-ELMCOD</B> - C&oacute;digo do elemento habilitado ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0504-USUTIPHAB</B> - Tipo da habilita&ccedil;&atilde;o do usu&aacute;rio ao elemento, que pode ser:</P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"0" - &Eacute; permitido ao usu&aacute;rio apenas consultar o elemento no aplicativo especificado. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"2" - &Eacute; permitido ao usu&aacute;rio consultar e atualizar o elemento no aplicativo especificado. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"3" - N&atilde;o &eacute; permitido ao usu&aacute;rio trabalhar com elemento no aplicativo. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"9" - &Eacute; permitido ao usu&aacute;rio consultar e atualizar o elemento no aplicativo especificado e habilit&aacute;-lo a outro usu&aacute;rio.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0505-TABMENS</B> - Tabela com nove (9) esta&ccedil;&otilde;es habilitadas ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0505-ETCCOD</B> - C&oacute;digo da esta&ccedil;&atilde;o habilitada ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0506-TABMENS</B> - Tabela com quatro (4) intervalos de hora nas quais o usu&aacute;rio est&aacute; autorizado a trabalhar no ambiente SADS. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0506-USUHORINI</B> - Hora a partir da qual &eacute; permitido ao usu&aacute;rio trabalhar no ambiente SADS. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0506-USUHORFIM</B> - Hora a partir da qual n&atilde;o &eacute; mais permitido ao usu&aacute;rio trabalhar no ambiente SADS. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0507-TABMENS </B>- Tabela com sete (7) intervalos de hora nas quais um aplicativo/transa&ccedil;&atilde;o pode ser utilizado pelos usu&aacute;rios. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0507-USUHORINI</B> - Hora a partir da qual &eacute; permitido aos usu&aacute;rio trabalhar com o aplicativo/transa&ccedil;&atilde;o especificado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0507-USUHORFIM</B> - Hora a partir da qual n&atilde;o &eacute; mais permitido aos usu&aacute;rios utilizar o aplicativo/transa&ccedil;&atilde;o especificado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0508-TABMENS</B> - Tabela com quatro (4) intervalos de hora nas quais o usu&aacute;rio est&aacute; autorizado a trabalhar com o aplicativo/transa&ccedil;&atilde;o especificado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0508-USUHORINI</B> - Hora a partir da qual &eacute; permitido ao usu&aacute;rio trabalhar com o aplicativo/transa&ccedil;&atilde;o especificado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0508-USUHORFIM</B> - Hora a partir da qual n&atilde;o &eacute; mais permitido ao usu&aacute;rio trabalhar com o aplicativo/transa&ccedil;&atilde;o especificado. </P>
<P>A tabela a seguir apresenta explica&ccedil;&otilde;es dos par&acirc;metros de entrada e de sa&iacute;da da sub-rotina SBTS05 relacionados a cada uma das op&ccedil;&otilde;es:</P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=520>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<P ALIGN="CENTER"><B><FONT SIZE=2>OPCAO</B></FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<B><FONT SIZE=2><P ALIGN="CENTER">PARAMETROS DE ENTRADA</B></FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<B><FONT SIZE=2><P>PARAMETROS DE SAIDA</B></FONT></TD>
</TR>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">01</FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">TS0501-USUNUM<BR>
TS0501-OPCAO</FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0501-USUCODEXT<BR>
TS0501-USUNOM<BR>
TS0501-USUNIVACES<BR>
TS0501-USUEMP<BR>
TS0501-USUAREA<BR>
TS0501-USUDADFUNC<BR>
TS0501-USUEMPHAB<BR>
TS0501-USUETBHAB<BR>
TS0501-USUUNDHAB<BR>
TS0501-USUSTA<BR>
TS0501-MENSAGEM</FONT></TD>
</TR>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">02</FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">TS0501-ETCCOD<BR>
TS0501-OPCAO</FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0501-USUNUM<BR>
TS0501-USUCODEXT <BR>
TS0501-USUNOM<BR>
TS0501-USUNIVACES<BR>
TS0501-USUEMP<BR>
TS0501-USUAREA<BR>
TS0501-USUDADFUNC<BR>
TS0501-USUEMPHAB <BR>
TS0501-USUETBHAB<BR>
TS0501-USUUNDHAB<BR>
TS0501-USUSTA<BR>
TS0501-MENSAGEM</FONT></TD>
</TR>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">03</FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">TS0503-USUNUM<BR>
TS0503-OPCAO </FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0503-TABMENS<BR>
(TS0503-APLCOD<BR>
TS0503-HABTIP<BR>
TS0503-USUEMPHAB<BR>
TS0503-USUETBHAB <BR>
TS0503-USUUNDHAB<BR>
TS0503-USUNIVHAB)<BR>
TS0503-MENSAGEM</FONT></TD>
</TR>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">04</FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">TS0504-USUNUM<BR>
TS0504-OPCAO</FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0504-TABMENS<BR>
(TS0504-APLCOD<BR>
TS0504-HABTIP<BR>
TS0504-USUEMPHAB<BR>
TS0504-USUETBHAB TS0504-USUUNDHAB<BR>
TS0504-ELMCOD<BR>
TS0504-USUTIPHAB)<BR>
TS0504-MENSAGEM</FONT></TD>
</TR>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">05</FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">TS0505-USUNUM<BR>
TS0505-OPCAO<BR>
</FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0505-TABMENS<BR>
(TS0505-ETCCOD) <BR>
TS0505-MENSAGEM</FONT></TD>
</TR>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">06</FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">TS0506-USUNUM<BR>
TS0506-OPCAO</FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0506-TABMENS<BR>
(TS0506-USUHORINI<BR>
TS0506-USUHORFIM)<BR>
TS0506-MENSAGEM</FONT></TD>
</TR>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">07</FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">TS0507-APLCOD<BR>
TS0507-OPCAO</FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0507-TABMENS<BR>
(TS0507-USUHORINI<BR>
TS0507-USUHORFIM)<BR>
TS0507-MENSAGEM</FONT></TD>
</TR>
<TR><TD WIDTH="18%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">08</FONT></TD>
<TD WIDTH="36%" VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">TS0508-USUNUM<BR>
TS0508-APLCOD<BR>
TS0508-OPCAO</FONT></TD>
<TD WIDTH="45%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0508-TABMENS<BR>
(TS0508-USUHORINI<BR>
TS0508-USUHORFIM)<BR>
TS0508-MENSAGEM</FONT></TD>
</TR>
</TABLE>

<B><FONT SIZE=4><P><A NAME="Bloque">Sub-rotina para bloqueio de usu&aacute;rio do Sistema de Seguran&ccedil;a - SBTS06</A></B></FONT><FONT SIZE=2> </P>
<P>Esta sub-rotina objetiva possibilitar aos aplicativos bloquear os usu&aacute;rios cadastrados no Sistema de Seguran&ccedil;a. </P>
<P>Ap&oacute;s o bloqueio de um usu&aacute;rio, o mesmo fica impossibilitado de efetuar <I>logon</I> e, consequentemente, de acessar qualquer aplicativo no ambiente SADS. </P>
<P>Caso o usu&aacute;rio j&aacute; esteja logado no momento de seu bloqueio pela sub-rotina SBTS06, ser&aacute; ent&atilde;o efetuado seu <I>logoff</I> e, posteriormente, seu bloqueio. </P>
<P>Somente ap&oacute;s a libera&ccedil;&atilde;o do usu&aacute;rio, &eacute; que ele poder&aacute; novamente obter acesso ao ambiente SADS. </P>
<P>O programa que ir&aacute; disparar a sub-rotina SBTS06 dever&aacute; estar habilitado a acess&aacute;-la. Esta habilita&ccedil;&atilde;o deve ter sido feita atrav&eacute;s do menu de opera&ccedil;&atilde;o "SEGSUB". Para se obter maiores detalhes em como proceder este cadastramento, deve-se consultar a Se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Fun&ccedil;&otilde;es de controle", neste manual. </P><DIR>

<B><P><A NAME="SBT06">&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina SBTS06</B>(<I>Library</I> SB/T/SL/06)</A> </P>
</FONT><pre><font size=3>
 01 TS0601-SBTS06.
    10  TS0601-USUNUM         PIC 9(0006).
    10  TS0601-USUCODEXT      PIC X(0017).
    10  TS0601-IDCNUMCOD      PIC X(0001).
    10  TS0601-RESPOSTA       PIC 9(0002).
    10  TS0601-MENSAGEM       PIC X(0030).</pre></font>
<FONT SIZE=2><P>A seguir, &eacute; apresentada uma explica&ccedil;&atilde;o resumida de cada um destes campos: </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0601-USUNUM</B> - N&uacute;mero do usu&aacute;rio a ser bloqueado; </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0601-USUCODEXT</B> - C&oacute;digo externo do usu&aacute;rio a ser bloqueado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0601-IDCNUMCOD</B> - Identificador de informa&ccedil;&atilde;o do n&uacute;mero ou do c&oacute;digo do usu&aacute;rio. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para indicar que foi informado o n&uacute;mero do usu&aacute;rio; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"C" - Para indicar que foi informado o c&oacute;digo do usu&aacute;rio.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0601-RESPOSTA</B> - Indicador do resultado do processamento, que pode ser: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"0" - O bloqueio do usu&aacute;rio foi efetuado corretamente; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"9" - O bloqueio do usu&aacute;rio n&atilde;o foi efetuado, devido a um erro, apresentado em TS0601-MENSAGEM.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS0601-MENSAGEM</B> - Mensagem que identifica o erro ocorrido no bloqueio do usu&aacute;rio. </P>
<P>A tabela a seguir apresenta explica&ccedil;&otilde;es dos par&acirc;metros de entrada e de sa&iacute;da da sub-rotina SBTS06 relacionados a cada uma das op&ccedil;&otilde;es: </P></DIR>
</FONT>
<TABLE BORDER CELLSPACING=1 WIDTH=472>
<TR><TD WIDTH="53%" VALIGN="MIDDLE">
<P><B><FONT SIZE=2>PARAMETROS DE ENTRADA</B> </FONT></TD>
<TD WIDTH="47%" VALIGN="MIDDLE">
<B><FONT SIZE=2><P>PARAMETROS DE SAIDA</B> </FONT></TD>
</TR>
<TR><TD WIDTH="53%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0601-IDCNUMCOD<BR>
TS0601-USUNUM ou<BR>
TS0601-USUCODEXT</FONT></TD>
<TD WIDTH="47%" VALIGN="MIDDLE">
<FONT SIZE=2><P>TS0601-RESPOSTA<BR>
TS0601-MENSAGEM</FONT></TD>
</TR>
</TABLE>

<B><FONT SIZE=4><P><A NAME="Exclui">Sub-rotina para tratamento de exclus&atilde;o de itens de tabela</A></B></FONT><FONT SIZE=2> </P>
<P>As sub-rotinas para tratamento de exclus&atilde;o de itens s&atilde;o recursos oferecidos com o objetivo de evitar a exclus&atilde;o indevida de determinados itens da tabela, de forma a garantir integridade referencial nas transa&ccedil;&otilde;es de exclus&atilde;o de itens de tabelas do SADS </P>
<P>A especifica&ccedil;&atilde;o desta sub-rotina encontra-se descrita no item "Tabela", nesta mesma se&ccedil;&atilde;o. </P>
<P>Esta sub-rotina, quando especificada, ser&aacute; executada sempre que uma transa&ccedil;&atilde;o de exclus&atilde;o de itens for solicitada, seja para excluir um item ou uma lista de itens. </P>
<P>Em ambos os casos, as transa&ccedil;&otilde;es de exclus&atilde;o s&oacute; ser&atilde;o efetuadas se a sub-rotina assim permitir. </P><DIR>

<B><P><A NAME="Excite">&Aacute;rea de comunica&ccedil;&atilde;o da sub-rotina para tratamento de exclus&atilde;o de itens (<I>Library</I> SS/T/SL/99)</A></B> </P>
<P>A &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina deve ser definida atrav&eacute;s da <I>library</I> SS/T/SL/99, que possui os seguintes campos : </P>
</FONT><pre><font size=3>
 10  TS9901-OPCAO        PIC 9(001).
 10  TS9901-USUNIVACES   PIC 9(002).
 10  TS9901-USUNUM       PIC 9(006).
 10  TS9901-UNDUSUSADS   PIC 9(002).
 10  TS9901-TABCOD       PIC 9(008).
 10  TS9901-EMPCOD       PIC 9(003).
 10  TS9901-ETBCOD       PIC 9(004).
 10  TS9901-UNDCOD       PIC 9(003).
 10  TS9901-ITMARGUM     PIC X(008).
 10  TS9901-ITMCONT      PIC X(300).
 10  TS9901-RESPOSTA     PIC X(030).</pre></font>
<FONT SIZE=2><P>A seguir, encontra-se uma explica&ccedil;&atilde;o resumida sobre o preenchimento de cada um dos campos anteriormente citados. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-OPCAO</B> - C&oacute;digo de erro a ser retornado. </P>
<P>Caso o item da tabela n&atilde;o possa ser exclu&iacute;do, a sub-rotina tem de mover 9 (nove) para TS9901-OPCAO. Caso contr&aacute;rio, deve mover 0 (zero). </P>
<P>Os programas do Sistema de Tabelas respons&aacute;veis pelas exclus&otilde;es de itens, ao receberem TS9901-OPCAO igual a 9, n&atilde;o permitir&atilde;o que a exclus&atilde;o seja efetuada. Neste caso, ser&aacute; exibida na tela a mensagem de erro contida no campo TS9901-RESPOSTA. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUNIVACES</B> - N&iacute;vel de acesso do usu&aacute;rio que requisitou a exclus&atilde;o de item de tabela. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUNUM</B> - N&uacute;mero do usu&aacute;rio que requisitou a exclus&atilde;o de item de tabela. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-UNDUSUSADS</B> - Unidade SADS do usu&aacute;rio (campo para utiliza&ccedil;&atilde;o futura, ser&aacute; preenchido com 01). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-TABCOD</B> - C&oacute;digo da tabela para a qual uma exclus&atilde;o de itens foi requisitada. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-EMPCOD</B> - C&oacute;digo da empresa na qual o usu&aacute;rio que requisitou a exclus&atilde;o do item da tabela efetuou o <I>logon</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-ETBCOD</B> - C&oacute;digo do estabelecimento no qual o usu&aacute;rio que requisitou a exclus&atilde;o do item da tabela efetuou o <I>logon</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-UNDCOD</B> - C&oacute;digo da unidade na qual o usu&aacute;rio que requisitou a exclus&atilde;o do item da tabela efetuou o <I>logon</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-ITMARGUM</B> - Argumento do item a ser exclu&iacute;do. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-ITMCONT</B> - Dados do item a ser exclu&iacute;do. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-RESPOSTA</B> - Mensagem de erro. </P>
<P>Caso o item da tabela n&atilde;o possa ser exclu&iacute;do, a sub-rotina dever&aacute; compor o campo TS9901-RESPOSTA com uma mensagem indicando o impedimento. </P>
<P>Deve-se atentar para o fato de que os campos TS9901-OPCAO e TS9901-RESPOSTA s&atilde;o os &uacute;nicos campos que devem ser compostos pela sub-rotina para retorno ao Sistema de Tabelas. Os demais s&atilde;o passados para a sub-rotina para que ela possa executar os testes necess&aacute;rios. </P>
<B><P><A NAME="Codsub">Codifica&ccedil;&atilde;o da sub-rotina para tratamento de exclus&atilde;o de itens</A></B> </P>
<P>A sub-rotina de tratamento de exclus&atilde;o de itens de tabela pode ter qualquer c&oacute;digo, desde que esteja no padr&atilde;o SADS - sssSxx. Esta sub-rotina deve ser constru&iacute;da pelo analista respons&aacute;vel pela tabela e ser relacionada &agrave; mesma no momento da defini&ccedil;&atilde;o de seus par&acirc;metros. </P>
<P>Nesta sub-rotina podem ser codificados testes contra cadastro, testes de habilita&ccedil;&atilde;o de usu&aacute;rio ou qualquer outro que identifique exclus&otilde;es indesej&aacute;veis de itens. </P>
<P>O SADS permite a gera&ccedil;&atilde;o completa de uma sub-rotina pra tratamento de exclus&atilde;o de itens de tabela. Detalhes sobre esta gera&ccedil;&atilde;o, est&atilde;o descritos no t&oacute;pico "Cadastramento", neste mesmo item. </P>
<P>Al&eacute;m do c&oacute;digo no padr&atilde;o SADS, existem outras regras que devem ser observadas caso a sua codifica&ccedil;&atilde;o seja feita no CANDE, quais sejam: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>O <I>Program-id</I> da SUB-ROTINA tem de ser SSTS99; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>O nome do fonte da sub-rotina deve ter o formato ss/s/SF/xx. Como exemplo, temos, no sistema "XYZ", a sub-rotina "XYZS90", cujo fonte possui o c&oacute;digo "XY/Z/SF/90". </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>A<I> library</I> da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina deve estar declarada na WORKING-STORAGE SECTION da mesma, atrav&eacute;s dos seguintes comandos:</P>
</FONT><pre><font size=3>
 01   TS9901-SSTS99 RECEIVED BY REFERENCE.
      COPY "SS/T/SL/99" FROM 100300 THRU 101700. </pre></font>
<P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Na PROCEDURE DIVISION: </P></DIR>
</DIR>


<UL>

<UL>
<LI>Atrav&eacute;s das informa&ccedil;&otilde;es contidas na &aacute;rea de comunica&ccedil;&atilde;o, a sub-rotina dever&aacute; efetuar os testes necess&aacute;rios; </LI>
<LI>Sempre que houver uma condi&ccedil;&atilde;o que impe&ccedil;a a exclus&atilde;o do item da tabela, a sub-rotina dever&aacute;:</LI></UL>
</UL>

</FONT><pre><font size=3>
  mover 9                     para TS9901-OPCAO e 
  mover &lt;mensagem do erro&gt;    para TS9901-RESPOSTA. </pre></font><DIR>
<DIR>

<FONT SIZE=2><P>Se os campos forem compostos pela sub-rotina conforme descri&ccedil;&atilde;o acima, os programas do Sistema de Tabelas respons&aacute;veis pelas exclus&otilde;es de itens, ao receberem TS9901-OPCAO igual a 9, n&atilde;o efetuar&atilde;o a exclus&atilde;o. Neste caso, ser&aacute; exibida na tela a mensagem de erro contida no campo TS9901-RESPOSTA.</P></DIR>
</DIR>

</FONT><FONT SIZE=4><P><A NAME="Conger">Sub-rotina espec&iacute;fica para Consist&ecirc;ncia Geral</A></FONT><FONT SIZE=2> </P>
<P>Esta sub-rotina funciona como um recurso dispon&iacute;vel para disparar testes que n&atilde;o possam ser executados pela Consist&ecirc;ncia Geral. Desta forma, os testes por ela disparados ficam independentes dos programas aplicativos, n&atilde;o necessitando, portanto, de serem codificados na defini&ccedil;&atilde;o dos programas que deles necessitarem. </P>
<P>Os testes constantes nesta sub-rotina podem ser contra cadastro (integridade referencial) ou espec&iacute;ficos da aplica&ccedil;&atilde;o. </P>
<P>O teste contra sub-rotina espec&iacute;fica da aplica&ccedil;&atilde;o pode ser definido de duas formas distintas, quais sejam: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>SRC="Bullet1.gif" WIDTH=12 HEIGHT=12Cadastramento de um teste do atributo/campo contra sub-rotina da aplica&ccedil;&atilde;o nas validades em n&iacute;vel de estrutura da consist&ecirc;ncia; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Cadastramento da sub-rotina para teste do atributo/campo no momento da defini&ccedil;&atilde;o do mesmo.</P></DIR>

<P>Cumpre ressaltar que, se este tipo de teste envolver mais de um atributo ou campo, somente a defini&ccedil;&atilde;o em n&iacute;vel de estrutura de consist&ecirc;ncia poder&aacute; ser aplicada. </P>
<P>Em ambos os casos, no momento em que o SADS estiver executando a consist&ecirc;ncia relacionada com o atributo/campo, a sub-rotina espec&iacute;fica da aplica&ccedil;&atilde;o ser&aacute; tamb&eacute;m executada e, por conseguinte, os testes nela codificados ser&atilde;o efetuados. </P>
<P>Maiores detalhes sobre o cadastramento de testes de atributo/campo contra sub-rotina na Consist&ecirc;ncia Geral est&atilde;o descritos no item "Consist&ecirc;ncia", t&oacute;pico "Validades em n&iacute;vel de estrutura", nesta se&ccedil;&atilde;o. </P>
<P>Detalhes de como relacionar uma sub-rotina no cadastramento de atributos e campos est&atilde;o descritos no t&oacute;pico "Cadastramento", nos itens "Atributo" e "Campo", nesta se&ccedil;&atilde;o. </P>
<P>Para que a sub-rotina da aplica&ccedil;&atilde;o possa ser disparada pelo SADS &eacute; necess&aacute;rio que ela esteja cadastrada no reposit&oacute;rio de dados e que seu c&oacute;digo objeto resida sem <I>usercode</I> no mesmo <I>pack</I> das sub-rotinas do SADS. Al&eacute;m disso, esta sub-rotina deve seguir algumas regras de codifica&ccedil;&atilde;o, que ser&atilde;o explicadas no item "Codifica&ccedil;&atilde;o de sub-rotina disparada pela Consist&ecirc;ncia Geral", nesta se&ccedil;&atilde;o. </P>
<P>A seguir, e&amp;acute; apresentado um exemplo de utiliza&ccedil;&atilde;o de teste contra sub-rotina, cadastrado nas "validades em n&iacute;vel de estrutura da Consist&ecirc;ncia Geral": </P>
</FONT><pre><font size=3>       <B> FUNC  TIP1  OPERANDO1                TIP2   OPERADO2   SUF2
</B>        SUB    C   ORGCOD                     S    ABCS01      A</pre></font>
<FONT SIZE=2><P>Neste exemplo, &eacute; considerado que os &oacute;rg&atilde;os de uma empresa j&aacute; estejam armazenados em um <I>dataset</I>. Sendo assim, para cadastrar um empregado, &eacute; necess&aacute;rio que o &oacute;rg&atilde;o para o qual haver&aacute; a contrata&ccedil;&atilde;o dos servi&ccedil;os do mesmo seja v&aacute;lido. </P>
<P>Esta verifica&ccedil;&atilde;o pode ser executada por uma sub-rotina espec&iacute;fica, caso o cadastro de &oacute;rg&atilde;os esteja em um banco de dados diferente do banco da aplica&ccedil;&atilde;o, evitando, assim, que diversos programas, para os quais o teste seja necess&aacute;rio, tenham de execut&aacute;-lo de forma redundante. </P><DIR>

<B><P><A NAME="Espec">&Aacute;rea de comunica&ccedil;&atilde;o da Consist&ecirc;ncia Geral com a sub-rotina espec&iacute;fica (Library SB/P/SL/99)</A></B> </P>
<P>A library "SB/P/SL/99", que cont&eacute;m a &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina, possui o seguinte <I>layout</I>: </P>
</FONT><pre><font size=3>
 01  PS9901 RECEIVED BY REFERENCE.
   05  PS9901-OPCAO              PIC 9(01).
   05  PS9901-ELEMENTO           PIC X(08).
   05  PS9901-DADOS.
       10  PS9901-DADOSA         PIC X(23).
       10  PS9901-DADOSB         PIC X(23).
       10  PS9901-DADOSC         PIC X(23).
   05  PS9901-RESPOSTA           PIC X(18).
   05  PS9901-RESPOSTA-RED       REDEFINES PS9901-RESPOSTA
       10  PS9901-EMPRESA        PIC 9(03).
       10  PS9901-ESTABELEC      PIC 9(03).
       10  PS9901-ESTABELEC2     PIC 9(03).
       10  PS9901-TRANSACAO.
         15  PS9901-SISTEMA      PIC X(03).
         15  PS9901-MENU         PIC X(02).
         15  PS9901-NUMTRANS     PIC X(02).
       10  PS9901-USUAMBI        PIC X(01)
       10 FILLER                 PIC 9(01).
   05  PS9901-ESTABELEC4         PIC 9(04).</pre></font>
<FONT SIZE=2><P>A seguir, encontra-se uma explica&ccedil;&atilde;o resumida sobre o preenchimento de cada um dos campos anteriormente citados: </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-OPCAO</B> - C&oacute;digo de erro a ser retornado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>Caso algum erro tenha ocorrido, a sub-rotina tem de mover 9 (nove) para PS9901-OPCAO. Caso contr&aacute;rio, deve mover 0 (zero). </P>
<P>Deste modo, a Consist&ecirc;ncia Geral, ao receber PS9901-OPCAO igual a 9 (nove), devolver&aacute; para o terminal a mensagem de erro contida no campo PS9901-RESPOSTA. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-ELEMENTO</B> - Este campo fica preenchido com o c&oacute;digo da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-DADOSA</B> - Conte&uacute;do do campo informado com sufixo "A" na consist&ecirc;ncia da tela ou tabela em quest&atilde;o. </P>
<P>Se este campo n&atilde;o for utilizado para a consist&ecirc;ncia, seu conte&uacute;do ser&aacute; LOW-VALUES. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-DADOSB</B> - Conte&uacute;do do campo informado com sufixo "B" na consist&ecirc;ncia da tela ou tabela em quest&atilde;o. </P>
<P>Se este campo n&atilde;o for utilizado para a consist&ecirc;ncia, seu conte&uacute;do ser&aacute; LOW-VALUES. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-DADOSC</B> - Conte&uacute;do do campo informado com sufixo "C" na consist&ecirc;ncia da tela ou tabela em quest&atilde;o. </P>
<P>Para a consist&ecirc;ncia, a informa&ccedil;&atilde;o deste campo &eacute; obrigat&oacute;ria. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-RESPOSTA</B> - Mensagem do erro. </P>
<P>Caso tenha sido detectado um erro atrav&eacute;s dos testes efetuados, a sub-rotina ir&aacute; compor PS9901-RESPOSTA com a mensagem de erro a ser exibida na tela pela Consist&ecirc;ncia Geral do SADS. Neste caso, o campo PS9901-OPCAO deve ser preenchido com 9 (nove). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-EMPCOD</B> - C&oacute;digo da empresa na qual o usu&aacute;rio efetuou o <I>logon.</I> </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-ESTABELEC</B> - C&oacute;digo do estabelecimento no qual o usu&aacute;rio efetuou o <I>logon</I>, com 3 <I>bytes</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-ESTABELEC2</B> - C&oacute;digo da unidade na qual o usu&aacute;rio efetuou o <I>logon</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-TRANSACAO</B> - Transa&ccedil;&atilde;o ou tabela cuja consist&ecirc;ncia est&aacute; sendo efetuada. As transa&ccedil;&otilde;es e tabelas estar&atilde;o no formato "sssnnmm" e "sssnnnn". Ex: SXY0111 e SWI5099. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-USUAMBI</B> - Ambiente no qual o usu&aacute;rio efetuou o <I>logon</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PS9901-ESTABELEC4</B> - C&oacute;digo do estabelecimento no qual o usu&aacute;rio efetuou o <I>logon</I>, com 4 <I>bytes</P></DIR>

</I><B><P><A NAME="Codger">Codifica&ccedil;&atilde;o de sub-rotina disparada pela Consist&ecirc;ncia Geral</A></B> </P>
<P>O SADS permite a gera&ccedil;&atilde;o completa de uma sub-rotina para consist&ecirc;ncias espec&iacute;ficas da aplica&ccedil;&atilde;o que seja disparada pela Consist&ecirc;ncia Geral. Detalhes sobre esta gera&ccedil;&atilde;o, est&atilde;o descritos no t&oacute;pico "Cadastramento", neste mesmo item. </P>
<P>Por&eacute;m, caso a codifica&ccedil;&atilde;o da sub-rotina seja feita atrav&eacute;s do CANDE, existem algumas regras a serem seguidas para esta codifica&ccedil;&atilde;o. S&atilde;o elas:</P><DIR>
<DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>O <I>Program-id</I> da sub-rotina deve ser SBPS99. </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>O nome da sub-rotina deve estar no padr&atilde;o SADS, sssSxx. Por exemplo: no sistema "SRH", o padr&atilde;o de codifica&ccedil;&atilde;o para sub-rotina &eacute; "SRHS01" e para o fonte, "SR/H/SF/01". </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>A &aacute;rea de comunica&ccedil;&atilde;o deve ser inserida no fonte desta sub-rotina atrav&eacute;s do seguinte comando:</P>
</FONT><pre><font size=3>  COPY "SB/P/SL/99" FROM 200000 THRU 299999.</pre></font>
<P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>A Consist&ecirc;ncia Geral passa, no m&aacute;ximo, tr&ecirc;s par&acirc;metros (PS9901-DADOSA, PS9901-DADOSB e PS9901-DADOSC) para a sub-rotina espec&iacute;fica da aplica&ccedil;&atilde;o. Estes par&acirc;metros podem ser atributos/campos ou itens de grupo, tendo cada um deles o tamanho m&aacute;ximo de 23 caracteres. </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>A consist&ecirc;ncia passa os dados dos atributos/campos para a sub-rotina sempre alinhados &agrave; esquerda, independente de serem alfanum&eacute;ricos ou num&eacute;ricos. </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Os campos EMPRESA, ESTABELECIMENTO e UNIDADE do <I>&nbsp;logon</I> do usu&aacute;rio s&atilde;o passados automaticamente para a sub-rotina: PS9901-EMPRESA (Empresa), PS9901-ESTABELEC Estabelecimento com 3 <I>bytes</I>), PS9901-ESTABELEC4 (Estabelecimento com 4 <I>bytes</I>) e PS9901-ESTABELEC2 (Unidade). </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Se houver necessidade de passar mais de tr&ecirc;s campos para a sub-rotina, deve-se cadastrar itens de grupo na estrutura da consist&ecirc;ncia. </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Se houver necessidade de passar um campo com mais de 23 <I>bytes</I> para a sub-rotina, pode-se redefini-lo e pass&aacute;-lo em mais de um campo. </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Na PROCEDURE DIVISION, a sub-rotina dever&aacute; fazer os testes necess&aacute;rios utilizando-se das informa&ccedil;&otilde;es passadas na &aacute;rea de comunica&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Sempre que houver uma condi&ccedil;&atilde;o de erro, a sub-rotina dever&aacute;:</P>
</FONT><pre><font size=3>   mover 9                    para PS9901-OPCAO e
   mover &lt;mensagem do erro&gt;   para PS9901-RESPOSTA.</pre></font>
<FONT SIZE=2><P>Deste modo, se os campos acima forem compostos conforme descritos, a Consist&ecirc;ncia Geral, ao receber PS9901-OPCAO igual a 9, ir&aacute; exibir na tela a mensagem de erro contida em PS9901-RESPOSTA. </P>
<B><P><A NAME="Atrica">Exemplo de codifica&ccedil;&atilde;o de sub-rotina para consist&ecirc;ncia de atributo/campo - SR/H/SF/01</A></B> </P>
</FONT><pre><font size=3>
  $  FEDLEVEL = 5
  $  SHARING = SHAREDBYALL
     IDENTIFICATION DIVISION.
     PROGRAM-ID     SBPS99.
     AUTHOR         ANALISTA DE SISTEMAS.
     DATE-WRITTEN   20/01/93 @ 09:10:36.
     ENVIROMENT DIVISION.
     CONFIGURATION SECTION.
     SPECIAL NAMES.
        DECIMAL POINT IS COMMA.
     INPUT-OUTPUT SECTION.
     FILE CONTROL.
     DATA DIVISION.
     DATA-BASE SECTION.
         COPY SR/H/BL/00 FROM 300000 THRU 399999.
     01   SRHB01.

  $  PAGE

     WORKING-STORAGE SECTION.
     77 CHV-OPEN                          PIC X(01) VA "N". 
     01 AREA-WORK.
     05 WSS-DADOS-A.
        10 WSS-DADOS-A1                   PIC 9(06).
        10 WSS-DADOS-A2                   PIC X(17).
     05 WSS-DADOS-B.
        10 WSS-DADOS-B1                   PIC X(23).
     05 WSS-DADOS-C.
        10 WSS-DADOS-C1                   PIC 9(04).
        10 WSS-DADOS-C2                   PIC X(19).
     COPY "SB/P/SL/99" FROM 200000 THRU 299999. 

  $  PAGE

     PROCEDURE DIVISION USING PS9901.
     10004-00-INICIO.
          IF CHV-OPEN EQUAL "S"
            GO TO 10004-10-PROCESSAMENTO.
            *** ABRIR BANCO ***
            MOVE "S" TO CHV-OPEN.
            COPY "SR/H/BL/00" FROM 400000 THRU 499999. 
     10004-10-PROCESSAMENTO.
            MOVE PS9901-DADOSA            TO WSS-DADOS-A.
            MOVE PS9901-DADOSB            TO WSS-DADOS-B.
            MOVE PS9901-DADOSC            TO WSS-DADOS-C. 
            MOVE 0                        TO PS9901-OPCAO. 

            FIND KEY OF FIRST SRHB01A AT
                 H0100-ORGCOD = WSS-DADOS-C1
                 ON EXCEPTION
                 IF DMSTATUS(NOTFOUND)
                    MOVE 9 TO PS9901-OPCAO 
                    MOVE "ORG. NAO EXISTE"TO PS9901-RESPOSTA 
                      EXIT PROGRAM
                 ELSE
                    MOVE SPACES           TO CHV-OPEN
                    DISPLAY "EXCECAO FATAL - DMS - SRHSF01" 
                    DISPLAY "CATEGORIA " DMSTATUS(DMCATEGORY) 
                    DISPLAY "SUBCATEG " DMSTATUS(DMERRORTYPE) 
                    DISPLAY "ESTRUTURA " DMSTATUS(DMSTRUTUCRE) 
                    SET MYSELF(STATUS)    TO -1.

            IF WSS-DADOS-A1 GREATER H0100-ORGDATSEL 
               WSS-DADOS-A1 LESS H0100-ORGDATCRI
               MOVE 9 TO PS9901-OPCAO
               MOVE "DATA ADM.INVALIDA"   TO PS9901-RESPOSTA 

            ELSE
               EXIT PROGRAM.</pre></font></DIR>
</DIR>

<B><FONT SIZE=4><P><A NAME="Ususis">Sub-rotina para consist&ecirc;ncias espec&iacute;ficas de usu&aacute;rios do Sistema de Seguran&ccedil;a - SBTS99</A></B></FONT><FONT SIZE=2> </P>
<P>Esta sub-rotina funciona como um recurso dispon&iacute;vel para disparar testes de usu&aacute;rios que normalmente n&atilde;o s&atilde;o executados pelo Sistema de Seguran&ccedil;a. </P>
<P>Os testes constantes na sub-rotina SBTS99 poder&atilde;o ser independentes daqueles efetuados pelo pr&oacute;prio Sistema de Seguran&ccedil;a e ir&atilde;o depender da necessidade dos aplicativos em integrar com o SADS/SS. </P>
<P>Como exemplos de testes espec&iacute;ficos a serem definidos na SBTS99, tem-se: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Verificar se o usu&aacute;rio a ser inclu&iacute;do na base de dados do Sistema de Seguran&ccedil;a j&aacute; se encontra cadastrado no Sistema de Recursos Humanos; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Verificar se o usu&aacute;rio a ser cadastrado com n&iacute;vel de acesso igual a 98 (Sub-administrador de Seguran&ccedil;a) possui o cargo de gerente de ag&ecirc;ncia, etc.</P></DIR>

<P>A sub-rotina SBTS99 para consist&ecirc;ncias espec&iacute;ficas de usu&aacute;rios ser&aacute; sempre disparada nas opera&ccedil;&otilde;es de inclus&atilde;o e altera&ccedil;&atilde;o de usu&aacute;rios e perfis modelo. Inicialmente ela foi definida sem nenhum comando ou teste. &Agrave; medida que os aplicativos tiverem necessidade de codificar testes espec&iacute;ficos, estes dever&atilde;o ser inclu&iacute;dos na sub-rotina e o objeto desta dever&aacute; ent&atilde;o ser substitu&iacute;do.</P><DIR>

<B><P><A NAME="Sissub">&Aacute;rea de comunica&ccedil;&atilde;o do Sistema de Seguran&ccedil;a com a sub-rotina espec&iacute;fica (Library SB/T/SL/99)</A></B> </P>
<P>Os campos que comp&otilde;em a <I>library</I> SB/T/SL/99, que cont&eacute;m a estrutura da &aacute;rea de comunica&ccedil;&atilde;o desta sub-rotina, s&atilde;o os seguintes : </P>
</FONT><pre><font size=3>
  01  TS9901-SBTS99
    10  TS9901-ENTRADA
       15 TS9901-USUNUM                   PIC 9(0006)
       15 TS9901-USUCODEXT                PIC X(0017)
       15 TS9901-USUTIPO                  PIC 9(0001)
       15 TS9901-USUDADFUNC               PIC X(0050)
       15 TS9901-USURESP                  PIC 9(0006)
       15 TS9901-USUEMP                   PIC X(0003)
       15 TS9901-USUAREA                  PIC X(0020)
       15 TS9901-USUNIVACES               PIC 9(0002)
       15 TS9901-USUAMBI                  PIC X(0001)
       15 TS9901-USUEMPHAB                PIC 9(0003)
       15 TS9901-USUETBHAB                PIC 9(0004)
       15 TS9901-USUUNDHAB                PIC 9(0003)
    10  TS9901-SAIDA.
      15 TS9901-RESPOSTA                  PIC 9(0002). 
      15 TS9901-MENSAGEM                  PIC X(0030). </pre></font>
<FONT SIZE=2><P>A seguir, encontra-se uma explica&ccedil;&atilde;o resumida sobre o preenchimento de cada um dos campos anteriormente citados: </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-ENTRADA</B> - Dados fornecidos pelo pr&oacute;prio Sistema de Seguran&ccedil;a, relativos ao usu&aacute;rio a ser inclu&iacute;do ou alterado. Estes dados ser&atilde;o utilizados nos testes espec&iacute;ficos a serem efetuados internamente &agrave; sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUNUM</B> - N&uacute;mero do usu&aacute;rio a ser inclu&iacute;do ou alterado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUCODEXT</B> - C&oacute;digo externo do usu&aacute;rio a ser inclu&iacute;do ou alterado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUTIPO</B> - Tipo do usu&aacute;rio a ser inclu&iacute;do ou alterado, que pode ser: 0 - Usu&aacute;rio normal ou 2 - Perfil modelo. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUDADFUNC</B> - Dados funcionais do usu&aacute;rio a ser inclu&iacute;do ou alterado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USURESP</B> - N&uacute;mero do usu&aacute;rio respons&aacute;vel pela opera&ccedil;&atilde;o de inclus&atilde;o ou altera&ccedil;&atilde;o. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUEMP</B> - Sigla da empresa do usu&aacute;rio a ser inclu&iacute;do ou alterado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUAREA</B> - C&oacute;digo da &aacute;rea do usu&aacute;rio a ser inclu&iacute;do ou alterado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUNIVACES</B> - N&iacute;vel de acesso geral do usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUAMBI</B> - Ambiente autorizado ao usu&aacute;rio ("T", "P" ou "A" ). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUEMPHAB</B> - Empresa habilitada ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUETBHAB </B>- Estabelecimento habilitado ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-USUUNDHAB</B> - Unidade habilitado ao usu&aacute;rio. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-SAIDA</B> - Dados retornados pela sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-RESPOSTA</B> - Indicador de erro detectado pelos testes internos &agrave; sub-rotina, que pode ser: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"99" - Para indicar que foi detectado um erro atrav&eacute;s dos testes internos &agrave; sub-rotina e, neste caso, o usu&aacute;rio n&atilde;o poder&aacute; ser inclu&iacute;do ou alterado. </P>
<P>A mensagem que identifica o erro dever&aacute; ser composta em TS9901-MENSAGEM. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"00" - Para indicar que n&atilde;o foi detectado nenhum erro atrav&eacute;s dos testes internos &agrave; sub-rotina e, neste caso poder&aacute; ser conclu&iacute;da a inclus&atilde;o ou altera&ccedil;&atilde;o do usu&aacute;rio.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TS9901-MENSAGEM</B> - Mensagem de erro detectadado internamente &agrave; sub-rotina pelos testes espec&iacute;ficos.</P></DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Cadas">Cadastramento</A></B></FONT><FONT SIZE=2> </P>
</FONT><P><HR></P>
<FONT SIZE=2><P>O processo de cadastramento de sub-rotina s&oacute; &eacute; poss&iacute;vel a partir do cadastramento de seu sistema no reposit&oacute;rio de dados do SADS. </P>
</FONT><B><FONT SIZE=4><P>Roteiro</B></FONT><FONT SIZE=2> </P>
<P>As fun&ccedil;&otilde;es voltadas para cadastrar sub-rotinas e torn&aacute;-las dispon&iacute;veis s&atilde;o: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Defini&ccedil;&atilde;o de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>-Estrutura de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Gera&ccedil;&atilde;o de <I>library</I> de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Libera&ccedil;&atilde;o de <I>library</I> de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina para produ&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Defini&ccedil;&atilde;o de sub-rotina (esta defini&ccedil;&atilde;o &eacute; parcialmente gerada a partir do cadastramento da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina); </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Recursos de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>&Aacute;rea de <I>work</I> de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>L&oacute;gica de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Sele&ccedil;&atilde;o de m&oacute;dulos de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Cadastramento de m&oacute;dulos de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Edi&ccedil;&atilde;o cobol; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Gera&ccedil;&atilde;o de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Compila&ccedil;&atilde;o de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Libera&ccedil;&atilde;o de objeto de sub-rotina para produ&ccedil;&atilde;o.</P></DIR>

<P>A seguir, cada uma dessas fun&ccedil;&otilde;es ser&aacute; explicada detalhadamente. </P>
</FONT><B><FONT SIZE=5><P><A NAME="Defcom">Defini&ccedil;&atilde;o de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>Para cada sub-rotina &eacute; necess&aacute;rio definir uma &aacute;rea para comunica&ccedil;&atilde;o com os programas que far&atilde;o chamada &agrave; mesma. Atrav&eacute;s desta &aacute;rea ser&atilde;o transferidos os par&acirc;metros entre os programas e a sub-rotina. </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Nome</B> - Descri&ccedil;&atilde;o resumida da sub-rotina. </P>
<P>O nome tem a fun&ccedil;&atilde;o de explicar e identificar resumidamente a que se refere a sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Quantidade de registros</B> - Quantidade de registros da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Operacao </B>- Opera&ccedil;&atilde;o efetuada em rela&ccedil;&atilde;o &agrave; defini&ccedil;&atilde;o de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina. </P>
<P>As opera&ccedil;&otilde;es poss&iacute;veis s&atilde;o as seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"INC" (Inclus&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"ALT" (Altera&ccedil;&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXC" (Exclus&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"CON" (Consulta). </P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Estcom">Estrutura de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>A estrutura da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina compreende os atributos e campos que s&atilde;o par&acirc;metros de entrada, a serem compostos pelo programa, e par&acirc;metros de sa&iacute;da, a serem compostos pela sub-rotina. </P>
<P>No contexto de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina, entenda-se atributo como sendo atributo propriamente dito, campo ou sin&ocirc;nimo. </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Registro</B> - N&uacute;mero do registro a ser definido. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Nome</B> - Descri&ccedil;&atilde;o resumida da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina. </P>
<P>A seguir, s&atilde;o apresentadas ocorr&ecirc;ncias para indica&ccedil;&atilde;o dos atributos que fazem parte da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina e suas particularidades. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Seq</B> - N&uacute;mero para posicionamento do atributo na estrutura da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina. </P>
<P>O primeiro n&uacute;mero &eacute; "0010" e os demais, acrescidos de 10. </P>
<P>Para incluir um atributo entre dois outros j&aacute; inclu&iacute;dos, &eacute; necess&aacute;rio preencher uma linha que esteja em branco e alterar o n&uacute;mero sequencial desta linha para um n&uacute;mero entre os j&aacute; informados. O SADS reorganizar&aacute; automaticamente a estrutura. Na pr&oacute;xima opera&ccedil;&atilde;o, os atributos j&aacute; estar&atilde;o na nova ordem. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Atributo</B> - Mnem&ocirc;nico do atributo que faz parte da estrutura da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Suf </B>- Sufixo diferenciador do c&oacute;digo do atributo. </P>
<P>O sufixo &eacute; utilizado quando for necess&aacute;rio referenciar um mesmo atributo mais de uma vez na mesma estrutura. </P>
<P>Neste caso, para diferenciar suas ocorr&ecirc;ncias, deve-se cadastrar sufixos diferentes para cada um deles. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Niv </B>- N&iacute;vel de estrutura&ccedil;&atilde;o do atributo (an&aacute;logo ao n&iacute;vel do Cobol). </P>
<P>O n&iacute;vel inicial &eacute; o 10. Se for necess&aacute;rio criar agrupamentos de atributos, deve-se usar m&uacute;ltiplos de 5 (15, 20 e assim por diante), de forma semelhante ao Cobol. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>NDef</B> - N&iacute;vel de defini&ccedil;&atilde;o do atributo. </P>
<P>Podem ser informados os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" (Sistema) - Para atributo definido no sistema informado no campo SIS ou no<BR>
sistema da sub-rotina; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" (Particular) - Para atributo ainda n&atilde;o definido no reposit&oacute;rio de dados do SADS e utilizado somente na &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"G" (Geral) - Atributo definido no reposit&oacute;rio de dados do SADS para utiliza&ccedil;&atilde;o gen&eacute;rica nos sistemas aplicativos.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sis</B> - C&oacute;digo do sistema ao qual o atributo pertence. </P>
<P>Este campo s&oacute; deve ser informado se o campo NDef estiver preenchido com "S" e o atributo pertencer a um sistema diferente do sistema da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Comp</B> - Indicador de atributo compactado. </P>
<P>Os valores poss&iacute;veis s&atilde;o os seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" ou "2" (Num&eacute;rico compactado); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"9" (Num&eacute;rico); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"B" (B<I>inary)</I>.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Form </B>- Formato do atributo na estrutura da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina. </P>
<P>Os valores poss&iacute;veis s&atilde;o os seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"A" (Alfab&eacute;tico); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"B" (<I>Boolean</I>); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"D" (<I>Display</I>) - Alfanum&eacute;rico; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" (Num&eacute;rico); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"R" (Real).</P></DIR>

<P>Se o formato n&atilde;o for informado, ser&aacute; assumido o formato definido para o atributo no reposit&oacute;rio de dados. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Tam</B> - Tamanho do atributo. </P>
<P>Se o tamanho n&atilde;o for informado, ser&aacute; assumido o tamanho definido para o atributo no reposit&oacute;rio de dados. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sin</B> - Indicador de exist&ecirc;ncia de sinal. </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para atributo com sinal (+ ou -); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para atributo n&atilde;o sinalizado.</P></DIR>

<P>Caso o indicador de sinal n&atilde;o seja informado, ser&aacute; assumida a defini&ccedil;&atilde;o de sinal do atributo contida no reposit&oacute;rio de dados. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Dec</B> - Quantidade de casas decimais do atributo. </P>
<P>Os campos Form, Tam, Sin e Dec s&oacute; devem ser informados para os atributos provis&oacute;rios ou quando, nas sub-rotinas, assumirem caracter&iacute;sticas diferentes das definidas para eles no reposit&oacute;rio de dados do SADS. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Clas</B> - Este campo n&atilde;o deve ser informado no cadastramento da &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Occurs </B>- N&uacute;mero de ocorr&ecirc;ncias do atributo dentro da estrutura. </P>
<P>O campo OCCURS &eacute; semelhante a cl&aacute;usula "OCCURS" das estruturas do Cobol e &eacute; usado para definir tabelas e itens de grupo. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Continua(S/N)</B> - Indicador de continuidade de opera&ccedil;&atilde;o. </P>
<P>As possibilidades de preenchimento deste campo s&atilde;o as seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para prosseguir informando mais atributos da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para encerrar o cadastramento da estrutura da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Operacao</B> - Opera&ccedil;&atilde;o efetuada em rela&ccedil;&atilde;o ao cadastramento da estrutura da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina. </P>
<P>As opera&ccedil;&otilde;es poss&iacute;veis s&atilde;o as seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"INC" (Inclus&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"ALT" (Altera&ccedil;&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXC" (Exclus&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"CON" (Consulta).</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Gerlib">Gera&ccedil;&atilde;o de library de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>A gera&ccedil;&atilde;o da <I>library</I> da &aacute;rea de comunica&ccedil;&atilde;o compreende a cria&ccedil;&atilde;o de um arquivo fonte Cobol com o <I>layout</I> da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina, que ser&aacute; incorporado aos programas aplicativos que utilizarem esta sub-rotina como recurso. </P>
<P>A <I>library</I> cont&eacute;m os atributos e campos que comp&otilde;em a &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina. </P>
<P>A seguir, &eacute; apresentado um exemplo de <I>&nbsp;library</I> de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina. </P>
<P>Para a sub-rotina "SXYS02", a <I>&nbsp;library</I> da &aacute;rea de comunica&ccedil;&atilde;o ser&aacute; a seguinte:</P>
</FONT><pre><font size=3>  01  YS0201-SXYS02.
      10 YS0201-EMPCOD                 PIC 9(003).
      10 YS0201-FILCOD                 PIC 9(004).
      10 YS0201-FILEND                 PIC X(040).
      10 YS0201-LOGCOD                 PIC 9(003) COMP.
      10 YS0201-ARTCOD                 PIC 9(003) COMP.
      10 YS0201-LOJCGC                 PIC 9(014) COMP.</pre></font>
<FONT SIZE=2><P>Os prefixos dos campos de uma <I>library</I> de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina t&ecirc;m a seguinte forma&ccedil;&atilde;o: </P>
<P>Terceira letra do sistema ("Y", no exemplo) + a letra "S" (que identifica uma sub-rotina) + o sequencial da sub-rotina ("02", no exemplo) + o n&uacute;mero do registro ("01", no exemplo) + "-" (constante) + o mnem&ocirc;nico do atributo ou campo. </P>
<P>A <I>library </I>de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina &eacute; gerada no <I>&nbsp;usercode</I> definido para o ambiente escolhido, sendo poss&iacute;vel ger&aacute;-la sem <I>usercode</I> (em *) para o ambiente de produ&ccedil;&atilde;o. A especifica&ccedil;&atilde;o de onde a <I>&nbsp;library</I> dever&aacute; residir encontra-se descrita na tabela SBPM5002, que pode ser consultada na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
<P>A <I>library</I> da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina ser&aacute; utilizada no fonte da pr&oacute;pria sub-rotina e tamb&eacute;m em todos os programas aplicativos que fizerem uso dela. </P>
<P>Na WORKING-SORAGE SECTION da pr&oacute;pria sub-rotina, ela &eacute; declarada da seguinte forma:</P>
</FONT><pre><font size=3>   01  YS0201-SXYS02.
   COPY "SX/Y/SL/02" 100100 THRU 199000.</pre></font>
<FONT SIZE=2><P>E nos programas que a acessarem:</P>
</FONT><pre><font size=3>   COPY "SX/Y/SL/02".</pre></font>
<FONT SIZE=2><P>No in&iacute;cio da PROCEDURE DIVISON dos programas aplicativos (<I> on-line</I> e <I>&nbsp;batch</I>) e, tamb&eacute;m, de sub-rotinas que acessem outras sub-rotinas, deve conter comandos que associam a sub-rotina a ser chamada ao seu objeto execut&aacute;vel. </P>
<P>Estes comandos, gerados automaticamente pelo SADS para os programas que declararem sub-rotinas como recurso, s&atilde;o dependentes da utiliza&ccedil;&atilde;o de sub-rotinas globais pelo sistema da seguinte forma: </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Tomando como exemplo a sub-rotina SXY02, caso o sistema do programa a ser gerado n&atilde;o utilize sub-rotinas globais (campo UTILIZACAO DE SUB-ROTINAS GLOBAIS (S/N) igual a "N" na defini&ccedil;&atilde;o do sistema), os seguintes comandos ser&atilde;o automaticamente inclu&iacute;dos no programa:</P>
</FONT><pre><font size=3>  018911      MOVE "SX/Y/SC/02"                 TO GBL-NOMEXT.
  019011      CHANGE ATTRIBUTE TITLE OF "SXYS02"TO GBL-CHANGE.</pre></font>
<P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Tomando o mesmo exemplo citado anteriormente, caso o sistema do programa a ser gerado utilize sub-rotinas globais apenas em teste (campo UTILIZACAO DE SUB-ROTINAS GLOBAIS (S/N) igual a "T" na defini&ccedil;&atilde;o do sistema), os seguintes comandos ser&atilde;o automaticamente inclu&iacute;dos no programa:</P>
</FONT><pre><font size=3>  015511
  015611$SET OMIT = SADSSUBGBL
  015711     MOVE "SX/Y/SC/02"                  TO GBL-NOMEXT.
  015811$POP OMIT
  015911

  016011$SET OMIT = SADSSUBGBL
  016111     CHANGE ATTRIBUTE TITLE OF "SXYS02" TO GBL-CHANGE.
  016211$POP OMIT
  018711</pre></font>
<P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Caso o sistema do programa a ser gerado utilize sub-rotinas globais nos ambientes de teste e produ&ccedil;&atilde;o (campo UTILIZACAO DE SUB-ROTINAS GLOBAIS (S/N) igual a "S" na defini&ccedil;&atilde;o do sistema), nenhum comando ser&aacute; inclu&iacute;do no programa com o intuito de relacionar a sub-rotina ao seu objeto execut&aacute;vel. </P>
<P>Em programas <I>&nbsp;batch</I> e sub-rotinas, os comandos que associam a sub-rotina a ser chamada ao seu objeto execut&aacute;vel e que s&atilde;o inclu&iacute;dos automaticamente pelo SADS s&atilde;o:</P>
</FONT><pre><font size=3>  COPY "SB/P/PL/33" FROM 200000 THRU 299000.
  MOVE "SX/Y/SC/02"                             TO GBL-NOMEXT.
  CHANGE "ATTRIBUTE TITLE OF "SXYS02"           TO GBL-CHANGE.</pre></font>
<FONT SIZE=2><P>O COPY da SB/P/PL/33 deve ser feito uma &uacute;nica vez. J&aacute; os comandos MOVE e CHANGE devem ser feitos para cada sub-rotina a ser utilizada </P>
<P>Em programas <I>&nbsp;batch</I> e sub-rotinas, &eacute; necess&aacute;rio, tamb&eacute;m, incluir na WORKING-STORAGE<I> </I>SECTION o comando:</P>
</FONT><pre><font size=3>  COPY "SB/P/PL/33" FROM 100000 THRU 199000.</pre></font>
<FONT SIZE=2><P>O comando CALL de chamada &agrave; sub-rotina, tamb&eacute;m gerado automaticamente pelo SADS nos programas e sub-rotinas que a utilizam como recurso, &eacute;, da mesma forma, dependente da utiliza&ccedil;&atilde;o de sub-rotinas globais pelo sistema, a saber: </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Tomando novamente como exemplo a sub-rotina SXYS02, caso o sistema do programa a ser gerado n&atilde;o utilizar sub-rotinas globais (campo UTILIZACAO DE SUB-ROTINAS GLOBAIS (S/N) igual a "N" na defini&ccedil;&atilde;o do sistema), o seguinte comando ser&aacute; automaticamente inclu&iacute;do no programa:</P>
</FONT><pre><font size=3>  034811 CALL "SXYS02 OF SXYS02" USING YS0201-SXYS02.</pre></font>
<P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Tomando ainda como exemplo a sub-rotina SXYS02, caso o sistema do programa a ser gerado utilizar sub-rotinas globais apenas em teste (campo UTILIZACAO DE SUB-ROTINAS GLOBAIS (S/N) igual a "T" na defini&ccedil;&atilde;o do sistema), os seguintes comandos ser&atilde;o automaticamente inclu&iacute;dos no programa:</P>
</FONT><pre><font size=3>  034611
  034711$SET OMIT = SADSSUBGBL
  034811     CALL "SXYS02 OF SXYS02"         USING YS0201-SXYS02.
  034911$POP OMIT
  035011$SET OMIT = NOT SADSSUBGBL
  035111     MOVE "SXYS02"                   TO GBL-SUB
  035211     CALL SISTSUBS USING YS0201-SXYS02.
  034311$POP OMIT</pre></font>
<P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Tomando ainda o mesmo exemplo, caso o sistema do programa a ser gerado utilizar sub-rotinas globais nos ambientes de teste e produ&ccedil;&atilde;o (campo UTILIZACAO DE SUB-ROTINAS GLOBAIS (S/N) igual a "S" na defini&ccedil;&atilde;o do sistema), os seguintes comandos ser&atilde;o inclu&iacute;dos no programa.</P>
</FONT><pre><font size=3>  035111     MOVE "SXYS02"                   TO GBL-SUB
  035211     CALL SISTSUBS                   USING YS0201-SXYS02.</pre></font>
<FONT SIZE=2><P>A <I>library</I> &eacute; gerada a partir da estrutura da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina, que deve estar totalmente cadastrada no reposit&oacute;rio de dados do SADS. </P>
<P>A transa&ccedil;&atilde;o que executa a gera&ccedil;&atilde;o de <I>library</I> de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina n&atilde;o est&aacute; associada a nenhuma tela de processamento. Portanto, para efetuar a sua gera&ccedil;&atilde;o, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o "GERLIBSUB", cujos campos s&atilde;o explicados a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Ambiente</B> - Ambiente em que a <I>&nbsp;library</I> ser&aacute; gerada. </P>
<P>Podem ser informados os seguintes ambientes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"T" (Teste) - Para gerar a <I>&nbsp;library</I> de comunica&ccedil;&atilde;o no ambiente de teste; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" (Produ&ccedil;&atilde;o) - Para gerar a <I>&nbsp;library</I> de comunica&ccedil;&atilde;o no ambiente de produ&ccedil;&atilde;o.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Usercode</B> - U<I>sercode</I> de an&aacute;lise. </P>
<P>Caso o <I>usercode</I> n&atilde;o seja informado, ser&aacute; assimido o <I>usercode</I> <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do <I>usercode</I> <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
<P>Para os <I>&nbsp;usercodes</I> de an&aacute;lise, s&atilde;o definidos os ambientes (usercode e disco) onde ficar&atilde;o residentes as <I>&nbsp;libraries</I> de teste e produ&ccedil;&atilde;o, sendo poss&iacute;vel que as <I>&nbsp;libraries</I> de produ&ccedil;&atilde;o fiquem sem <I>&nbsp;usercodes</I>. Estas defini&ccedil;&otilde;es est&atilde;o na tabela SBPM5002, cuja manuten&ccedil;&atilde;o &eacute; feita pelo respons&aacute;vel pelo SADS na sua instala&ccedil;&atilde;o. Esta tabela encontra-se descrita na se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Liblib">Libera&ccedil;&atilde;o de library de &aacute;rea de comunica&ccedil;&atilde;o de sub-rotina para produ&ccedil;&atilde;o</A></B></FONT><FONT SIZE=2> </P>
<P>Para a utiliza&ccedil;&atilde;o de uma sub-rotina pelos programas no ambiente de produ&ccedil;&atilde;o, &eacute; necess&aacute;rio efetuar, antes da compila&ccedil;&atilde;o destes programas, a libera&ccedil;&atilde;o de sua <I>library</I> de &aacute;rea de comunica&ccedil;&atilde;o para a produ&ccedil;&atilde;o. </P>
<P>Atrav&eacute;s desta fun&ccedil;&atilde;o, ser&aacute; poss&iacute;vel disponibilizar a <I>library</I> da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina, anteriormente gerada, para os programas aplicativos a serem compilados para produ&ccedil;&atilde;o. </P>
<P>Para liberar uma <I>library</I> da &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina para produ&ccedil;&atilde;o, &eacute; necess&aacute;rio que a mesma tenha sido gerada para o ambiente de teste. </P>
<P>A libera&ccedil;&atilde;o de <I>library</I> de sub-rotinas n&atilde;o est&aacute; associada a nenhuma tela de processamento. Portanto, para efetu&aacute;-la, basta transmitir os argumentos na tela "LIBLIBSUB", cujos campos est&atilde;o explicados a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Usercode</B> - <I>Usercode</I> de an&aacute;lise. </P>
<P>O <I>usercode</I> a ser informado deve estar habilitado ao usu&aacute;rio, como elemento, em sua lista de elementos "SEGUSER", no Sistema de Seguran&ccedil;a. Detalhes sobre este cadastramento est&atilde;o descritos na Se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Habilita&ccedil;&otilde;es de usu&aacute;rios SADS". </P>
<P>Caso o <I>usercode</I> n&atilde;o seja informado, ser&aacute; assumido o <I>usercode</I> <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do <I>usercode</I> <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
<P>Para <I>usercodes</I> de an&aacute;lise, s&atilde;o definidos os ambientes (<I>usercode</I> e disco) onde ficar&atilde;o residentes suas <I>libraries</I> de teste e produ&ccedil;&atilde;o, sendo poss&iacute;vel que as <I>libraries</I> de produ&ccedil;&atilde;o fiquem sem <I>usercodes</I>. Estas defini&ccedil;&otilde;es est&atilde;o na tabela SBPM5002, que se encontra descrita na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
<P>Se na parametriza&ccedil;&atilde;o do <I>usercode</I> informado houver indica&ccedil;&atilde;o para que <I>libraries</I> de produ&ccedil;&atilde;o fiquem residentes no <I>usercode</I> de produ&ccedil;&atilde;o, ao liberar <I>library</I> para produ&ccedil;&atilde;o, a vers&atilde;o de teste ser&aacute; mantida e uma id&ecirc;ntica ser&aacute; criada no <I>usercode</I> de produ&ccedil;&atilde;o. Caso contr&aacute;rio, a <I>library</I> de teste ser&aacute; removida e outra ser&aacute; gerada sem <I>usercode</I> (em *) para utiliza&ccedil;&atilde;o pelos programas compilados em ambos os ambientes.</P></DIR>
</DIR>

</FONT><FONT SIZE=5><P><A NAME="Defsub">Defini&ccedil;&atilde;o de sub-rotina</A></FONT><FONT SIZE=2> </P>
<P>A defini&ccedil;&atilde;o da sub-rotina &eacute; parcialmente cadastrada no reposit&oacute;rio de dados do SADS a partir do cadastramento de sua &aacute;rea de comunica&ccedil;&atilde;o. </P>
<P>Ao excluir a defini&ccedil;&atilde;o da sub-rotina, ser&atilde;o exclu&iacute;das tamb&eacute;m sua &aacute;rea de comunica&ccedil;&atilde;o, a estrutura da &aacute;rea de comunica&ccedil;&atilde;o, sua descri&ccedil;&atilde;o e os seus recursos. </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Programa</B> - C&oacute;digo da sub-rotina cujos recursos ser&atilde;o cadastrados, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Geracao completa pelo SADS (S/N)</B> - Controle de gera&ccedil;&atilde;o e altera&ccedil;&atilde;o da sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para que a sub-rotina seja gerada completamente pelo SADS, sem possibilidade de altera&ccedil;&atilde;o ou complementa&ccedil;&atilde;o, via Cande, ap&oacute;s a sua gera&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para que a sub-rotina seja gerada completamente pelo SADS e possa ser<BR>
complementado via Cande, caso necess&aacute;rio, ap&oacute;s a sua gera&ccedil;&atilde;o. </P>
<P>Apesar de ser determinada individualmente a completeza da gera&ccedil;&atilde;o de cada sub-rotina, para definir se haver&aacute; ou n&atilde;o realmente a consist&ecirc;ncia de altera&ccedil;&atilde;o da sub-rotina via Cande, o SADS ir&aacute; consultar os par&acirc;metros de gera&ccedil;&atilde;o de sub-rotinas cadastrados nas tabelas SBPM5000 e SBPM70001, em n&iacute;vel de instala&ccedil;&atilde;o e de sistema, respectivamente. </P>
<P>Estas tabelas ser&atilde;o detalhadamente explicadas a seguir. </P></dir></dir>
<B><P><A NAME="Tabela">Tabelas SBPM5000 e SBPM7001:</A></B> </P>
<P>Para cada sub-rotina cadastrada, o valor deste campo &eacute; validado contra as tabelas SBPM5000 e SBPM7001, mantidas pelo respons&aacute;vel pelo SADS na empresa. </P></DIR>
</DIR>
</DIR>

<OL TYPE="A">
<LI>Tabela SBPM5000: Considerando o argumento "GERPRO" da tabela SBPM5000 e, de acordo com o par&acirc;metros 3 (programa<I> on-line</I>), 4 (programa <I>batch</I>), 5 (sub-rotina), informados para estes argumentos, t&ecirc;m-se as seguintes possibilidades de gera&ccedil;&atilde;o de programas e sub-rotinas pelo SADS: </LI>

<UL>
<LI>"S" - Para exigir que todos os programas e sub-rotinas da instala&ccedil;&atilde;o tenham de ser definidos com gera&ccedil;&atilde;o completa pelo SADS; </LI>
<LI>"P" - Para exigir que todos os programas e sub-rotinas da instala&ccedil;&atilde;o tenham de ser definidos com gera&ccedil;&atilde;o completa pelo SADS, mas que possam alterar uma vez de "S" para "N" o controle de suas gera&ccedil;&otilde;es; </LI>
<LI>"L"- Para que todos os programas e sub-rotinas da instala&ccedil;&atilde;o possam ser definidos com gera&ccedil;&atilde;o completa ou n&atilde;o pelo SADS - o par&acirc;metro &eacute; livre. Por&eacute;m, o que tiver sido definido no cadastramento do programa/sub-rotina ser&aacute; consistido na tentativa de altera&ccedil;&atilde;o do mesmo via Cande, inclusive a falta de altera&ccedil;&atilde;o em um programa ou sub-rotina definido com gera&ccedil;&atilde;o incompleta. </LI>
<LI>"N" - Para que todos os programas e sub-rotinas da instala&ccedil;&atilde;o possam ser definidos com gera&ccedil;&atilde;o completa ou n&atilde;o pelo SADS - o par&acirc;metro &eacute; livre. Neste caso, o que tiver sido definido no cadastramento do programa ou sub-rotina tamb&eacute;m n&atilde;o ser&aacute; consistido na tentativa de altera&ccedil;&atilde;o do mesmo via Cande. </LI></UL>

<LI>Tabela SBPM7001: As informa&ccedil;&otilde;es constantes na tabela SBPM7001 se sobrep&otilde;em ao par&acirc;metro de gera&ccedil;&atilde;o cadastrado na tabela SBPM5000. Desta forma, poder&atilde;o ser definidos na tabela SBPM7001 os sistemas cujos programas e sub-rotinas ser&atilde;o gerados em exce&ccedil;&atilde;o ao par&acirc;metro de gera&ccedil;&atilde;o cadastrado na tabela SBPM5000, da seguinte forma: </LI>

<UL>
<LI>Se na tabela SBPM5000 estiver definido que a gera&ccedil;&atilde;o completa dos programas e sub-rotinas na empresa &eacute; obrigat&oacute;ria, na tabela SBPM7001 poder&atilde;o ser definidos os sistemas cujos programas e sub-rotinas n&atilde;o necessitam ser completamente gerados, ou, </LI>
<LI>Se na tabela SBPM5000 estiver definido que a gera&ccedil;&atilde;o completa dos programas e sub-rotinas n&atilde;o &eacute; obrigat&oacute;ria na empresa, na tabela SBPM7001 poder&atilde;o ser definidos os sistemas cujos programas e sub-rotinas necessitam ser completamente gerados pelo SADS.</LI></UL></ol>

<P>Os campos da tabela SBPM7001 devem ser preenchidos da seguinte forma: </P>
<dir>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SISTEMA</B> - C&oacute;digo do sistema, no padr&atilde;o SADS (sss), cujo controle de gera&ccedil;&atilde;o dos programas e sub-rotinas ser&aacute; definido. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>ON-LINE, BATCH e SUBROTINA</B> - Devem ser preenchidos com "S", "P", "L" ou "N", com significado conforme j&aacute; explicado para a tabela SBPM5000. </P>
<P>Maiores detalhes sobre o prenchimento destas tabelas est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Tipo de Logica</B> - Tipo de l&oacute;gica que a sub-rotina utilizar&aacute;. </P>
<P>O tipo de l&oacute;gica determina qual o tipo de processamento a ser executado pela sub-rotina e, por conseguinte, qual a estrutura das rotinas (par&aacute;grafos) que ser&atilde;o geradas em seu fonte. A partir desta estrutura de rotinas predefinida, podem ser selecionados e definidos, caso necess&aacute;rio, m&oacute;dulos de processamento complementares para a sub-rotina. </P>
<P>Cumpre ressaltar que, quando se altera o tipo de sua l&oacute;gica, a sub-rotina &eacute; enquadrado em uma estrutura de rotinas diferente da anterior e todos os m&oacute;dulos definidos que n&atilde;o estiverem relacionados &agrave; nova estrutura ser&atilde;o perdidos. </P>
<P>Os tipos de l&oacute;gicas de programas dispon&iacute;veis podem ser consultados no item "Programa", nesta mesma se&ccedil;&atilde;o. </P>
<P>Os tipos de l&oacute;gicas de sub-rotinas dispon&iacute;veis s&atilde;o os seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>"SR" (Padr&atilde;o)</B> - Para sub-rotinas que efetuam fun&ccedil;&otilde;es bem definidas, cujas execu&ccedil;&otilde;es s&atilde;o disparadas atrav&eacute;s do comando CALL, que &eacute; inserido na l&oacute;gica de outros programas ou sub-rotinas. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>"SC" (C.Geral) </B>- Para sub-rotinas que s&atilde;o disparadas pela consist&ecirc;ncia geral, para testes de exist&ecirc;ncia, inexist&ecirc;ncia ou validade dos par&acirc;metros informados. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>"ST" (Exc. Itens Tabela)</B> - Para sub-rotinas validarem, na exclus&atilde;o de itens de tabelas, a exist&ecirc;ncia destes em outras tabelas ou <I>datasets</I>, de forma a garantir integridade referencial nas transa&ccedil;&otilde;es de exclus&atilde;o de itens de tabelas do SADS. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>"LL" (L&oacute;gica livre)</B> - Para sub-rotinas que executam procedimentos desvinculados dos padr&otilde;es adotados pelas l&oacute;gicas "SR", "SC" e "ST". </P>
<P>A l&oacute;gica livre permite que a l&oacute;gica a ser gerada seja definida de acordo com a necessidade do usu&aacute;rio, atrav&eacute;s de m&oacute;dulos. </P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Nome</B> - Descri&ccedil;&atilde;o resumida da sub-rotina. </P>
<P>Esta informa&ccedil;&atilde;o ir&aacute; compor o REMARKS da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Analista</B> - Nome do analista respons&aacute;vel pela sub-rotina. </P>
<P>Esta informa&ccedil;&atilde;o ir&aacute; compor o REMARKS da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Programador</B>- Nome do programador respons&aacute;vel pela sub-rotina. </P>
<P>Esta informa&ccedil;&atilde;o ir&aacute; compor o REMARKS da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Usuario</B> - Nome da empresa ou &oacute;rg&atilde;o usu&aacute;rio do sistema. </P>
<P>Esta informa&ccedil;&atilde;o ir&aacute; compor o REMARKS da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Compilador</B> - C&oacute;digo do compilador que ser&aacute; utilizado na compila&ccedil;&atilde;o da sub-rotina. </P>
<P>O compilador informado ser&aacute; verificado contra a tabela de compiladores da instala&ccedil;&atilde;o - Tabela SBPM7016. Portanto, deve ser informado um compilador v&aacute;lido. Detalhes a este respeito est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Opera&ccedil;&atilde;o</B> - Opera&ccedil;&atilde;o efetuada sobre a sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"INC" - Inclus&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"ALT" - Altera&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"CON" - Consulta; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXC" - Exclus&atilde;o.</P></DIR>

<P>Cumpre ressaltar que, qualquer altera&ccedil;&atilde;o na defini&ccedil;&atilde;o da sub-rotina exige que as telas sejam transmitidas pelo menos at&eacute; a sele&ccedil;&atilde;o de m&oacute;dulos, inclusive.</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Recsub">Recursos de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>Recursos de sub-rotina s&atilde;o os elementos (arquivos, <I>&nbsp;datasets</I>, <I>&nbsp;libraries</I>, tabelas, registros de uso geral e outras sub-rotinas) que ser&atilde;o utilizados para sua compila&ccedil;&atilde;o e durante seu processamento. </P>
<P>A defini&ccedil;&atilde;o de recursos de sub-rotina &eacute; poss&iacute;vel desde que ela e todos os elementos que ser&atilde;o relacionados como seus recursos estejam cadastrados no reposit&oacute;rio de dados do SADS. </P>
<P>N&atilde;o &eacute; necess&aacute;rio que uma sub-rotina utilize recursos e, por isso mesmo, a defini&ccedil;&atilde;o destes n&atilde;o &eacute; obrigat&oacute;ria no cadastramento de uma sub-rotina. </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina cujos recursos ser&atilde;o cadastrados, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Base de dados</B> - C&oacute;digo da base de dados que cont&eacute;m os bancos de dados a serem utilizados pela sub-rotina, no padr&atilde;o SADS (sssB00xx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Dataset (I/U):</B> </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Elemento</B> - C&oacute;digos dos <I>datasets</I> que a sub-rotina ir&aacute; utilizar, no padr&atilde;o SADS (sssBxx). </P>
<P>Somente podem ser utilizados <I>&nbsp;datasets</I> cadastrados na base de dados do sistema e somente para consulta dos mesmos. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Cpl</B> - Complemento para determina&ccedil;&atilde;o do modo de utiliza&ccedil;&atilde;o do <I>dataset</I>. </P>
<P>O valor poss&iacute;vel &eacute; o seguinte:</P>
</FONT><pre><font size=3>  "I" (<I>Inquiry</I>) - Se o <I>dataset</I> &eacute; utilizado apenas para leitura.</pre></font>
<FONT SIZE=2><P>N&atilde;o &eacute; permitido informar o valor "U" (<I> Update</I>) leitura/grava&ccedil;&atilde;o, em sub-rotinas.. </P>
<P>Podem ser definidos at&eacute; quarenta <I>datasets</I> como recursos de uma mesma sub-rotina. </P>
<P>No cadastramento de uma sub-rotina, o <I>dataset</I> informado deve pertencer obrigatoriamente &agrave; base de dados especificada em seus recursos. </P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Arquivo (I/O/U):</B> </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Elemento</B> - C&oacute;digos dos arquivos que a sub-rotina ir&aacute; utilizar, no padr&atilde;o SADS (sssAxn). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Cpl </B>- Complemento para determina&ccedil;&atilde;o do modo de utiliza&ccedil;&atilde;o do arquivo. </P>
<P>Os valores poss&iacute;veis s&atilde;o os seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"I" (<I> Input)</I> - Se o arquivo for utilizado como entrada de dados; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"O" (<I> Output </I>) - Se o arquivo for utilizado como sa&iacute;da de dados; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"U" (<I> Input</I>/<I> output</I> ) - Se o arquivo for utilizado para entrada/sa&iacute;da de dados.</P></DIR>

<P>As especifica&ccedil;&otilde;es dos complementos para <I>&nbsp;datasets</I> e arquivos s&atilde;o puramente documental, n&atilde;o sendo gerado nenhum c&oacute;digo ou consist&ecirc;ncia a partir delas. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Lib. (W/P/C/I/F/M):</B> </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Elemento</B> - C&oacute;digos das <I>&nbsp;libraries</I> que a sub-rotina ir&aacute; utilizar. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Cpl</B> - Complemento para determina&ccedil;&atilde;o do modo de utiliza&ccedil;&atilde;o da <I>&nbsp;library</I>: </P>
<P>Os valores poss&iacute;veis s&atilde;o os seguintes: </P><DIR>

<B><P>"W"</B> - Se a <I>&nbsp;library</I> for de estrutura de <I>&nbsp;work</I> (WORKING-STORAGE SECTION); </P>
<B><P>"P"</B> - Se a <I>&nbsp;library</I> for de procedimentos (PROCEDURE-DIVISION); </P>
<B><P>"C"</B> - N&atilde;o aplic&aacute;vel &agrave; sub-rotina (&Aacute;rea conversacional); </P>
<B><P>"I"</B> - Se a <I>library</I> for de procedimentos, a ser inserida no in&iacute;cio da Procedure <BR>
Division da sub-rotina (PROCEDURE-DIVISION); </P>
<B><P>"F"</B> - Se a <I>library</I> for de &aacute;rea de comunica&ccedil;&atilde;o com o COMS e por isso dever&aacute; ser inclu&iacute;da no final da WORKING-STORAGE<I> </I>SECTION do programa; </P>
<P>Este tipo de <I>libray</I> poder&aacute; ser utilizada como recurso de programas <I>batch</I>. </P>
<B><P>"M"</B> - Se a <I>library</I> for de procedimentos e n&atilde;o houver necessidade de ser gerada a sua inclus&atilde;o na PROCEDURE-DIVISION da sub-rotina.</P></DIR>

<P>Quando a sub-rotina for gerada, n&atilde;o ser&aacute; gerado um <I>copy</I> desta<I> library</I>, pois este <BR>
<I>copy</I> deve ser feito atrav&eacute;s de um dos comandos de m&oacute;dulo COBOL, EDIT ou EXCEC. Neste caso, o cadastramento da <I>library</I> como recurso da sub-rotina ser&aacute;<BR>
&uacute;til nas consultas a refer&ecirc;ncias cruzadas de tal <I>library</I>. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Tela:</B> </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Elemento</B> - N&atilde;o aplic&aacute;vel &agrave; sub-rotinas.</P></DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Sub-rotina:</B> </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Elemento</B> - C&oacute;digos de outras sub-rotinas que ser&atilde;o acessadas pela sub-rotina em cadastramento.</P></DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Tabela:</B> </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Elemento</B> - C&oacute;digos das tabelas que a sub-rotina ir&aacute; utilizar.</P></DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Relatorio:</B> </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Elemento</B> - N&atilde;o informar.</P></DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Reg.Geral: </P><DIR>

</B></FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Elemento </B>- C&oacute;digos dos registros de uso geral que a sub-rotina ir&aacute; utilizar. </P>
<P>Neste caso, o <I>&nbsp;dataset</I> de uso geral (SBGB02) tamb&eacute;m deve ser informado como recurso no campo D.SET(I/U).</P></DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Diversos:</B> </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Elemento </B>- Recursos que, por n&atilde;o haver espa&ccedil;o suficiente (at&eacute; cinco elementos de cada tipo), n&atilde;o puderam ser definidos no local apropriado. </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Cpl</B> - Complemento para determina&ccedil;&atilde;o do modo de utiliza&ccedil;&atilde;o do recurso, caso o mesmo seja um <I>&nbsp;datase</I>t, arquivo ou <I>&nbsp;library</I>.</P></DIR>
</DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>OPERA&Ccedil;&Atilde;O </B>- Opera&ccedil;&atilde;o efetuada sobre os recursos da sub-rotina. </P>
<P>As opera&ccedil;&otilde;es poss&iacute;veis s&atilde;o as seguintes: </P><DIR>

<B><P>"INC"</B> (Inclus&atilde;o); </P>
<B><P>"ALT"</B> (Altera&ccedil;&atilde;o); </P>
<B><P>"CON"</B> (Consulta); </P>
<B><P>"EXC"</B> (Exclus&atilde;o).</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Awork">&Aacute;rea de work de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>A &aacute;rea de <I>work</I> de uma sub-rotina compreende os campos de trabalho que ser&atilde;o por ela utilizados. </P>
<P>O cadastramento da &aacute;rea de <I>&nbsp;work</I> de sub-rotina &eacute; &uacute;til quando, em uma sub-rotina completamente gerada pelo SADS, desejar-se incluir campos em sua WORKING-STORAGE SECTION, campos estes que n&atilde;o seriam normalmente gerados pelo SADS. </P>
<P>Deste modo, a partir do cadastramento da &aacute;rea de <I>&nbsp;work</I> de sub-rotina, ser&atilde;o inclu&iacute;dos diretamente no fonte da sub-rotina, sem o aux&iacute;lio de <I>&nbsp;copies</I> de <I>&nbsp;libraries</I> de <I>&nbsp;work</I>, os campos nela especificados. </P>
<P>Todos os campos definidos na &aacute;rea de <I>work</I> de sub-rotina, em exce&ccedil;&atilde;o ao campo "FILLER", ser&atilde;o gerados com o prefixo "WSS". </P>
<P>Para o cadastramento da &aacute;rea de <I>&nbsp;work</I>, &eacute; necess&aacute;rio que a sub-rotina e seus recursos j&aacute; estejam cadastrados no reposit&oacute;rio de dados do SADS. </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PROGRAMA </B>- C&oacute;digo da sub-rotina cuja &aacute;rea de <I>&nbsp;work</I> ser&aacute; cadastrada, no padr&atilde;o SADS (sssSxx). </P>
<P>Para cada um dos atributos e campos pertencentes &agrave; &aacute;rea de <I>&nbsp;work</I> da sub-rotina, devem ser informados: </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SEQ</B> - N&uacute;mero sequencial para posicionamento do atributo ou campo na estrutura da &aacute;rea de <I>work</I>. </P>
<P>Este campo j&aacute; vem informado, sendo o primeiro n&uacute;mero igual a "0010" e os demais, acrescidos de 10. </P>
<P>Para incluir um atributo ou campo entre dois outros j&aacute; inclu&iacute;dos, deve ser preenchida uma linha que esteja em branco e o n&uacute;mero sequencial desta linha deve ser alterado para um n&uacute;mero entre os j&aacute; informados. O SADS reorganizar&aacute; automaticamente a estrutura. Na pr&oacute;xima opera&ccedil;&atilde;o, os atributos e campos j&aacute; estar&atilde;o na nova ordem. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>ATRIB/CAMPO</B> - C&oacute;digo do atributo ou campo que far&aacute; parte da &aacute;rea de <I>&nbsp;work</I> da sub-rotina. </P>
<P>Pode-se cadastrar o campo FILLER (NDEF = "G" ou "P"). Neste caso, ele ser&aacute; gerado sem o prefixo WSS, que &eacute; comum a todos os atributos da &aacute;rea de <I>work</I>. Caso este campo seja particular &agrave; area de <I>work</I> (NDEF = "P") e n&atilde;o sejam definidos seu formato e tamanho, ent&atilde;o ser&aacute; assumido formato <I>display</I> com tamanho 1 (um) - PIC X(01). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SUFIXO</B> - Sufixo num&eacute;rico para diferenciar os atributos e campos de mesmo c&oacute;digo dentro da estrutura da &aacute;rea de <I>&nbsp;work</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>NIVEL</B> - N&iacute;vel hier&aacute;rquico do atributo/campo dentro da &aacute;rea de <I>&nbsp;work</I>. </P>
<P>O n&iacute;vel &eacute; utilizado para cria&ccedil;&atilde;o de itens de grupo semelhante ao Cobol. </P>
<P>Os n&iacute;veis &agrave; disposi&ccedil;&atilde;o para uso s&atilde;o 01, 05 e demais m&uacute;ltiplos de 5 at&eacute; 45. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>NDEF</B> - N&iacute;vel de defini&ccedil;&atilde;o do atributo/campo. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"G" (Geral) - Para atributo ou campo global do SADS, que pode ser utilizado pelas sub-rotinas desenvolvidas; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" (Sistema) - Para atributo ou campo definido no mesmo sistema da sub-rotina cuja &aacute;rea de <I>&nbsp;work</I> est&aacute; sendo cadastrada ou definido no sistema indicado no campo SIS; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" (Pr&oacute;prio) - Para atributo ou campo pr&oacute;prio ou particular da sub-rotina. Neste caso, n&atilde;o existe defini&ccedil;&atilde;o para o atributo/campo no reposit&oacute;rio de dados do SADS e suas caracter&iacute;sticas - tamanho, formato, sinaliza&ccedil;&atilde;o e decimais - devem ent&atilde;o ser especificadas no cadastramento da estrutura da &aacute;rea de <I>&nbsp;work</I>; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"R" (Redefini&ccedil;&atilde;o) - Para atributo/campo que redefine o atributo/campo anterior de mesmo n&iacute;vel hier&aacute;rquico.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SIS</B> - C&oacute;digo do sistema ao qual o atributo/campo pertence. </P>
<P>Se o atributo/campo estiver definido no mesmo sistema da sub-rotina em quest&atilde;o, n&atilde;o &eacute; necess&aacute;rio inform&aacute;-lo. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>COMP</B> - Indicador de atributo/campo compactado. </P>
<P>Pode assumir o seguinte valor: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Se o atributo/campo n&uacute;merico for compactado na estrutura da &aacute;rea de <I>&nbsp;work</I>;</P></DIR>

<P>Se o indicador de campo compactado n&atilde;o for informado, o SADS ir&aacute; assumir que o atributo/campo n&uacute;merico n&atilde;o &eacute; compactado na estrutura da &aacute;rea de <I>&nbsp;work</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>FORM</B> - Formato do atributo/campo na &aacute;rea de <I>&nbsp;work</I>. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"A" - Alfab&eacute;tico ; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"D" (<I> Display</I>) - Alfanum&eacute;rico; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Num&eacute;rico.</P></DIR>

<P>Se o campo FORM n&atilde;o for informado, o formato assumido ser&aacute; o mesmo definido para o atributo/campo no reposit&oacute;rio de dados. </P>
<P>Se o atributo/campo estiver definido originalmente como num&eacute;rico e decimais e o campo FORM for alterado para "A" ou "D", os decimais ser&atilde;o ignorados para esta estrutura. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>TAM</B> - Tamanho do atributo/campo na &aacute;rea de <I>&nbsp;work</I>. </P>
<P>Se o campo TAM n&atilde;o for informado, o tamanho assumido ser&aacute; o mesmo definido para o atributo/campo no reposit&oacute;rio de dados. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DEC</B> - N&uacute;mero de casas decimais que o atributo/campo n&uacute;merico ir&aacute; conter na &aacute;rea de <I>&nbsp;work</I> da sub-rotina. </P>
<P>Se o campo DEC n&atilde;o for informado, a quantidade de decimais assumida ser&aacute; a mesma definida para o atributo/campo no reposit&oacute;rio de dados. </P>
<P>N&atilde;o &eacute; poss&iacute;vel determinar que um atributo/campo definido originalmente com casas decimais continue com o formato num&eacute;rico e passe a n&atilde;o possu&iacute;-las na &aacute;rea de <I>&nbsp;work</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SIN</B> - Indicador de atributo/campo sinalizado. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Se o atributo/campo n&uacute;merico for sinalizado; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Se o atributo/campo num&eacute;rico n&atilde;o for sinalizado.</P></DIR>

<P>Se o campo SIN n&atilde;o for informado, ser&aacute; assumida a indica&ccedil;&atilde;o de sinaliza&ccedil;&atilde;o definida para o atributo/campo no reposit&oacute;rio de dados. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>VAL </B>- Valor inicial a ser assumido pelo atributo/campo. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"Z" (Zeros) - Para atribuir zeros como valor inicial para o atributo/campo na &aacute;rea de <I>&nbsp;work</I>; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" (<I> Spaces</I>) - Para atribuir brancos como valor inicial para o atributo/campo na &aacute;rea de <I>&nbsp;work</I>;; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"H" (<I> High-values</I>) - Para atribuir <I>&nbsp;high-values</I> como valor inicial para o atributo/campo na &aacute;rea de <I>&nbsp;work</I>; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"L" (<I> Low-values</I>) - Para atribuir <I>&nbsp;low-values</I> como valor inicial para o atributo/campo na area de <I>&nbsp;work</I>; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"E" (M&aacute;scara de edi&ccedil;&atilde;o para a <I>&nbsp;picture</I> do atributo/campo) - Para indicar que o atributo/campo ir&aacute; assumir a m&aacute;scara de edi&ccedil;&atilde;o para ele definida quando do seu cadastramento. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"D" (Valor <I>&nbsp;default</I>) - Para indicar que o atributo/campo ir&aacute; assumir como valor inicial o valor definido para o mesmo no campo DEFAULT da defini&ccedil;&atilde;o de atributo/campo do reposit&oacute;rio de dados.</P></DIR>

<P>O campo DEFAULT &eacute; limitado ao tamanho de dez posi&ccedil;&otilde;es e o gerador n&atilde;o processa nenhuma consist&ecirc;ncia quanto ao seu conte&uacute;do. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>OCCURS</B> - N&uacute;mero de ocorr&ecirc;ncias do atributo/campo na cria&ccedil;&atilde;o de grupos repetitivos. </P>
<P>Grupos repetitivos s&oacute; podem ser criados para atributos ou campos que determinem um item grupo dentro da estrutura. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>CONTINUA (S/N)</B> - Indicador de continuidade de opera&ccedil;&atilde;o. </P><DIR>

<P>Pode assumir os seguintes valores: </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para prosseguir a opera&ccedil;&atilde;o sobre a &aacute;rea de <I>work</I> da sub-rotina; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para encerrar a opera&ccedil;&atilde;o sobre a &aacute;rea de <I>work</I> da sub-rotina.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>OPERA&Ccedil;&Atilde;O</B> - Opera&ccedil;&atilde;o efetuada sobre a &aacute;rea de <I>work</I> da sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"INC" - Inclus&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"ALT" - Altera&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"CON" - Consulta; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXC" - Exclus&atilde;o.</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Logsub">L&oacute;gica de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>No cadastramento de l&oacute;gicas de sub-rotinas, as informa&ccedil;&otilde;es s&atilde;o relacionadas entre si, permitindo, assim, uma grande varia&ccedil;&atilde;o de subl&oacute;gicas para cada um dos tipos de l&oacute;gica. </P>
<P>Existe uma tela de cadastramento de processamento espec&iacute;fica para cada tipo de l&oacute;gica definido para a sub-rotina. Estas telas ser&atilde;o explicadas a seguir. </P>
<P>Para cadastrar l&oacute;gica, &eacute; necess&aacute;rio que a sub-rotina e seus recursos j&aacute; estejam cadastrados no reposit&oacute;rio de dados do SADS. </P>
<P>O cadastramento de l&oacute;gicas deve ser utilizado apenas para sub-rotinas cuja l&oacute;gica seja diferente de "LL" (L&oacute;gica livre). </P><DIR>

<B><P>CAMPOS DA TELA</B> </P>
<P>O SADS envia uma tela de cadastramento de processamento espec&iacute;fica para o tipo de l&oacute;gica definido para a sub-rotina, a partir da qual ser&atilde;o coletados os dados necess&aacute;rios &agrave; estrutura&ccedil;&atilde;o da mesma. </P>
<P>Cumpre ressaltar que, quando se altera o conte&uacute;do de determinados campos das telas que ser&atilde;o explicadas a seguir, a sub-rotina pode ser enquadrada em uma estrutura de rotinas diferente da anterior e todos os m&oacute;dulos definidos que n&atilde;o estiverem relacionados &agrave; nova estrutura ser&atilde;o perdidos. </P>
<P>A seguir, ser&atilde;o exibidos os campos da tela de cadastramento de l&oacute;gica de processamento de sub-rotina referentes a cada tipo de l&oacute;gica. </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Padr&atilde;o ("SR")</B> </P>
<P>Se o tipo de l&oacute;gica definido para a sub-rotina for "SR", l&oacute;gica para sub-rotinas que efetuam fun&ccedil;&otilde;es bem definidas e cujas execu&ccedil;&otilde;es s&atilde;o disparadas atrav&eacute;s do comando CALL, a tela para o cadastramento de seu processamento ser&aacute; a seguinte: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina em cadastramento, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Informacoes p/ acesso:</B> </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Dataset </B>- C&oacute;digo do <I>dataset</I> que ser&aacute; utilizado na sub-rotina, no padr&atilde;o SADS (sssBxxmm). </P>
<P>Este <I>dataset</I> deve ter sido cadastrado como recurso da sub-rotina. </P>
<P>Se o <I>dataset </I>possuir mais de um tipo de registro, deve-se informar, nas duas &uacute;ltimas posi&ccedil;&otilde;es do campo "Dataset", qual deles ser&aacute; utilizado pela sub-rotina. Se o registro n&atilde;o for informado, o gerador assumir&aacute; o valor <I>default</I> de registro ("00"). </P>
<P>Para este tipo de l&oacute;gica, pode-se informar at&eacute; seis <I>datasets</I> por sub-rotina. Acima desse limite, devem ser utilizados m&oacute;dulos para complementa&ccedil;&atilde;o. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>F/N/L/P</B> - Indicador do tipo de acesso ao <I>dataset</I>. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"F" - <I>First</I>; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N"- <I>Next</I>; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"L" -<I> Last</I>; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" -<I> Prior</I>. </P></DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Set</B> - C&oacute;digo do <I>set</I>, <I>subset</I> ou <I>access</I> que a sub-rotina utilizar&aacute; para acesso ao <I>dataset</I> informado. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Ultimo atributo</B> - C&oacute;digo do &uacute;ltimo atributo para acesso &agrave; estrutura informada (<I> set</I>, <I>subset</I> ou <I>access</I>). </P>
<P>Pode assumir o seguinte valor: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"&lt;C&oacute;digo de atributo&gt;" - Para que o acesso &agrave; estrutura DMSII (<I>set</I>, <I>subset</I> ou <I>access</I>) seja feita at&eacute; o c&oacute;digo deste atributo, ou seja, para qualifica&ccedil;&atilde;o parcial da chave de acesso &agrave; estrutura definida; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"NENHUM" - Para que a sub-rotina execute acesso &agrave; estrutura DMSII sem considerar os campos da chave de acesso.</P></DIR>

<P>Caso este campo n&atilde;o seja informado, o acesso &agrave; estrutura DMSII ser&aacute; completo, isto &eacute;, com todos os atributos pertencentes &agrave; chave de acesso. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Tipo de Logica</B> - Indicador de utiliza&ccedil;&atilde;o do <I>dataset</I>. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"C" - Para que o <I>dataset</I> seja utilizado para consultas; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"E" - Para que o <I>dataset</I> seja utilizado para teste de exist&ecirc;ncia; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"I" - Para que o <I>dataset</I> seja utilizado para teste de inexist&ecirc;ncia.</P></DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Operacao</B> - Opera&ccedil;&atilde;o efetuada sobre a l&oacute;gica da sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"INC" - Inclus&atilde;o; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"ALT" - Altera&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"CON" - Consulta; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXC" - Exclus&atilde;o.</P></DIR>
</DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Padr&atilde;o ("SC")</B> </P>
<P>Se o tipo de l&oacute;gica definido para a sub-rotina for "SC", l&oacute;gica para sub-rotinas que s&atilde;o disparadas pela consist&ecirc;ncia geral, a tela para o cadastramento de seu processamento ser&aacute; a seguinte: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina em cadastramento, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Tipo de Consist&ecirc;ncia</B> - Indicador do tipo de valida&ccedil;&atilde;o a ser efetuada. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"E" - Exist&ecirc;ncia (TEQ); </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"I" - Inexist&ecirc;ncia (TNE); </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"O" - Outros.</P></DIR>

<P>Informe para Tipo de Consist&ecirc;ncia "E" ou "I": </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Dataset </B>- C&oacute;digo do<I> dataset</I> que ser&aacute; utilizado na sub-rotina, no padr&atilde;o SADS (sssBxxmm). </P>
<P>Este <I>dataset</I> deve ter sido cadastrado como recurso da sub-rotina. </P>
<P>Se o <I>dataset</I> possuir mais de um tipo de registro, deve-se informar, nas duas &uacute;ltimas posi&ccedil;&otilde;es do campo "Dataset", qual deles ser&aacute; utilizado pela sub-rotina. Se o registro n&atilde;o for informado, o gerador assumir&aacute; o valor <I>default</I> de registro ("00"). </P>
<P>Para este tipo de l&oacute;gica, pode-se informar um <I>dataset</I> por sub-rotina. Acima desse limite, devem ser utilizados m&oacute;dulos para complementa&ccedil;&atilde;o. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Set </B>- C&oacute;digo do <I>set</I>, <I>subset</I> ou <I>access</I> que a sub-rotina utilizar&aacute; para acesso ao <I>dataset</I> informado. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Ult.atrib. p/acesso</B> - C&oacute;digo do &uacute;ltimo atributo para acesso &agrave; estrutura informada (s<I>et</I>, <I>subset</I> ou <I>access</I>). </P>
<P>Pode assumir o seguinte valor: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"&lt;C&oacute;digo de atributo&gt;" - Para que o acesso &agrave; estrutura DMSII (<I>set</I>, <I>subset</I> ou <I>access</I>) seja feita at&eacute; o c&oacute;digo deste atributo, ou seja, para qualifica&ccedil;&atilde;o parcial da chave de acesso &agrave; estrutura definida; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"NENHUM" - Para que a sub-rotina execute acesso &agrave; estrutura DMSII sem considerar os campos da chave de acesso.</P></DIR>

<P>Caso este campo n&atilde;o seja informado, o acesso &agrave; estrutura DMSII ser&aacute; completo, isto &eacute;, com todos os atributos pertencentes &agrave; chave de acesso. </P>
<P>A consist&ecirc;ncia geral passa, no m&aacute;ximo, tr&ecirc;s par&acirc;metros (PS9901-DADOSA, PS9901-DADOSB e PS9901-DADOSC) para a sub-rotina espec&iacute;fica da aplica&ccedil;&atilde;o. Estes par&acirc;metros podem ser atributos/campos ou itens de grupo, tendo cada um deles o tamanho m&aacute;ximo de 23 caracteres. </P>
<P>A consist&ecirc;ncia passa os dados dos atributos/campos para a sub-rotina sempre alinhados &agrave; esquerda, independente de serem alfanum&eacute;ricos ou num&eacute;ricos. </P>
<B><P>-</B>Os campos EMPRESA, ESTABELECIMENTO e UNIDADE do <I>&nbsp;logon</I> do usu&aacute;rio s&atilde;o passados automaticamente para a sub-rotina: PS9901-EMPRESA (Empresa), PS9901-ESTABELEC Estabelecimento com 3 <I>bytes</I>), PS9901-ESTABELEC4 (Estabelecimento com 4 <I>bytes</I>) e PS9901-ESTABELEC2 (Unidade). </P>
<P>Se houver necessidade de passar mais de tr&ecirc;s campos para a sub-rotina, deve-se cadastrar itens de grupo na estrutura da consist&ecirc;ncia. </P>
<P>Se houver necessidade de passar um campo com mais de 23 <I>bytes</I> para a sub-rotina, pode-se redefini-lo e pass&aacute;-lo em mais de um campo. </P>
<P>As informa&ccedil;&otilde;es que podem ser cadastradas para cada um dos par&acirc;metros s&atilde;o as seguintes: </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Atributo</B> - Mnem&ocirc;nico do atributo passado como par&acirc;metro para a sub-rotina. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Sufixo</B> - Sufixo diferenciador do c&oacute;digo do atributo. </P>
<P>O sufixo &eacute; utilizado quando for necess&aacute;rio referenciar um mesmo atributo mais de uma vez na mesma estrutura. </P>
<P>Neste caso, para diferenciar suas ocorr&ecirc;ncias, deve-se cadastrar sufixos diferentes para cada um deles. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>N. Def.</B> - N&iacute;vel de defini&ccedil;&atilde;o do atributo. </P>
<P>Podem ser informados os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" (Sistema) - Para atributo definido no sistema informado no campo SIS ou no sistema da sub-rotina; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" (Particular) - Para atributo ainda n&atilde;o definido no reposit&oacute;rio de dados do SADS e utilizado somente na &aacute;rea de comunica&ccedil;&atilde;o da sub-rotina; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"G" (Geral) - Atributo definido no reposit&oacute;rio de dados do SADS para utiliza&ccedil;&atilde;o gen&eacute;rica nos sistemas aplicativos.</P></DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Sistema</B> - C&oacute;digo do sistema ao qual o atributo pertence. </P>
<P>Este campo s&oacute; deve ser informado se o campo "N.Def" estiver preenchido com "S" e o atributo pertencer a um sistema diferente do sistema da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Formato</B> - Formato do atributo a ser passado como par&acirc;metro para a sub-rotina. </P>
<P>Os valores poss&iacute;veis s&atilde;o os seguintes: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"D" (<I>Display</I>) - Alfanum&eacute;rico; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" (Num&eacute;rico).</P></DIR>

<P>Se o formato n&atilde;o for informado, ser&aacute; assumido o formato definido para o atributo no reposit&oacute;rio de dados. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Tamanho</B> - Tamanho do atributo. </P>
<P>Se o tamanho n&atilde;o for informado, ser&aacute; assumido o tamanho definido para o atributo no reposit&oacute;rio de dados. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Decimais</B> - Quantidade de casas decimais do atributo. </P>
<P>Os campos Formato, Tamanho e Decimais s&oacute; devem ser informados para quando, nas sub-rotinas, assumirem caracter&iacute;sticas diferentes das definidas para eles no reposit&oacute;rio de dados do SADS, ou quando o atributo for particular &agrave; sub-rotina. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Operacao</B> - Opera&ccedil;&atilde;o efetuada sobre a l&oacute;gica de sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"INC" - Inclus&atilde;o; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"ALT" - Altera&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"CON" - Consulta; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXC" - Exclus&atilde;o.</P></DIR>
</DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Padr&atilde;o ("ST")</B> </P>
<P>Se o tipo de l&oacute;gica definido para a sub-rotina for "ST", l&oacute;gica para sub-rotinas validarem, na exclus&atilde;o de itens de tabelas, a exist&ecirc;ncia destes em outras tabelas ou <I>datasets,</I> de forma a garantir integridade referencial nas transa&ccedil;&otilde;es de exclus&atilde;o de itens de tabelas do SADS, os campos da tela para o cadastramento de seu processamento ser&aacute; a seguinte: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina em cadastramento, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Tabela do item Excluido</B> - C&oacute;digo da Tabela que possui o item a ser exclu&iacute;do. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Informacoes p/ a verificacao:</B> </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Dataset/Tabela </B>- C&oacute;digo do <I>dataset</I> ou tabela onde ser&aacute; testada a exist&ecirc;ncia do item a ser exclu&iacute;do, no padr&atilde;o SADS (sssBxxmm ou sssMnnnn). </P>
<P>Este <I>dataset</I> ou tabela deve ter sido cadastrado como recurso da sub-rotina. </P>
<P>Se o <I>dataset</I> possuir mais de um tipo de registro, deve-se informar, nas duas &uacute;ltimas posi&ccedil;&otilde;es do campo "Dataset", qual deles ser&aacute; utilizado pela sub-rotina. Se o registro n&atilde;o for informado, o gerador assumir&aacute; o valor <I>default</I> de registro ("00"). </P>
<P>Para este tipo de l&oacute;gica, pode-se informar at&eacute; tres <I>datasets</I> ou tabelas. Acima desse limite, devem ser utilizados m&oacute;dulos para complementa&ccedil;&atilde;o. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Set/Chave Sec.</B> - C&oacute;digo do <I>set</I>, <I>subset</I> ou <I>access</I> que a sub-rotina utilizar&aacute; para acesso ao <I>dataset</I> informado, ou da chave secund&aacute;ria que ser&aacute; utilizada para acesso &agrave; tabela informada. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Ultimo atributo</B> - C&oacute;digo do &uacute;ltimo atributo para acesso &agrave; estrutura informada (<I>set</I>, <I>subset</I> ou <I>access</I>). </P>
<P>Pode assumir o seguinte valor: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"&lt;C&oacute;digo de atributo&gt;" - Para que o acesso &agrave; estrutura DMSII (<I>set</I>, <I>subset</I> ou <I>access</I>) seja feita at&eacute; o c&oacute;digo deste atributo, ou seja, para qualifica&ccedil;&atilde;o parcial da chave de acesso &agrave; estrutura definida; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"NENHUM" - Para que a sub-rotina execute acesso &agrave; estrutura DMSII sem considerar os campos da chave de acesso.</P></DIR>

<P>Caso este campo n&atilde;o seja informado, o acesso &agrave; estrutura DMSII ser&aacute; completo, isto &eacute;, com todos os atributos pertencentes &agrave; chave de acesso. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>Operacao</B> - Opera&ccedil;&atilde;o efetuada sobre a l&oacute;gica de sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"INC" - Inclus&atilde;o; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"ALT" - Altera&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"CON" - Consulta; </P>
</FONT><P><IMG SRC="Bullet9.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXC" - Exclus&atilde;o.</P></DIR>
</DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Selmod">Sele&ccedil;&atilde;o de m&oacute;dulos de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>O SADS possibilita aos usu&aacute;rios visualizar a l&oacute;gica da sub-rotina a ser gerada, exibindo todos os seus par&aacute;grafos em seus respectivos n&iacute;veis hier&aacute;rquicos. </P>
<P>Atrav&eacute;s desta visualiza&ccedil;&atilde;o estrutural dos par&aacute;grafos, o usu&aacute;rio pode selecionar m&oacute;dulos para complementa&ccedil;&atilde;o ou altera&ccedil;&atilde;o do fonte da sub-rotina a ser gerado. </P>
<P>M&oacute;dulos de processamento de sub-rotinas s&atilde;o trechos de sub-rotina que podem ser cadastrados pelo usu&aacute;rio, a fim de moldar o fonte gerado &agrave;s necessidades do usu&aacute;rio, incluindo, alterando ou substituindo trechos que seriam normalmente gerados pelo SADS. </P>
<P>Esses m&oacute;dulos s&atilde;o compostos por instru&ccedil;&otilde;es Cobol e por comandos de m&oacute;dulo, que funcionam como verdadeiras macroinstru&ccedil;&otilde;es, fatorando o trabalho e diminuindo o tempo de constru&ccedil;&atilde;o de programas e sub-rotinas. </P>
<P>No momento da sele&ccedil;&atilde;o, determinam-se quais s&atilde;o os m&oacute;dulos, dentre a estrutura de m&oacute;dulos exibida, que se deseja cadastrar. Esta estrutura, por sua vez, &eacute; exibida de acordo com os tipos de l&oacute;gica e de processamento definidos para a sub-rotina. </P>
<P>Os m&oacute;dulos, quando pass&iacute;veis de serem selecionados, poder&atilde;o ser inclu&iacute;dos no in&iacute;cio, no final ou no tratamento de exce&ccedil;&atilde;o de cada par&aacute;grafo, conforme necessidade determinada pelo usu&aacute;rio. Por&eacute;m, aqueles m&oacute;dulos que n&atilde;o puderem ser selecionados para inclus&atilde;o no par&aacute;grafo espec&iacute;fico ser&atilde;o apresentados na tela como campos protegidos transmiss&iacute;veis. </P>
<P>Para cada m&oacute;dulo que puder ser selecionado, &eacute; apresentado, anteriormente ao campo destinado &agrave; sua sele&ccedil;&atilde;o, o n&uacute;mero com que o mesmo ser&aacute; criado na sub-rotina, caso o mesmo seja selecionado. </P>
<P>Ap&oacute;s selecionados, cada um dos m&oacute;dulos dever&aacute; ter seus comandos cadastrados no reposit&oacute;rio do SADS. </P>
<P>Para efetuar a sele&ccedil;&atilde;o de m&oacute;dulos, &eacute; necess&aacute;rio que a identifica&ccedil;&atilde;o, os recursos e a l&oacute;gica da sub-rotina estejam cadastrados no reposit&oacute;rio de dados do SADS. </P>
<P>A sele&ccedil;&atilde;o de m&oacute;dulos &eacute; executada atrav&eacute;s do paginador de entrada do SADS e sua tela possui os campos descritos a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PAGINA</B> - N&uacute;mero da p&aacute;gina de sele&ccedil;&atilde;o de m&oacute;dulos utilizada. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PROGRAMA</B> - C&oacute;digo da sub-rotina, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>LOGICA</B> - C&oacute;digo do tipo de l&oacute;gica definida para a sub-rotina. </P>
<P>Os tr&ecirc;s campos descritos a seguir (MODULO DE INICIO, MODULO DE FIM e MODULO DE EXCECAO) nem sempre poder&atilde;o ser selecionados. Quando n&atilde;o puderem, ser&atilde;o apresentados como campos protegidos transmiss&iacute;veis. </P>
<P>Antes de cada m&oacute;dulo a ser selecionado, &eacute; apresentado o n&uacute;mero com que o mesmo ser&aacute; criado na sub-rotina, caso seja selecionado. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>MODULO DE INICIO</B> - Indicador de sele&ccedil;&atilde;o de m&oacute;dulo para inclus&atilde;o no in&iacute;cio do par&aacute;grafo. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" (<I> Default</I>) - Para indicar que o m&oacute;dulo de in&iacute;cio n&atilde;o ser&aacute; selecionado para o par&aacute;grafo; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"L" - Para indicar que o m&oacute;dulo de in&iacute;cio ser&aacute; selecionado e que seus comandos de m&oacute;dulo ser&atilde;o gerados linearmente no in&iacute;cio do par&aacute;grafo em quest&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para indicar que o m&oacute;dulo de in&iacute;cio ser&aacute; selecionado e que seus comandos de m&oacute;dulo ser&atilde;o executados atrav&eacute;s de um comando PERFORM, no in&iacute;cio do par&aacute;grafo em quest&atilde;o; </P>
<P>Neste caso, a rotina que cont&eacute;m os comandos deste m&oacute;dulo ser&aacute; gerada logo ap&oacute;s o par&aacute;grafo para o qual o m&oacute;dulo foi selecionado. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"T" - Para indicar que o m&oacute;dulo de in&iacute;cio ser&aacute; selecionado e que os comandos de m&oacute;dulo ser&atilde;o gerados linearmente no par&aacute;grafo em quest&atilde;o, substituindo por completo a gera&ccedil;&atilde;o padr&atilde;o do par&aacute;grafo.</P></DIR>

<P>Se o m&oacute;dulo de in&iacute;cio for selecionado com a op&ccedil;&atilde;o de troca "T", os m&oacute;dulos de fim e de exce&ccedil;&atilde;o para este par&aacute;grafo n&atilde;o poder&atilde;o ser selecionados. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>MODULO DE FIM</B> - Indicador de sele&ccedil;&atilde;o de m&oacute;dulo para inclus&atilde;o no fim do par&aacute;grafo. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" (<I> Default</I>) - Para indicar que o m&oacute;dulo de fim n&atilde;o ser&aacute; selecionado para o par&aacute;grafo; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"L" - Para indicar que o m&oacute;dulo de fim ser&aacute; selecionado e que os comandos de m&oacute;dulo ser&atilde;o gerados linearmente no final do par&aacute;grafo em quest&atilde;o; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para indicar que o m&oacute;dulo de fim ser&aacute; selecionado e que os comandos de m&oacute;dulo ser&atilde;o executados atrav&eacute;s de um comando PERFORM, no final do par&aacute;grafo em quest&atilde;o. </P>
<P>Neste caso, a rotina que cont&eacute;m os comandos deste m&oacute;dulo ser&aacute; gerada logo ap&oacute;s o par&aacute;grafo para o qual o m&oacute;dulo foi selecionado.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>MODULO DE EXCECAO</B> - Indicador de sele&ccedil;&atilde;o de m&oacute;dulo para tratamento de exce&ccedil;&atilde;o do acesso ao <I>dataset</I> ou arquivo efetuado no par&aacute;grafo. </P>
<P>Este tipo de m&oacute;dulo deve ser utilizado quando se desejar substituir a gera&ccedil;&atilde;o padr&atilde;o do SADS para tratamento de exce&ccedil;&atilde;o de acesso aos <I>datasets</I> ou para tratamento de exce&ccedil;&atilde;o de leitura/grava&ccedil;&atilde;o nos arquivos existentes no par&aacute;grafo. </P>
<P>N&atilde;o &eacute; permitido selecionar um m&oacute;dulo de exce&ccedil;&atilde;o ("S") quando o respectivo m&oacute;dulo de in&iacute;cio estiver selecionado como troca ("T"). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DESCRICAO DO PARAGRAFO</B> - Nome do par&aacute;grafo e sua posi&ccedil;&atilde;o hier&aacute;rquica dentro da estrutura de par&aacute;grafos da sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para que seja exibida a pr&oacute;xima p&aacute;gina da sele&ccedil;&atilde;o de m&oacute;dulos; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para encerrar o tratamento da fun&ccedil;&atilde;o de sele&ccedil;&atilde;o de m&oacute;dulos. Neste caso, o campo PROXIMA PAGINA deve estar preenchido com "99".</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PROXIMA PAGINA</B> - N&uacute;mero da pr&oacute;xima p&aacute;gina a ser exibida ou "99", para encerrar a sele&ccedil;&atilde;o de m&oacute;dulo. </P>
<P>Ao se transmitir a tela com "99" no campo PROXIMA PAGINA, ser&aacute; efetivada a transa&ccedil;&atilde;o de sele&ccedil;&atilde;o de m&oacute;dulo. Neste momento, os m&oacute;dulos que passar&atilde;o a fazer parte da sub-rotina ser&atilde;o apenas os que foram selecionados. Caso algum m&oacute;dulo tenha sido alterado de "S", "L" ou "T" para "N", o mesmo ser&aacute; exclu&iacute;do. </P>
<P>Caso alguma altera&ccedil;&atilde;o nas fun&ccedil;&otilde;es anteriores tenha causado mudan&ccedil;a na estrutura da sub-rotina apresentada nesta fun&ccedil;&atilde;o e algum m&oacute;dulo anteriormente selecionado n&atilde;o aparecer nesta fun&ccedil;&atilde;o de sele&ccedil;&atilde;o de m&oacute;dulos, ao se transmitir "99" no campo PROXIMA PAGINA, o mesmo tamb&eacute;m ser&aacute; exclu&iacute;do. </P>
<P>A tela de sele&ccedil;&atilde;o de m&oacute;dulos &eacute; de atualiza&ccedil;&atilde;o paginada e possui todas as caracter&iacute;sticas deste tipo de transa&ccedil;&atilde;o, conforme descrito na Se&ccedil;&atilde;o III, "Fun&ccedil;&otilde;es de apoio", neste manual.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Cadmod">Cadastramento de m&oacute;dulos de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
</FONT><P><HR></P>
<B><FONT SIZE=5><P><A NAME="Cadpro">Cadastramento de m&oacute;dulos de processamento</A></B></FONT><FONT SIZE=2> </P>
<P>M&oacute;dulos de processamento de sub-rotinas s&atilde;o trechos de sub-rotina que podem ser cadastrados a fim de moldar o fonte gerado &agrave;s necessidades do usu&aacute;rio, incluindo, alterando ou substituindo trechos que seriam normalmente gerados. </P>
<P>Esses m&oacute;dulos s&atilde;o compostos por instru&ccedil;&otilde;es Cobol e por comandos de m&oacute;dulo, que funcionam como verdadeiras macroinstru&ccedil;&otilde;es, fatorando o trabalho e diminuindo o tempo de constru&ccedil;&atilde;o de sub-rotinas. Isto porque, com uma &uacute;nica linha de especifica&ccedil;&atilde;o de comando de m&oacute;dulo, pode-se, por exemplo: </P>

<UL>
<LI>Realizar acesso a <I>datasets</I>, incluindo tratamento de erro padronizado; </LI>
<LI>Montar <I>loops</I> estruturados; </LI>
<LI>Fazer acesso a tabelas e sub-rotinas; </LI>
<LI>Emitir mensagens, de forma padronizada; </LI>
<LI>Movimentar dados entre estruturas.</LI></UL>

<P>No momento da sele&ccedil;&atilde;o de m&oacute;dulos da sub-rotina, determinam-se quais s&atilde;o os m&oacute;dulos, dentre a estrutura de m&oacute;dulos exibida pelo SADS, que se deseja cadastrar. Esta estrutura, por sua vez, &eacute; exibida de acordo com o tipo de l&oacute;gica e processamento definidos para a sub-rotina. </P>
<P>Ap&oacute;s selecionados, cada um dos m&oacute;dulos deve ter seus comandos cadastrados no reposit&oacute;rio do SADS. </P>
<P>O SADS gera sub-rotinas segundo l&oacute;gicas padronizadas que atendem &agrave; maioria das necessidades de sub-rotinas. </P>
<P>Para as sub-rotinas mais complexas e para as que possuem peculiaridades funcionais, entretanto, os m&oacute;dulos de processamento do SADS s&atilde;o utilizados para complementar e moldar o fonte gerado &agrave;s necessidades do usu&aacute;rio. </P>
<P>Para que se possa definir m&oacute;dulos de processamento, &eacute; necess&aacute;rio que a identifica&ccedil;&atilde;o, os recursos, a l&oacute;gica e a sele&ccedil;&atilde;o dos m&oacute;dulos para a sub-rotina j&aacute; estejam cadastrados no reposit&oacute;rio de dados do SADS. </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PAGINA</B> - N&uacute;mero da p&aacute;gina para cadastramento do m&oacute;dulo. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>ELEMENTO</B> - C&oacute;digo da sub-rotina cujo m&oacute;dulo est&aacute; sendo cadastrado, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>MODULO</B> - N&uacute;mero do m&oacute;dulo a ser cadastrado. </P>
<P>Os n&uacute;meros poss&iacute;veis para os m&oacute;dulos s&atilde;o determinados pelo SADS. Desta forma, eles n&atilde;o podem ser escolhidos aleatoriamente pelo pr&oacute;prio usu&aacute;rio. </P>
<P>No momento da sele&ccedil;&atilde;o de m&oacute;dulos da sub-rotina, determinam-se quais s&atilde;o os m&oacute;dulos, dentre a estrutura de m&oacute;dulos exibida pelo SADS, que se deseja cadastrar. Esta estrutura, por sua vez, &eacute; exibida de acordo com os tipos de l&oacute;gica e de processamento definidos para a sub-rotina. </P>
<P>Desta forma, cada um dos m&oacute;dulos selecionados, que j&aacute; possui um n&uacute;mero preestabelecido, deve ser cadastrado no reposit&oacute;rio de dados do SADS. </P>
<P>Os n&uacute;meros dos m&oacute;dulos, compostos por tr&ecirc;s d&iacute;gitos, possuem a seguinte regra de forma&ccedil;&atilde;o: os dois primeiros d&iacute;gitos identificam o par&aacute;grafo no qual ser&atilde;o inseridos e o terceiro d&iacute;gito &eacute; um diferencial que identifica a posi&ccedil;&atilde;o em que ser&atilde;o inclu&iacute;dos internamente ao par&aacute;grafo, da seguinte forma: 1 - m&oacute;dulo a ser inclu&iacute;do no in&iacute;cio do par&aacute;grafo, 6 - m&oacute;dulo a ser inclu&iacute;do no fim do par&aacute;grafo e 0 - m&oacute;dulo de tratamento de exce&ccedil;&atilde;o do par&aacute;grafo. </P>
<P>Na tela de sele&ccedil;&atilde;o de m&oacute;dulos, aqueles cuja indica&ccedil;&atilde;o encontra-se em branco, ou seja, n&atilde;o est&atilde;o preenchidos com "N"ou "S", s&atilde;o aqueles que n&atilde;o podem ser selecionados e que seriam apresentados na tela como protegidos transmiss&iacute;veis. </P>
<P>Como exemplo, a partir da sele&ccedil;&atilde;o "S" do m&oacute;dulo 116, tem-se as seguintes considera&ccedil;&otilde;es: </P></DIR>
</DIR>


<UL>

<UL>
<LI>O m&oacute;dulo ser&aacute; inclu&iacute;do atrav&eacute;s de PERFORM - pois &eacute; um m&oacute;dulo simples ("S") - no fim do par&aacute;grafo "Trata-area-com-sr", cujo nome completo &eacute; 11000-00-TRATA-AREA-COM-SR. </LI>
<LI>Os dois d&iacute;gitos iniciais do m&oacute;dulo, 11, indicam o n&uacute;mero do par&aacute;grafo onde ser&aacute; inclu&iacute;do, par&aacute;grafo 11000-00-TRATA-AREA-COM-SR. </LI>
<LI>O &uacute;ltimo d&iacute;gito do m&oacute;dulo indica que ele ser&aacute; inclu&iacute;do ao final do respectivo par&aacute;grafo com o seguinte nome completo: 11600-00-MODULO-116. </LI>
<LI>O fonte ser&aacute; gerado com a seguinte estrutura de comandos:</LI></UL>
</UL>
<DIR>
<DIR>

</FONT><pre><font size=3> 11000-00-TRATA-AREA-COM-SR.
   comando 1
   comando 2
   ...
   PERFORM 11600-00-MODULO-116 THRU 11600-99-EXIT.

 11000-99-EXIT.
     EXIT.</pre></font>
<FONT SIZE=2><P>Para cada um dos comandos de m&oacute;dulos a serem cadastrados, os campos a seguir s&atilde;o pass&iacute;veis de serem informados. A obrigatoriedade ou n&atilde;o de se preencher um campo no momento de cadastramento de um determinado comando e a explica&ccedil;&atilde;o detalhada de como preench&ecirc;-lo, encontra-se descrita no t&oacute;pico "Comandos de m&oacute;dulo", neste mesmo item. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SEQ. </B>- Sequ&ecirc;ncia do comando dentro do m&oacute;dulo. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>COMANDO/TIPO</B> - C&oacute;digo do comando de m&oacute;dulo que ser&aacute; utilizado pela sub-rotina. </P>
<P>Caso necess&aacute;rio, deve-se fazer a complementa&ccedil;&atilde;o do comando, informando seu tipo. </P>
<P>Todos os comandos de m&oacute;dulos dispon&iacute;veis, bem como seus tipos, est&atilde;o descritos detalhadamente mais a seguir, no t&oacute;pico "Comandos de m&oacute;dulo", no item "Programa", nesta mesma se&ccedil;&atilde;o. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>ORIGEM</B> - C&oacute;digo do elemento que ser&aacute; utilizado pela sub-rotina como origem (entrada) para o comando informado. </P>
<P>&Eacute; necess&aacute;rio que o elemento utilizado na origem tenha sido cadastrado como recurso da sub-rotina, exceto quando o elemento for o nome de um dos comandos DO, EDIT, EXCEC ou a &aacute;rea de <I>work</I> da pr&oacute;pria sub-rotina, que deve ser indicada nos comandos de m&oacute;dulo pelo pr&oacute;prio c&oacute;digo da sub-rotina (sssSxx). </P>
<P>&Eacute; permitido tamb&eacute;m informar o literal "NENHUM" (para os comandos de m&oacute;dulo FIND e TAB), indicando que nenhuma movimenta&ccedil;&atilde;o deve ser efetuada para a chave de acesso do<I> dataset</I> ou tabela informado no campo DESTINO. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>DESTINO</B> - C&oacute;digo do elemento que ser&aacute; utilizado pela sub-rotina como destino (sa&iacute;da) para o comando informado. </P>
<P>&Eacute; necess&aacute;rio que o elemento utilizado no destino tenha sido cadastrado como recurso para a sub-rotina, exceto quando o elemento for a &aacute;rea de <I>work</I> da pr&oacute;pria sub-rotina, que deve ser indicada nos comandos de m&oacute;dulo pelo pr&oacute;prio c&oacute;digo da sub-rotina (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>SET</B> - C&oacute;digo da estrutura DMSII (<I> set, subset </I>ou<I> access</I>) de acesso ao <I>dataset</I> ou c&oacute;digo da chave secund&aacute;ria de acesso a uma tabela, quando o <I>dataset</I> ou tabela forem utilizados pelo comando de m&oacute;dulo. </P>
<P>Caso o <I>set</I> n&atilde;o seja informado para acesso a um <I>dataset</I>, ser&aacute; gerado ent&atilde;o acesso direto ao <I>dataset</I>. Neste caso, o campo ATRIBUTO n&atilde;o deve ser preenchido. Esta situa&ccedil;&atilde;o &eacute; similar aoa se informar o c&oacute;digo do <I>set</I> e informar NENHUM no campo ATRIBUTO. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>ATRIBUTO</B> - C&oacute;digo de um atributo ou campo cadastrado no reposit&oacute;rio de dados do SADS. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"&lt;C&oacute;digo do &uacute;ltimo atributo para acesso a uma estrutura DMSII&gt;" - Para acesso parcial a uma estrutura DMSII (<I>set</I>, <I>subset</I> ou <I>access</I>), isto &eacute;, para acesso at&eacute; este atributo limite. Utilizado nos comandos que utilizam <I>dataset</I>. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>" " - Para que o acesso &agrave; estrutura DMSII seja com chave completa, isto &eacute;, com qualifica&ccedil;&atilde;o de todos os atributos da chave. Utilizado nos comandos que utilizam <I>dataset</I>. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"NENHUM" - Para que o acesso &agrave; estrutura DMSII seja feito sem considerar os campos da chave. Pr&oacute;prio para Utilizado comandos que utilizam <I>dataset</I>. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"&lt;C&oacute;digo do atributo de uma f&oacute;rmula&gt;"- Para identifica&ccedil;&atilde;o do atributo nos comandos de gera&ccedil;&atilde;o de f&oacute;rmula.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>INDICE</B> - Indicador de indexa&ccedil;&atilde;o de ocorr&ecirc;ncias nas estruturas origem e destino. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"O" - Quando se desejar indexar as ocorr&ecirc;ncias do elemento definido na origem; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"D" - Quando se desejar indexar as ocorr&ecirc;ncias do elemento definido no destino; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"A" - Quando se desejar indexar as ocorr&ecirc;ncias de ambos os elementos definidos na origem e no destino.</P></DIR>

<P>Caso este campo n&atilde;o seja informado, o SADS assumir&aacute; que n&atilde;o se deseja indexar as ocorr&ecirc;ncias tanto na origem como no destino. </P>
<P>O campo INDICE poder&aacute; ser utilizado em comandos de m&oacute;dulo de movimenta&ccedil;&atilde;o de dados - MVE, MOVE e MVEFOR - ou em comandos de m&oacute;dulo que efetuam a movimenta&ccedil;&atilde;o de dados impl&iacute;cita - FIND, LOCK, ALTERA etc. </P>
<P>O SADS ir&aacute; gerar a movimenta&ccedil;&atilde;o dos itens correspondentes - de mesmo mnem&ocirc;nico - do elemento origem para o destino de acordo com a informa&ccedil;&atilde;o cadastrada no campo INDICE e de acordo com a localiza&ccedil;&atilde;o do comando de m&oacute;dulo dentro do sub-rotina, qual seja: </P></DIR>
</DIR>

<OL>
<OL>

<LI>Fora de qualquer <I>loop</I>; </LI>
<LI>Interno a um <I>loop</I> normalmente gerado pelo SADS, cujo n&uacute;mero de vezes para execu&ccedil;&atilde;o &eacute; contabilizado pelo &iacute;ndice IND-GER; </LI>
<LI>Interno a um <I>loop</I> definido pelo usu&aacute;rio atrav&eacute;s do comando de m&oacute;dulo DO, cujo n&uacute;mero de vezes para execu&ccedil;&atilde;o &eacute; contabilizado pelo &iacute;ndice "IND-nnnmm" - onde "nnn" &eacute; o n&uacute;mero do m&oacute;dulo e "mm", o n&uacute;mero do DO; </LI>
<I><LI>loops</I>, do gerador do SADS e do usu&aacute;rio.</LI></OL>
</OL>
<DIR>
<DIR>

<P>Sendo assim, dependendo da localiza&ccedil;&atilde;o na sub-rotina onde o comando ser&aacute; gerado, o SADS determinar&aacute; quais itens ser&atilde;o movidos, quais sejam: </P></DIR>
</DIR>


<UL TYPE="SQUARE">

<UL TYPE="SQUARE">
<LI>Apenas os itens que n&atilde;o s&atilde;o indexados por nenhum &iacute;ndice (S); </LI>
<LI>Apenas os itens pertencentes a tabela unidimensional, que devem ser indexados por um &iacute;ndice (I1); </LI>
<LI>Apenas os itens pertencentes a tabelas bidimensionais, que devem ser indexados por dois &iacute;ndices (I2).</LI></UL>
</UL>
<DIR>
<DIR>

<P>A seguir, ser&aacute; exibida uma tabela a fim de que possa ser percebido, de acordo com o INDICE e localiza&ccedil;&atilde;o do comando, quais itens ser&atilde;o movidos do elemento origem para o elemento destino. </P>
<P>Nesta tabela, ser&atilde;o considerados os c&oacute;digos 1, 2, 3 e 4, para referenciar as mesmas localiza&ccedil;&otilde;es de sub-rotina citadas anteriormente, e os c&oacute;digos S, I1 e I2, para referenciar os tipos de itens dos elementos origem e destino que ser&atilde;o gerados na movimenta&ccedil;&atilde;o. </P></DIR>
</DIR>
</FONT>
<TABLE BORDER CELLSPACING=2 CELLPADDING=10>
<TR><TD VALIGN="MIDDLE">
<P></TD>
<TD VALIGN="MIDDLE" COLSPAN=4>
<B><FONT SIZE=2><P ALIGN="CENTER">Localiza&ccedil;&atilde;o </B></FONT></TD>
</TR>
<TR><TD VALIGN="MIDDLE">
<B><FONT SIZE=2><P ALIGN="CENTER">&amp;IACUTE;ndice</B></FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">1</FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">2</FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">3</FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P ALIGN="CENTER">4 </FONT></TD>
</TR>
<TR><TD VALIGN="MIDDLE">
<FONT SIZE=2><P>BRANCO</FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S </FONT></TD>
</TR>
<TR><TD VALIGN="MIDDLE">
<FONT SIZE=2><P>O(origem)</FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S <BR>
I1 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S <BR>
I1 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>I1 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>I2 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S </FONT></TD>
</TR>
<TR><TD VALIGN="MIDDLE">
<FONT SIZE=2><P>D(destino)</FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S <BR>
S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I1 </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S <BR>
S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I1 </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I1 </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I2 </FONT></TD>
</TR>
<TR><TD VALIGN="MIDDLE">
<FONT SIZE=2><P>A(ambos)</FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S <BR>
I1 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S <BR>
S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I1 <BR>
I1 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I1 </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S <BR>
I1 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> S <BR>
S </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I1 <BR>
I1 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I1 </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>I1 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I1 </FONT></TD>
<TD VALIGN="MIDDLE">
<FONT SIZE=2><P>I2 </FONT><FONT FACE="Wingdings" SIZE=2>&egrave;</FONT><FONT SIZE=2> I2 </FONT></TD>
</TR>
</TABLE>
<DIR>
<DIR>

<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>N.VEZES OU N.FORMULA </B>- N&uacute;mero de vezes que ser&aacute; executado o <I>perform</I> a ser gerado pelo comando de m&oacute;dulo DO ou n&uacute;mero da f&oacute;rmula do atributo a ser calculada. </P>
<P>Este campo dever&aacute; ser informado somente para o comando de m&oacute;dulo DO e para comandos de m&oacute;dulo que utilizam f&oacute;rmula. </P>
<P>Na gera&ccedil;&atilde;o do fonte Cobol, o comando DO ser&aacute; transformado em comando <I>perform</I>. </P>
<P>Para o comando de m&oacute;dulo DO, pode assumir os seguintes valores:</P>
</FONT><pre><font size=3>  "99" - Para indicar que o comando gerado ser&aacute; um <I>Perform until eof</I>:
    PERFORM nnnmm-00-&lt;nome com. DO&gt; THRU nnnmm-99-EXIT
         UNTIL EOF-nnnmm EQUAL HIGH-VALUES;</pre></font>
<FONT SIZE=2><P>sendo que, no c&oacute;digo da chave de fim de arquivo "EOF-nnnmm", "nnn" &eacute; o n&uacute;mero do m&oacute;dulo e "mm", o n&uacute;mero do DO. </P>
<P>Neste caso, o campo "EOF-nnnmm" ser&aacute; composto no<I> </I>tratamento de exce&ccedil;&atilde;o<I> notfound</I> do comando de acesso cadastrado entre o comando DO e o END, se houver. </P>
<P>De "02" a "98" - Para indicar que o comando gerado ser&aacute; um <I>Perform</I> <I>varying</I> de acordo com o &iacute;ndice indicado no campo N.VEZES ou N.FORMULA:</P>
</FONT><pre><font size=3>  PERFORM nnnnn-00-&lt;nome com. DO&gt; THRU nnnnn-99-EXIT
    VARYING IND-nnnmm FROM 1 BY 1 UNTIL
    IND-nnnmm GREATER "numero de vezes"; </pre></font>
<FONT SIZE=2><P>sendo que, no c&oacute;digo do &iacute;ndice "IND-nnnmm", "nnn" &eacute; o n&uacute;mero do m&oacute;dulo e "mm", o n&uacute;mero do DO. </P>
<P>Caso este campo n&atilde;o seja informado no comando de m&oacute;dulo DO, o SADS ir&aacute; gerar um <I>perform</I> simples da seguinte forma:</P>
</FONT><pre><font size=3>  PERFORM nnnnn-00-&lt;nome com. DO&gt; THRU nnnnn-99-EXIT;</pre></font>
<FONT SIZE=2><P>Para comandos que utilizam f&oacute;rmula, pode assumir os seguintes valores: </P><DIR>

<P>De "01" a "99" - Para indicar o n&uacute;mero da f&oacute;rmula do atributo que ser&aacute; utilizada pela sub-rotina.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Linha livre</B> - Linha para detalhamento do comando informado no campo COMANDO/TIPO. </P>
<P>Os comandos de m&oacute;dulo que utilizam a linha livre s&atilde;o: COB (COBOL), LAB (LABEL), EXCEPT, COPY, COMENT e MSG. </P>
<P>Na linha livre devem ser utilizados prefixos, sufixos, pontos e outras refer&ecirc;ncias espec&iacute;ficas para o comando em quest&atilde;o, pois esta linha ser&aacute; gerada na sub-rotina tal como foi cadastrada. </P>
<P>Para os comandos de m&oacute;dulo de edi&ccedil;&atilde;o - COB, EDIT e EXCEC - foi criada a constante "SADSM", a fim de facilitar na determina&ccedil;&atilde;o dos desvios (GO TO), &iacute;ndices e chaves de fim (EOF). </P>
<P>Para se utilizar a constante, ao inv&eacute;s de se definir o n&uacute;mero do par&aacute;grafo para os desvios, &iacute;ndices ou chaves de fim (EOF), deve-se definir a constante "SADSM". Deste modo, na gera&ccedil;&atilde;o da sub-rotina, a constante ser&aacute; substitu&iacute;da pelo n&uacute;mero do par&aacute;grafo correspondente. </P>
<P>A seguir, ser&aacute; exibido um trecho de uma sub-rotina - ABCS01 - gerada a partir da utiliza&ccedil;&atilde;o da constante SADSM, no cadastramento dos comandos COB, em seu m&oacute;dulo linear 251.</P>
</FONT><pre><font size=3>
                                                  N.VEZES OU
  COMANDO/TIPO ORIGEM DESTINO SET ATRIBUTO INDICE N.FORMULA
   DO          EXEMPLO       99.
   COB
          IF  C0200-ATRMNE EQUAL "LOJCOD"
   COB
              GO TO SADSM-99-EXIT.
   COB
          MOVE HIGH-VALUE   TO EOF-SADSM.
   COB
          MOVE CO200-ATRMNE TO CT11I-ATRMNE(IND-SADSM).
   END</pre></font>
<FONT SIZE=2><P>O fonte ser&aacute; gerado com os seguintes comandos:</P>
</FONT><pre><font size=3>
  134011 25110-00-EXEMPLO.
  134111
  134211       IF C0200-ATRMNE EQUAL "LOJCOD"
  134311          GO TO 25110-99-EXIT.
  134411       MOVE HIGH-VALUE   TO EOF-25110.
  134511       MOVE CO200-ATRMNE TO CT11I-ATRMNE(IND-25110).
  134611
  134711 25110-99-EXIT.
  134811       EXIT.</pre></font>
<P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>OPERACAO</B> - Opera&ccedil;&atilde;o a ser efetuada sobre o cadastramento do m&oacute;dulo. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"INC" (Inclus&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"ALT" (Altera&ccedil;&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXC" (Exclus&atilde;o); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"CON" (Consulta).</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>CONTINUA (S/N)</B> - Indicador de continuidade de opera&ccedil;&atilde;o. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para que seja exibida a pr&oacute;xima p&aacute;gina de opera&ccedil;&atilde;o sobre o m&oacute;dulo; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para encerrar a opera&ccedil;&atilde;o sobre o m&oacute;dulo.</P></DIR>

<P>Neste caso, o campo PROXIMA PAGINA deve estar preenchido com "99". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PROXIMA PAGINA </B>- N&uacute;mero da pr&oacute;xima p&aacute;gina a ser exibida ou "99" para encerrar a opera&ccedil;&atilde;o sobre o m&oacute;dulo. </P>
<P>O cadastramento de m&oacute;dulos segue a l&oacute;gica de atualiza&ccedil;&atilde;o paginada e possui todas as caracter&iacute;sticas deste tipo de transa&ccedil;&atilde;o, conforme descrito na Se&ccedil;&atilde;o I, "Requisitos e conceitos para utiliza&ccedil;&atilde;o do SADS, item "Paginador de entrada de dados". </P>
<P>Todos os comandos de m&oacute;dulos dispon&iacute;veis, bem como seus tipos, est&atilde;o descritos detalhadamente, no t&oacute;pico "Comandos de m&oacute;dulo", no item "Programa", nesta se&ccedil;&atilde;o.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Edicob">Edi&ccedil;&atilde;o cobol </A></P>
</B></FONT><FONT SIZE=2><P>O SADS possui uma fun&ccedil;&atilde;o para edi&ccedil;&atilde;o de comandos quaisquer em Cobol e comandos para tratamento de exce&ccedil;&atilde;o. </P>
<P>Atrav&eacute;s desta fun&ccedil;&atilde;o, torna-se poss&iacute;vel ao usu&aacute;rio definir uma sequ&ecirc;ncia de comandos a serem inseridos, tal e qual cadastrados, no fonte da sub-rotina. </P>
<P>Podem existir determinados comandos da sub-rotina que n&atilde;o s&atilde;o gerados da maneira como se deseja pelos comandos de m&oacute;dulo oferecidos pelo SADS. Podem tamb&eacute;m existir tratamentos de exce&ccedil;&atilde;o gerados pelo SADS que n&atilde;o atendem &agrave; necessidade espec&iacute;fica da aplica&ccedil;&atilde;o. Desta forma, torna-se necess&aacute;rio incluir comandos em Cobol, diretamente no fonte da sub-rotina, para atender &agrave; necessidade espec&iacute;fica, ou comandos para substituir o tratamento de exce&ccedil;&atilde;o que seria normalmente gerado. </P>
<P>A inclus&atilde;o de comandos em Cobol no fonte da sub-rotina pode ser feita de duas formas: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Cadastrando cada comando em Cobol a ser inserido na sub-rotina atrav&eacute;s do comando de m&oacute;dulo COB, ou </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Cadastrando todos os comandos em Cobol atrav&eacute;s de um &uacute;nico comando de m&oacute;dulo, que &eacute; o EDIT.</P></DIR>

<P>J&aacute; a substitui&ccedil;&atilde;o do tratamento padr&atilde;o de exce&ccedil;&atilde;o do SADS pode ser feita tamb&eacute;m de duas formas: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Substituindo todo o par&aacute;grafo a ser gerado, incluindo nele, assim, o novo tratamento desejado, ou, </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>O mais conveniente, cadastrando o comando de m&oacute;dulo EXCEC ap&oacute;s o comando que executa o acesso ao <I>dataset</I> ou ao arquivo convencional.</P></DIR>

<P>Atrav&eacute;s do cadastramento no m&oacute;dulo dos comandos EDIT ou EXCEC, que s&atilde;o identificados por um nome, define-se o local da sub-rotina onde ser&aacute; inserido o trecho com comandos Cobol ou se define qual ser&aacute; o comando de acesso anterior cujo tratamento de exce&ccedil;&atilde;o ser&aacute; substitu&iacute;do, respectivamente. </P>
<P>Ap&oacute;s a finaliza&ccedil;&atilde;o do cadastramento do m&oacute;dulo dos comandos EDIT ou EXCEC, o SADS apresenta uma tela para cadastramento do comando, dispondo de 21 linhas para codifica&ccedil;&atilde;o da sequ&ecirc;ncia de comandos em Cobol. </P>
<P>Para edi&ccedil;&atilde;o de comandos em Cobol, &eacute; necess&aacute;rio que a identifica&ccedil;&atilde;o, os recursos, a l&oacute;gica, a sele&ccedil;&atilde;o de m&oacute;dulos e a defini&ccedil;&atilde;o dos mesmos estejam cadastrados no reposit&oacute;rio de dados do SADS. Al&eacute;m disto, no m&oacute;dulo, deve ter sido definido algum comando EDIT ou EXCEC. </P>
<P>O uso dos comandos de m&oacute;dulos EDIT e EXCEC est&atilde;o descritos detalhadamente, no t&oacute;pico "Cadastramento de edi&ccedil;&atilde;o Cobol", no item "Programa", nesta se&ccedil;&atilde;o.</P>
</FONT><B><FONT SIZE=5><P><A NAME="Gersub">Gera&ccedil;&atilde;o de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>O SADS possui uma fun&ccedil;&atilde;o encarregada de gerar, no <I>usercode</I> informado, um arquivo contendo o fonte Cobol da sub-rotina especificada. A gera&ccedil;&atilde;o deste fonte &eacute; baseada nas informa&ccedil;&otilde;es cadastradas para a sub-rotina no reposit&oacute;rio de dados do SADS: a identifica&ccedil;&atilde;o, os recursos, a l&oacute;gica, o tipo de processamento, a sele&ccedil;&atilde;o de m&oacute;dulos e a defini&ccedil;&atilde;o dos m&oacute;dulos. </P>
<P>Qualquer altera&ccedil;&atilde;o no cadastramento da sub-rotina implica em uma nova gera&ccedil;&atilde;o do programa, sem a necessidade de altera&ccedil;&atilde;o do mesmo via Cande. </P>
<P>A gera&ccedil;&atilde;o da sub-rotina &eacute; utilizada quando se deseja criar o fonte de uma sub-rotina a partir de seu cadastramento no SADS ou quando se deseja atualizar o fonte da sub-rotina existente no <I>usercode</I>, a partir das altera&ccedil;&otilde;es efetuadas em seu cadastramento. </P>
<P>Atrav&eacute;s da fun&ccedil;&atilde;o de gera&ccedil;&atilde;o do SADS, &eacute; poss&iacute;vel gerar todas as sub-rotinas do sistema completamente, sem a necessidade de complement&aacute;-las ou alter&aacute;-las via Cande. Esta gera&ccedil;&atilde;o completa &eacute; poss&iacute;vel devido ao fato de o SADS permitir o cadastramento de m&oacute;dulos de complementa&ccedil;&atilde;o do cadastramento das sub-rotinas. </P>
<P>No momento da gera&ccedil;&atilde;o, s&atilde;o incorporadas advert&ecirc;ncias ao fonte da sub-rotina sempre quando o SADS percebe alguma incoer&ecirc;ncia, incompatibilidade ou falta de completeza no fonte da sub-rotina a ser gerado. Ao final do mesmo, &eacute; informado o n&uacute;mero de advert&ecirc;ncias inclu&iacute;das. </P>
<P>Assim sendo, &eacute; desej&aacute;vel que estas advert&ecirc;ncias sejam sempre verificadas, a fim de evitar poss&iacute;veis erros de l&oacute;gica e processamento. </P>
<P>As advert&ecirc;ncias s&atilde;o inclu&iacute;das quando s&atilde;o detectadas, por exemplo, as seguintes situa&ccedil;&otilde;es: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Chaves de acesso a estruturas DMS n&atilde;o compostas; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Chaves de acesso a estruturas DMS compostas parcialmente; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>N&atilde;o movimenta&ccedil;&atilde;o de atributos entre estruturas, no caso de comando de m&oacute;dulo "MOVE".</P></DIR>

<P>Cumpre ressaltar que, na gera&ccedil;&atilde;o do fonte de uma sub-rotina, caso esta possua como recurso um <I>dataset</I> definido como "externo", todas as refer&ecirc;ncias aos atributos deste <I>dataset</I> ser&atilde;o feitas pelos seus c&oacute;digos externos e n&atilde;o pelos seus c&oacute;digos. </P>
<P>Para gerar uma sub-rotina, a mesma j&aacute; deve ter sido cadastrada. A &uacute;ltima fun&ccedil;&atilde;o do cadastramento utilizada com as opera&ccedil;&otilde;es de inclus&atilde;o ou altera&ccedil;&atilde;o deve ter sido a de sele&ccedil;&atilde;o de m&oacute;dulos ou alguma das fun&ccedil;&otilde;es subsequentes (cadastramento de m&oacute;dulo ou edi&ccedil;&atilde;o Cobol). </P>
<P>Para gerar uma sub-rotina, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o GERSUB, cujos campos devem ser preenchidos conforme indicado a seguir. </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Programa</B> - C&oacute;digo da sub-rotina que se deseja gerar, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Usercode</B> - <I>Usercode</I> de an&aacute;lise. </P>
<P>O <I>usercode</I> a ser informado deve estar habilitado ao usu&aacute;rio, como elemento, em sua lista de elementos "SEGUSER", no Sistema de Seguran&ccedil;a. Detalhes sobre este cadastramento est&atilde;o descritos na Se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Habilita&ccedil;&otilde;es de usu&aacute;rios SADS". </P>
<P>Caso o <I>usercode</I> n&atilde;o seja informado, ser&aacute; assumido o <I>usercode</I> <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do <I>usercode</I> <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
<P>S&atilde;o v&aacute;lidos para esta gera&ccedil;&atilde;o os <I>usercodes</I> de an&aacute;lise definidos na tabela SBPM5002. A defini&ccedil;&atilde;o dos <I>usercodes</I> de an&aacute;lise est&aacute; descrita na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS". </P>
<B><P>Gerar mesmo que ja exista o fonte</B> - Indicador de sobreposi&ccedil;&atilde;o de sub-rotina fonte. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para gerar o fonte independentemente da exist&ecirc;ncia de outro de mesmo c&oacute;digo no <I>usercode</I> informado; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para gerar o fonte somente se n&atilde;o existir uma sub-rotina com o mesmo c&oacute;digo no <I>usercode</I> informado.</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Comrot">Compila&ccedil;&atilde;o de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>A compila&ccedil;&atilde;o do fonte da sub-rotina compreende a gera&ccedil;&atilde;o do c&oacute;digo objeto da mesma. </P>
<P>Para compilar o fonte da sub-rotina, &eacute; necess&aacute;rio que ele j&aacute; tenha sido codificado e que a <I>library</I> da &aacute;rea de comunica&ccedil;&atilde;o e de declara&ccedil;&atilde;o de banco j&aacute; tenham sido geradas. </P>
<P>Para compilar uma sub-rotina, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o COMSUB, cujos campos devem ser preenchidos conforme indicado a seguir. </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>USERCODE</B> - C&oacute;digo do <I>&nbsp;usercode</I> de an&aacute;lise onde est&aacute; o fonte da sub-rotina. </P>
<P>O <I>usercode</I> a ser informado deve estar habilitado ao usu&aacute;rio, como elemento, em sua lista de elementos "SEGUSER", no Sistema de Seguran&ccedil;a. Detalhes sobre este cadastramento est&atilde;o descritos na Se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Habilita&ccedil;&otilde;es de usu&aacute;rios SADS". </P>
<P>Caso o <I>usercode</I> n&atilde;o seja informado, ser&aacute; assumido o <I>usercode</I> <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do <I>usercode</I> <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
<P>Os <I>usercodes</I> de an&aacute;lise, bem como os dos ambientes de teste e produ&ccedil;&atilde;o, t&ecirc;m de estar definidos na tabela SBPM5002. Caso os ambientes de teste e produ&ccedil;&atilde;o sejam diferentes do de an&aacute;lise, estes tamb&eacute;m ter&atilde;o de estar definidos na tabela SBPM5003. Estas tabelas e defini&ccedil;&otilde;es est&atilde;o descritas na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>PASSWORD</B> - Senha do <I>usercode</I>. </P>
<P>A password pode ou n&atilde;o ser informada conforme parametriza&ccedil;&atilde;o na tabela SBPM5000, campo COMPDF, Par&acirc;metro 5. Detalhes a respeito desta tabela est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>ACCESSCODE</B> - <I>Accesscode</I> no padr&atilde;o <I>Unisys</I>, caso o <I>usercode</I> o exija. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>ACCESSPASSWORD</B> - Senha do <I>accesscode</I>, caso o mesmo tenha sido informado. </P>
<P>A accesspassword pode ou n&atilde;o ser informada conforme parametriza&ccedil;&atilde;o na tabela SBPM5000, campo COMPDF, Par&acirc;metro 5. Detalhes a respeito desta tabela est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>NOME</B> - Nome de <I>job</I> de compila&ccedil;&atilde;o v&aacute;lido para a <I>WFL</I> da <I>Unisys</I>. </P>
<P>Caso o nome informado iniciar-se com "SPMA89", com ou sem algum complemento, o <I>job</I> de compila&ccedil;&atilde;o ser&aacute; salvo com este mesmo nome no <I>&nbsp;usercode</I> anteriormente especificado. Por exemplo, pode-se informar "SPMA89SXYN17" para que seja criado um arquivo de nome "SPMA89SXYN17" contendo o <I>job</I> de compila&ccedil;&atilde;o do programa SXYN17. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>FONTES</B> - C&oacute;digo(s) da(s) sub-rotina(s) a ser(em) compilada(s), no padr&atilde;o SADS (sssSxx). </P>
<P>Nesta tela est&atilde;o dispon&iacute;veis seis campos para informar os c&oacute;digos das sub-rotinas de um mesmo sistema e tipo (<I>on-line</I>, <I>batch</I> ou sub-rotina) a serem compilados. </P>
<P>Pode-se, inclusive, solicitar a compila&ccedil;&atilde;o de programas <I>on-line</I> e<I> host</I> numa mesma transa&ccedil;&atilde;o. </P>
<P>Caso seja informado o caracter "=", todos os programas <I>on-line</I>, programas <I>batch</I> ou sub-rotinas do sistema ser&atilde;o compilados - caso o tipo dos fontes seja "NF", "PF" ou "SF" respectivamente. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>AMBIENTE (T/P)</B> - Ambiente onde ser&aacute; compilada a sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"T" - Para que o fonte seja compilado no ambiente de teste; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" - Para que o fonte seja compilado no ambiente de produ&ccedil;&atilde;o.</P></DIR>

<P>Caso o ambiente n&atilde;o seja informado, ser&aacute; assumido o ambiente <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do ambiente <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>FILA</B> - Fila onde ser&aacute; executado o <I>job</I>. </P>
<P>Este campo vem preenchido com a fila <I>default</I> para compila&ccedil;&otilde;es. </P>
<P>O n&uacute;mero da fila tem de estar cadastrado na tabela SBPM5001 e a fila <I>default</I> na tabela SBPM5002. Detalhes a respeito destas tabelas podem ser consultados na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>COMPILADOR</B> - Compilador utilizado. </P>
<P>Este campo &eacute; opcional, caso o compilador j&aacute; tenha sido definido no cadastramento da sub-rotina. O compilador tem de estar cadastrado na tabela SBPM7016. </P>
<P>Detalhes sobre esta tabela est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>LISTAGEM</B> - Indicador de emiss&atilde;o de listagem de compila&ccedil;&atilde;o da sub-rotina. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para gerar a listagem da compila&ccedil;&atilde;o da sub-rotina; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para n&atilde;o gerar a listagem da compila&ccedil;&atilde;o da sub-rotina.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>BDNAME</B> - Nome do arquivo <I>backup</I> gerado atrav&eacute;s da listagem da sub-rotina compilada. </P>
<P>V&aacute;lido somente para LISTAGEM = "S". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>OPCAO</B> - Op&ccedil;&atilde;o de compila&ccedil;&atilde;o para a sub-rotina. </P>
<P>As op&ccedil;&otilde;es de compila&ccedil;&atilde;o podem ser definidas na tabela SBPM5018, podendo ser especificadas por sistema, por tipo de programa (<I>on-line</I>, <I>batch</I>, sub-rotinas ou todos), por ambiente (teste, produ&ccedil;&atilde;o ou ambos), por tipo (setada ou resetada) ou por instala&ccedil;&atilde;o. </P>
<P>No entanto, caso se queira alterar ou acrescentar alguma op&ccedil;&atilde;o de compila&ccedil;&atilde;o para a sub-rotina, diferentemente daquelas informadas na tabela SBPM5018, ela deve ser determinada no momento de sua compila&ccedil;&atilde;o. </P>
<P>Detalhes sobre esta tabela est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>R/S</B> - Tipo de utiliza&ccedil;&atilde;o da op&ccedil;&atilde;o de compila&ccedil;&atilde;o. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para acrescentar ("setar") uma nova op&ccedil;&atilde;o para a sub-rotina; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"R" - Para retirar ("resetar") uma op&ccedil;&atilde;o.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>CHARGECODE </B>- <I>Chargecode</I>.(Opcional) </P>
<P>O <I>chargecode</I>, quando informado, ser&aacute; validado no <I>Userdatafile</I>. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>COMPILAR MESMO QUE OS RECURSOS NAO ESTEJAM ATUALIZADOS</B> - Indicador de disparo incondicional da compila&ccedil;&atilde;o. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"SIM" - Para for&ccedil;ar a compila&ccedil;&atilde;o da sub-rotina, mesmo que as <I>libraries</I> de tabelas e etc n&atilde;o estejam com <I>status</I> de gera&ccedil;&atilde;o "OK" no reposit&oacute;rio de dados do SADS; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"NAO" - Para n&atilde;o compilar a sub-rotina sem que as <I>libraries</I> estejam com<I> status</I> de gera&ccedil;&atilde;o "OK" no reposit&oacute;rio de dados do SADS.</P></DIR>

<P>Caso o<I> job </I>de compila&ccedil;&atilde;o montado n&atilde;o localize alguma <I>library </I>utilizada pela sub-rotina, a compila&ccedil;&atilde;o pode ser descontinuada ou ficar em <I>waiting,</I>conforme parametriza&ccedil;&atilde;o feita na tabela SBPM5000. Detalhes sobre esta tabela est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS". </P>
<P>Caso a sub-rotina possua como recursos <I>libraries </I>ou sub-rotinas, a verifica&ccedil;&atilde;o do status de gera&ccedil;&atilde;o destes elementos depender&aacute; do conte&uacute;do do campo "Geracao completa pelo SADS (S/N)". Detalhes sobre esta verifica&ccedil;&atilde;o encontram-se descritos nesta Se&ccedil;&atilde;o, neste mesmo item e no item"<I>Library</I> de Procedure". </P>
<P>Durante a execu&ccedil;&atilde;o das compila&ccedil;&otilde;es, ser&atilde;o enviadas para o terminal mensagens informando do in&iacute;cio e do fim da compila&ccedil;&atilde;o e da exist&ecirc;ncia ou n&atilde;o de erros na compila&ccedil;&atilde;o. Estas mensagens s&atilde;o enviadas para a linha 25 do terminal. Mensagens de "<I> waiting</I>" n&atilde;o s&atilde;o enviadas. </P>
<P>No momento do disparo da compila&ccedil;&atilde;o para teste o objeto antigo &eacute; removido. </P>
<P>No momento do disparo da compila&ccedil;&atilde;o para produ&ccedil;&atilde;o o objeto antigo pode ser removido ou n&atilde;o, conforme cadastramento na tabela SBPM5000. Detalhes sobre esta tabela est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS".</P></DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Libpro">Libera&ccedil;&atilde;o de objeto de sub-rotina para produ&ccedil;&atilde;o</A></B></FONT><FONT SIZE=2> </P>
<P>Para a utiliza&ccedil;&atilde;o de uma sub-rotina no ambiente de produ&ccedil;&atilde;o &eacute; necess&aacute;rio que o objeto da mesma esteja dispon&iacute;vel no <I>usercode</I> referente aos objetos em produ&ccedil;&atilde;o. </P>
<P>Atrav&eacute;s desta fun&ccedil;&atilde;o, &eacute; poss&iacute;vel, pois, copiar o objeto de uma sub-rotina que tenha sido compilada para a produ&ccedil;&atilde;o que se encontre no <I>usercode</I> de "objetos a liberar para produ&ccedil;&atilde;o" (<I>usercode</I> de tipo "AP) para o<I> usercode</I> de "objetos em produ&ccedil;&atilde;o" (<I>usercode</I> de tipo "OP"). </P>
<P>Os <I>usercodes</I> de tipo "AP" e "OP" est&atilde;o relacionados ao <I>usercode</I> de an&aacute;lise - u<I>sercode</I> de tipo "AN", onde reside o fonte do sub-rotina - na tabela SBPM5002. Todos os detalhes referentes ao cadastramento de tais <I>usercodes</I> nesta tabela est&atilde;o descritos na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
<P>Para liberar uma sub-rotina para produ&ccedil;&atilde;o, &eacute; necess&aacute;rio que a mesma tenha sido compilada para o ambiente de produ&ccedil;&atilde;o. </P>
<P>A libera&ccedil;&atilde;o de sub-rotina para produ&ccedil;&atilde;o n&atilde;o est&aacute; associada a nenhuma tela de processamento. Portanto, para efetu&aacute;-la, basta transmitir os argumentos na tela "LIBOBJSUB", cujos campos est&atilde;o explicados a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo do sub-rotina no padr&atilde;o SADS (sssSCnn). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Usercode origem</B> - <I>Usercode</I> de an&aacute;lise onde reside o fonte da sub-rotina. </P>
<P>A partir do <I>usercode</I> de an&aacute;lise informado, ser&aacute; definido quais os<I> usercodes</I> origem - <I>usercode</I> de objetos a liberar para produ&ccedil;&atilde;o - e destino -<I> usercode</I> de objetos em produ&ccedil;&atilde;o - da c&oacute;pia a ser efetuada. Estas defini&ccedil;&otilde;es est&atilde;o na tabela SBPM5002, que se encontra descrita na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
<P>O <I>usercode</I> a ser informado deve estar habilitado ao usu&aacute;rio, como elemento, em sua lista de elementos "SEGUSER", no Sistema de Seguran&ccedil;a. Detalhes sobre este cadastramento est&atilde;o descritos na Se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Habilita&ccedil;&otilde;es de usu&aacute;rios SADS". </P>
<P>Caso o <I>usercode</I> n&atilde;o seja informado, ser&aacute; assumido o <I>usercode</I> <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do <I>usercode</I> <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Hora prevista</B> - Hora a partir da qual o objeto da sub-rotina deve ser liberado para a produ&ccedil;&atilde;o. (opcional) </P>
<P>Caso a hora seja informada, a mesma servir&aacute; como "STARTTIME" para o <I>job</I> de libera&ccedil;&atilde;o do objeto da sub-rotina a ser disparado.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Funca">Fun&ccedil;&otilde;es de apoio</A></B></FONT><FONT SIZE=2> </P>
</FONT><P><HR></P>
<B><FONT SIZE=5><P><A NAME="Especi">Espec&iacute;ficas de sub-rotinas</A></B></FONT><FONT SIZE=2> </P>
<P>O SADS oferece as seguintes fun&ccedil;&otilde;es de apoio que s&atilde;o espec&iacute;ficas do elemento sub-rotina: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Consulta de fonte de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Consulta de m&oacute;dulos de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Lista de erros de compila&ccedil;&atilde;o; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Impress&atilde;o de cadastramento de sub-rotina; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Duplica&ccedil;&atilde;o de sub-rotina/m&oacute;dulo; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Ressequenciamento de m&oacute;dulo; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Exporta&ccedil;&atilde;o e importa&ccedil;&atilde;o de<I> edit</I>. </P>
<P>A seguir, ser&aacute; explicada detalhadamente cada uma dessas fun&ccedil;&otilde;es.</P></DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Confon">Consulta de fonte de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>O SADS permite, sem precisar ativar a janela Cande, consultar o fonte de sub-rotinas gerados. A consulta ao fonte pode ser exibida a partir da primeira linha do programa ou a partir de um <I>label</I>, que deve ser informado com o tamanho m&aacute;ximo de 17 caracteres. Desta forma, a consulta ser&aacute; exibida a partir da primeira linha do programa que come&ccedil;ar com o conjunto de caracteres informado. </P>
<P>Para consultar o fonte de uma sub-rotina, &eacute; necess&aacute;rio que o mesmo j&aacute; tenha sido gerado no <I>usercode</I> informado. </P>
<P>Para consultar o fonte de uma sub-rotina, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o "CONFONSUB", cujos campos devem ser preenchidos conforme explica&ccedil;&atilde;o a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina/library</B> - C&oacute;digo da sub-rotina ou <I>library</I> cujo fonte ser&aacute; consultado, no padr&atilde;o SADS (ssspxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Usercode</B> - <I>Usercode</I> onde reside o fonte da sub-rotina e onde a mesma foi compilada. </P>
<P>O <I>usercode</I> a ser informado deve estar habilitado ao usu&aacute;rio, como elemento, em sua lista de elementos "SEGUSER", no Sistema de Seguran&ccedil;a. Detalhes sobre este cadastramento est&atilde;o descritos na Se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Habilita&ccedil;&otilde;es de usu&aacute;rios SADS". </P>
<P>Caso o <I>usercode</I> n&atilde;o seja informado, ser&aacute; assumido o <I>usercode</I> <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do <I>usercode</I> <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Ambiente</B> - Ambiente onde reside a <I>library</I> de comunica&ccedil;&atilde;o a ser consultada. </P>
<P>Podem ser informados os seguintes ambientes: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"T" (Teste) - Para consultar a <I>library</I> de comunica&ccedil;&atilde;o no ambiente de teste; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" (Produ&ccedil;&atilde;o) - Para consultar a <I>library</I> de comunica&ccedil;&atilde;o no ambiente de produ&ccedil;&atilde;o.</P></DIR>

<P>Caso o ambiente n&atilde;o seja informado, ser&aacute; assumido o ambiente <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do ambiente <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Label/sequencia</B> - <I>Label</I> ou sequ&ecirc;ncia a partir do qual ser&aacute; apresentado o fonte da sub-rotina. </P>
<P>A consulta ao fonte da sub-rotina &eacute; do tipo paginada, contendo as informa&ccedil;&otilde;es de cabe&ccedil;alho, como o c&oacute;digo e a descri&ccedil;&atilde;o da sub-rotina, e, a seguir, o seu fonte. </P>
<P>Em cada linha do fonte &eacute; exibido o conte&uacute;do dos seis primeiros <I>bytes</I> do MARKID (colunas 73 a 78). </P>
<P>No fonte gerado, o MARKID ir&aacute; conter as seguintes informa&ccedil;&otilde;es: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>"GERADO"</B> - Quando a linha fizer parte da gera&ccedil;&atilde;o padr&atilde;o do SADS; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>"MODnnn" </B>- Quando a linha tiver sido gerada atrav&eacute;s de comando de m&oacute;dulo, onde "nnn" &eacute; o n&uacute;mero do m&oacute;dulo corrente; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>"Nome da edi&ccedil;&atilde;o Cobol/exce&ccedil;&atilde;o"</B> - Quando a linha tiver sido gerada a partir de edi&ccedil;&atilde;o Cobol/tratamento de exce&ccedil;&atilde;o (comandos "EDIT" ou "EXEC").</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Conmod">Consulta de m&oacute;dulos de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>O SADS permite consultar a rela&ccedil;&atilde;o dos m&oacute;dulos de todas as sub-rotinas de um sistema, dos m&oacute;dulos de um grupo de sub-rotinas de um sistema ou apenas os m&oacute;dulos de uma sub-rotina espec&iacute;fica. </P>
<P>Para consultar os m&oacute;dulos de sub-rotinas, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o "CONMODSUB", cujos campos devem ser preenchidos conforme explica&ccedil;&atilde;o a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sistema</B> - C&oacute;digo do sistema, cujos m&oacute;dulos de suas sub-rotinas ser&atilde;o listados no padr&atilde;o SADS (sss); </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Identificador</B> - Tipo dos programas do sistema, cujos m&oacute;dulos ser&atilde;o listados. (opcional) </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para consultar a lista de m&oacute;dulos dos programas <I>on-line</I> do sistema; ou </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"P" - Para consultar a lista de m&oacute;dulos dos programas <I>batch</I> do sistema. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para consultar a lista de m&oacute;dulos das sub-rotinas do sistema.</P></DIR>

<P>Caso o identificador do tipo dos programas n&atilde;o seja informado, ser&atilde;o listados os m&oacute;dulos de todos os programas e sub-rotinas do sistema. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sequencial </B>- Sequencial identificador da sub-rotina cujos m&oacute;dulos ser&atilde;o listados - "xx" de sssSxx. (opcional) </P>
<P>Se o identificador do programa n&atilde;o for informado, ser&atilde;o listados os m&oacute;dulos de todos os programas e sub-rotinas do sistema ou de todos os programas do mesmo tipo, caso este tenha sido informado. </P>
<P>A tela exibida na consulta de m&oacute;dulos de sub-rotinas &eacute; do tipo consulta paginada e est&aacute; descrita na Se&ccedil;&atilde;o III, "Fun&ccedil;&otilde;es de apoio", neste manual. </P>
<P>As informa&ccedil;&otilde;es ser&atilde;o exibidas de acordo com os argumentos especificados: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Se informado apenas o sistema (obrigat&oacute;rio), ser&atilde;o exibidos os m&oacute;dulos de todos os programas e sub-rotinas do sistema; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Se informados o sistema e o identificador, ser&atilde;o exibidos os m&oacute;dulos de todos os programas do sistema que s&atilde;o do tipo especificado (<I>on-line</I>, <I>batch ou </I>sub-rotina); </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>Se informados o sistema, identificador e o sequencial, ser&atilde;o exibidos apenas os m&oacute;dulos da sub-rotina especificada.</P></DIR>

<P>Para cada m&oacute;dulo apresentado, a consulta exibe as seguintes informa&ccedil;&otilde;es: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>PROGRAM/MOD</B> - C&oacute;digos da sub-rotina e do m&oacute;dulo; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>NOME</B> - Nome do m&oacute;dulo; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><B><FONT SIZE=2>ULTIMA LIBERACAO</B> - Data da &uacute;ltima libera&ccedil;&atilde;o da sub-rotina para a produ&ccedil;&atilde;o.</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Liserr">Lista de erros de compila&ccedil;&atilde;o </A></P>
</B></FONT><FONT SIZE=2><P>O SADS permite consultar os erros que foram detectados durante a compila&ccedil;&atilde;o da sub-rotina </P>
<P>Essa fun&ccedil;&atilde;o foi criada com o objetivo de possibilitar a gera&ccedil;&atilde;o completa da sub-rotina, sem precisar ativar a janela Cande. </P>
<P>Com aux&iacute;lio de outra fun&ccedil;&atilde;o, a de disparo de compila&ccedil;&atilde;o via SADS, pode-se colocar a sub-rotina gerada na fila de compila&ccedil;&atilde;o e, ap&oacute;s a sua execu&ccedil;&atilde;o, obter uma consulta dos erros detectados, a fim de facilitar altera&ccedil;&otilde;es no cadastramento da sub-rotina. </P>
<P>A utiliza&ccedil;&atilde;o dessa opera&ccedil;&atilde;o ser&aacute; necess&aacute;ria caso a compila&ccedil;&atilde;o de alguma sub-rotina n&atilde;o tenha sido efetuada com sucesso, ou seja, tenham sido detectados erros no momento de sua compila&ccedil;&atilde;o, ou caso alguma mensagem tenha sido enviada para o terminal, exceto as de t&eacute;rmino ok e <I>warning</I>. </P>
<P>Para consultar os erros de compila&ccedil;&atilde;o de uma sub-rotina, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o "LISERRSUB", cujos campos devem ser preenchidos conforme explica&ccedil;&atilde;o a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina </B>- C&oacute;digo da sub-rotina cujo cadastramento ser&aacute; impresso em relat&oacute;rio, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Usercode</B> - <I>Usercode</I> onde reside o fonte da sub-rotina e onde a mesma foi compilada. </P>
<P>O <I>usercode</I> a ser informado deve estar habilitado ao usu&aacute;rio, como elemento, em sua lista de elementos "SEGUSER", no Sistema de Seguran&ccedil;a. Detalhes sobre este cadastramento est&atilde;o descritos na Se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Habilita&ccedil;&otilde;es de usu&aacute;rios SADS". </P>
<P>Caso o <I>usercode</I> n&atilde;o seja informado, ser&aacute; assumido o <I>usercode</I> <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do <I>usercode</I> <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
<P>A tela exibida na consulta de erros de compila&ccedil;&atilde;o de sub-rotina &eacute; do tipo consulta paginada e est&aacute; descrita na Se&ccedil;&atilde;o III, "Fun&ccedil;&otilde;es de apoio", neste manual. </P>
<P>Esta tela, al&eacute;m da lista de erros de compila&ccedil;&atilde;o da sub-rotina, cont&eacute;m informa&ccedil;&otilde;es de cabe&ccedil;alho, como o c&oacute;digo e a descri&ccedil;&atilde;o da sub-rotina. </P>
<P>Os erros de compila&ccedil;&atilde;o s&atilde;o exibidos no mesmo formato que o comando LIST do Cande, com a vantagem de poder ser paginado. </P></DIR>
</DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Impcad">Impress&atilde;o de cadastramento de sub-rotina</A></B></FONT><FONT SIZE=2> </P>
<P>O SADS oferece uma fun&ccedil;&atilde;o de gera&ccedil;&atilde;o de um relat&oacute;rio impresso com todas as informa&ccedil;&otilde;es do cadastramento de uma sub-rotina: identifica&ccedil;&atilde;o, recursos, l&oacute;gica de processamento, sele&ccedil;&atilde;o, cadastramento de m&oacute;dulos. </P>
<P>Essa opera&ccedil;&atilde;o tem por objetivo facilitar a manuten&ccedil;&atilde;o do cadastramento de uma sub-rotina, atrav&eacute;s da visualiza&ccedil;&atilde;o em papel impresso de todas as informa&ccedil;&otilde;es constantes neste cadastramento, para posterior altera&ccedil;&atilde;o. </P>
<P>Para imprimir o cadastramento de uma sub-rotina, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o "IMPCADSUB", cujos campos devem ser preenchidos conforme explica&ccedil;&atilde;o a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina, no padr&atilde;o SADS (sssSxx). </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"sss" - Para imprimir o cadastramento de todas as sub-rotinas do sistema; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"sssXxx" - Para imprimir o cadastramento de sub-rotina espec&iacute;fica.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Modulo </B>- N&uacute;mero do m&oacute;dulo da sub-rotina a ser impressa (opcional) </P>
<P>Pode-se informar "SEL" caso se deseja imprimir o cadastramento da sub-rotina a partir da "Selecao de Modulos". </P>
<P>Caso este campo n&atilde;o seja informado, ser&aacute; listado todo o cadastramento da sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Impressora</B> - C&oacute;digo da impressora. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"&lt;C&oacute;digo da impressora remota&gt;" - Para imprimir o manual na impressora remota informada (esta impressora deve estar cadastrada na rede de terminais); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"PRINTER" - Para imprimir o manual na impressora central, no formul&aacute;rio de 132 posi&ccedil;&otilde;es; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"PRINxx" - Para imprimir o manual na impressora central em formul&aacute;rio especial, onde "xx" &eacute; um <I>formid</I> definido na instala&ccedil;&atilde;o.</P></DIR>

<P>As impressoras remotas podem ser cadastradas, com um <I>formid</I> correspondente, na tabela SBPM5026. Todas as vezes que for disparada uma impress&atilde;o pelo SADS, esta tabela &eacute; consultada, e caso a impressora esteja cadastrada, o relat&oacute;rio ser&aacute; impresso com o seu<I> formid</I> correspondente. A tabela SBPM5026 est&aacute; descrita na Se&ccedil;&atilde;o V, "Parametriza&ccedil;&otilde;es do SADS", neste manual. </P>
<P>A impress&atilde;o ser&aacute; executada imediatamente, sem apresenta&ccedil;&atilde;o de tela de processamento e, ao seu t&eacute;rmino, ser&aacute; enviada uma mensagem confirmando a impress&atilde;o.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Duplic">Duplica&ccedil;&atilde;o de sub-rotina/m&oacute;dulo</A></B></FONT><FONT SIZE=2> </P>
<P>A duplica&ccedil;&atilde;o de sub-rotinas e m&oacute;dulos &eacute; uma facilidade oferecida pelo SADS com o objetivo de agilizar a tarefa de cadastramento de sub-rotinas. </P>
<P>Com essa fun&ccedil;&atilde;o, o SADS possibilita duplicar sub-rotinas ou m&oacute;dulos de sub-rotinas. </P>
<P>Quando se dispara a fun&ccedil;&atilde;o de duplica&ccedil;&atilde;o de sub-rotina, sua &aacute;rea de comunica&ccedil;&atilde;o tamb&eacute;m &eacute; duplicada.</P>
<P>Os m&oacute;dulos podem ser duplicados internamente a uma mesma sub-rotina ou para outra sub-rotina. </P>
<B><P>- </B>Uma sub-rotina que n&atilde;o seja gerada 100% pelo SADS , n&atilde;o pode ser duplicada para um sistema, que, de acordo com a parametriza&ccedil;&atilde;o feita, s&oacute; aceite novos programas que sejam gerados 100%. </P>
<P>Para duplicar sub-rotina, &eacute; necess&aacute;rio que: </P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>A sub-rotina origem esteja cadastrada no reposit&oacute;rio de dados do SADS; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>A sub-rotina destino n&atilde;o esteja cadastrada. </P></DIR>

<P>Para duplicar m&oacute;dulo, &eacute; necess&aacute;rio que:</P><DIR>

</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>A sub-rotina e o m&oacute;dulo origem estejam cadastrados; </P>
</FONT><P><IMG SRC="Bullet1.gif" WIDTH=6 HEIGHT=6><FONT SIZE=2>A sub-rotina destino esteja cadastrada e o m&oacute;dulo destino, selecionado.</P></DIR>

<P>Para duplicar sub-rotinas ou m&oacute;dulos, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o "DUPSUB", cujos campos devem ser preenchidos conforme explica&ccedil;&atilde;o a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina origem</B> - C&oacute;digo da sub-rotina a ser duplicada, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Modulo origem</B> - N&uacute;mero do m&oacute;dulo a ser duplicado. </P>
<P>Este campo n&atilde;o deve ser informado para duplica&ccedil;&atilde;o de sub-rotina. </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina destino</B> - C&oacute;digo da sub-rotina que ir&aacute; assumir o novo cadastramento, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Modulo destino</B> - N&uacute;mero do novo m&oacute;dulo. </P>
<P>Este campo n&atilde;o deve ser informado para duplica&ccedil;&atilde;o de sub-rotina. </P>
<P>A transa&ccedil;&atilde;o de duplica&ccedil;&atilde;o de sub-rotina /m&oacute;dulo apresentar&aacute; uma tela de processamento para informa&ccedil;&atilde;o do nome da sub-rotina e confirma&ccedil;&atilde;o, sendo que ao seu t&eacute;rmino, ser&aacute; enviada uma mensagem confirmando a duplica&ccedil;&atilde;o.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Resse">Ressequenciamento de m&oacute;dulo</A></B></FONT><FONT SIZE=2> </P>
<P>O SADS possibilita que os comandos definidos em um determinado m&oacute;dulo sejam ressequenciados, ou seja, tenham alteradas suas sequ&ecirc;ncias dentro do m&oacute;dulo, de modo que todas elas tenham um n&uacute;mero m&uacute;ltiplo de 10 (dez). </P>
<P>Para utilizar esta opera&ccedil;&atilde;o, o m&oacute;dulo a ser ressequenciado j&aacute; deve ter sido cadastrado no reposit&oacute;rio de dados do SADS. </P>
<P>Para ressequenciar um m&oacute;dulo, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o RESMODSUB, cujos campos devem ser preenchidos conforme explica&ccedil;&atilde;o a seguir: </P><DIR>

<B><P>CAMPOS DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina </B>- C&oacute;digo da sub-rotina cujo m&oacute;dulo se deseja ressequenciar, no padr&atilde;o SADS (sssSxx). </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Modulo</B> - N&uacute;mero do m&oacute;dulo a ser ressequenciado. </P>
<P>Esta transa&ccedil;&atilde;o ser&aacute; executada imediatamente, sem apresenta&ccedil;&atilde;o de tela de processamento e, ao seu t&eacute;rmino, ser&aacute; enviada uma mensagem confirmando o ressequenciamento.</P></DIR>
</DIR>

</FONT><B><FONT SIZE=4><P><A NAME="Expimp">Exporta&ccedil;&atilde;o/importa&ccedil;&atilde;o de edits</A></B></FONT><FONT SIZE=2> </P>
<P>O SADS possibilita exportar comandos de m&oacute;dulo EDIT para o Cande e importar arquivos de comandos em Cobol para que se tornem comandos EDIT. Ao efetuar uma exporta&ccedil;&atilde;o de um EDIT no Cande, ser&aacute; gerado um arquivo de nome "EDIT/ sssSxxmmm/xxxxxxxxx", onde: </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><FONT SIZE=2>"sssSxx" &eacute; o c&oacute;digo da sub-rotina; </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"mmm" &eacute; o n&uacute;mero do m&oacute;dulo ao qual o EDIT pertence e </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"xxxxxxxxx" &eacute; nome do EDIT.</P></DIR>

<P>Este arquivo pode ent&atilde;o ser alterado e depois importado pelo SADS, permitindo, com estas opera&ccedil;&otilde;es, que sejam utilizadas as facilidades de edi&ccedil;&atilde;o do Cande. </P>
<P>Pode-se tamb&eacute;m criar o arquivo diretamente no Cande, desde que ele tenha este padr&atilde;o de nome, para que ele seja importado pelo SADS. </P>
<P>Sempre quando for efetuada uma importa&ccedil;&atilde;o de comando EDIT do Cande, a sub-rotina que teve o EDIT importado ficar&aacute; marcada e s&oacute; poder&aacute; ser compilada caso ela seja regerada. Isto para garantir que os comandos do EDIT sejam devidamente gerados na sub-rotina ap&oacute;s sua importa&ccedil;&atilde;o para o SADS. </P>
<P>Para exportar ou importar um comando EDIT, basta transmitir os argumentos do menu de opera&ccedil;&atilde;o "TRAEDISUB", cujos campos devem ser preenchidos conforme explica&ccedil;&atilde;o a seguir: </P>
<B><P>CAMPO DA TELA</B> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Operacao</B> - Opera&ccedil;&atilde;o a ser efetuada sobre o comando EDIT </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"IMP" - Importa&ccedil;&atilde;ocao do arquivo no Cande para o comando EDIT do SADS; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"EXP" - Exporta&ccedil;&atilde;cao do comando EDIT do SADS para um arquivo no Cande;</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Sub-rotina</B> - C&oacute;digo da sub-rotina a qual o EDIT pertence; </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Modulo - </B>C&oacute;digo do m&oacute;dulo da sub-rotina ao qual o EDIT pertence; </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Edit</B> - Nome do comando EDIT; </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Usercode</B> - <I>Usercode</I> onde reside o arquivo a ser importado/exportado. </P>
<P>O <I>usercode</I> a ser informado deve estar habilitado ao usu&aacute;rio, como elemento, em sua lista de elementos "SEGUSER", no Sistema de Seguran&ccedil;a. Detalhes sobre este cadastramento est&atilde;o descritos na Se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Habilita&ccedil;&otilde;es de usu&aacute;rios SADS". </P>
<P>Caso o <I>usercode</I> n&atilde;o seja informado, ser&aacute; assumido o <I>usercode</I> <I>default</I> do usu&aacute;rio. Detalhes sobre o cadastramento do <I>usercode</I> <I>default</I> do usu&aacute;rio podem ser obtidos na se&ccedil;&atilde;o VI, "Sistema de Seguran&ccedil;a", item "Usu&aacute;rios e habilita&ccedil;&otilde;es". </P>
</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>EXPORTAR MESMO QUE JA EXISTA O EDIT? (S/N)</B> - Indicador de sobreposi&ccedil;&atilde;o de arquivos no Cande, na opera&ccedil;&atilde;o de exporta&ccedil;&atilde;o. </P>
<P>Pode assumir os seguintes valores: </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"S" - Para que seja gerado o arquivo no Cande contendo os comandos do EDIT, mesmo que j&aacute; exista um arquivo neste <I>usercode</I> com mesmo nome. O arquivo anterior ser&aacute; sobreposto. </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>"N" - Para que seja n&atilde;o seja gerado o arquivo no Cande contendo os comandos do EDIT, caso j&aacute; exista um arquivo neste <I>usercode</I> com mesmo nome.</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT SIZE=5><P><A NAME="Gener">Gen&eacute;ricas aplic&aacute;veis &agrave;s sub-rotinas</A></B></FONT><FONT SIZE=2> </P><DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Utilit&aacute;rios:</B> </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Ressequenciamento de estrutura de elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Duplica&ccedil;&atilde;o de elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Duplica&ccedil;&atilde;o de registro; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Descri&ccedil;&atilde;o de elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Importa&ccedil;&atilde;o de descri&ccedil;&atilde;o de elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Exporta&ccedil;&atilde;o de descri&ccedil;&atilde;o de elemento.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Consultas :</B> </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Elementos por sistema; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Estrutura de dados de elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Fonte de elemento (sub-rotina/programa /<I> library</I>); </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Descri&ccedil;&atilde;o de elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Erros de compila&ccedil;&atilde;o de elemento (programa/sub-rotina). </P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Refer&ecirc;ncia cruzada:</B> </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Elementos x elemento - Programas em que uma sub-rotina &eacute; referenciada; Recursos que uma sub-rotina utiliza.</P></DIR>

</FONT><P><IMG SRC="Bullet5.gif" WIDTH=12 HEIGHT=12><B><FONT SIZE=2>Informativos impressos:</B> </P><DIR>

</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Lista elementos por sistema; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Lista estrutura de dados de elemento; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Lista descri&ccedil;&atilde;o de elementos; </P>
</FONT><P><IMG SRC="Bullet7.gif" WIDTH=15 HEIGHT=12><FONT SIZE=2>Lista fonte de elemento (sub-rotina/programa/<I> library</I>).</P></DIR>

<P>Todos estes utilit&aacute;rios, consultas, refer&ecirc;ncias cruzadas e informativos impressos encontram-se detalhadamente descritos na Se&ccedil;&atilde;o III, "Fun&ccedil;&otilde;es de apoio", neste manual. </P></DIR>
</FONT></BODY>
</HTML>
